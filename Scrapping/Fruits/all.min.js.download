function signupController(e,t,o,n){function i(){return new Promise(function(e,t){console.log("Welcome!  Fetching your information.... "),window.FB.api("/me",{fields:"name,email,first_name,last_name"},function(t){t.provider="facebook",a.socialUser=t,e(t)})})}function r(e){return new Promise(function(t,n){console.log("Verifying Social User.... "),o.postHulk("/mapi/v4.0.0/member-svc/social_signup/email/verify/",e,s).then(function(e){a.bbLoader=!1,e.success&&t(e)})})}var a=this,s=e.$parent.$parent,c=angular.element(document.querySelector(".signup-modal"));a.showCaptcha=!1,a.captcha_url=s.loadSignupCaptcha?"":s.captcha_url,a.captcha_0=s.loadSignupCaptcha?"":s.captcha_0,a.showSignupForm=!0,a.showSocialVerify=!1,a.almostThere=!1,a.captcha_public_key=CAPTCHA_PUBLIC_KEY,a.passwordInputType="password",a.showHidePasswordClass="view",a.bbLoader=!1,a.socialUser={},a.timer=0,a.time={},a.seconds=30,a.showResend=!1,a.isEditIdentifier=!1,a.identifier="",a.signupMethod="normal",a.socialToken="",window.mobileNumber&&(a.mobile=window.mobileNumber),a.hideShowPassword=function(){a.passwordInputType="password"===a.passwordInputType?"text":"password",a.showHidePasswordClass="view"===a.showHidePasswordClass?"hide":"view"},a.member_referral_active="True"===MEMBER_REFERAL_ACTIVE,a.back=function(){a.showSignupForm=!0,a.showLoginWithOTPForm=!1,a.showSocialVerify=!1,s.showNavTabs=!0,a.ToggleTimer(!1)},a.captcha_public_key||(a.showCaptcha=!0),a.toggleEditIdentifier=function(){a.ToggleTimer(!1),setTimeout(function(){$("#mobileEmail").focus()},100),a.resetServerMessages();var e=JSON.stringify({EventName:"Mobile_Change",EventSubGroup:"signup",Action:"change"});$(document).trigger("loginInteractions",[e]),a.isEditIdentifier=!0,a.showResend=!1},a.changeIdentifier=function(){var e=JSON.stringify({EventName:"Mobile_Change",EventSubGroup:"signup",Action:"submit"});$(document).trigger("loginInteractions",[e]),a.isEditIdentifier=!1,a.showResend=!0,a.resendOTP(),a.loginWithOTP.OTP="",a.resetServerMessages()},a.reset_captcha=function(){o.get_captcha_url().then(function(e){a.captcha_url=e.data.captcha_url,s.captcha_url=a.captcha_url,a.captcha_0=e.data.captcha_challenge,s.captcha_0=a.captcha_0,a.captcha_1=""})},a.showSocialSignupForm=function(e){a.isfbSignup="fb"===e,a.referralSocialErrorMsg="",a.doSocialRedirect()},a.doSocialRedirect=function(){a.isfbSignup?o.fb_login("reg",a.referralCodeSocial):o.gplus_login("reg",a.referralCodeSocial)},a.redirectToSocialService=function(e){if(e){a.referralSocialErrorMsg="";var t={ref_code:a.referralCodeSocial};o.getRequest("/auth/valid-referral-code/",t,s).then(function(e){e.data.valid?a.doSocialRedirect():a.referralSocialErrorMsg="Invalid referral code"})}else a.doSocialRedirect()},s.loadSignupCaptcha&&(a.reset_captcha(),s.loadSignupCaptcha=!1),a.reset_form=function(){a.reset_captcha(),e.signupForm.$setPristine(),e.signupForm.$setUntouched()},a.show_server_error=function(e){Object.keys(e).forEach(function(t){t in a.error_messages&&(a.error_messages[t]=e[t][0])})},a.resetServerMessages=function(){a.error_messages={mobile:"",update:""},a.loginWithOTP.otpError="",a.loginWithOTP.otpServerError=""},a.resendOTP=function(){a.showResend=!1,a.ToggleTimer(!1),a.resetServerMessages();var t={identifier:a.mobile},i=JSON.stringify({EventName:"Resend_OTP",EventSubGroup:"signup",Action:"mobile"});$(document).trigger("loginInteractions",[i]),a.resetServerMessages(),a.bbLoader=!0,o.postHulk("/mapi/v4.0.0/member-svc/otp/send/",t,s).then(function(t){a.bbLoader=!1,a.otpResendMessage=t.message,document.querySelector("#otp").focus(),n(function(){a.otpResendMessage="",e.$digest()},6e3),a.ToggleTimer(!0)})["catch"](function(e){a.bbLoader=!1,a.showResend=!1,a.otpResendMessage="Somethings went wrong,Plaese try again",n(function(){a.otpResendMessage=""},3e3);var t=JSON.stringify({EventName:"Resend_OTP_Failed",EventSubGroup:"signup",Action:"mobile",FailureReason:e});$(document).trigger("loginInteractions",[t])})};var l={};a.ToggleTimer=function(t){function o(){n<0&&(clearInterval(l),a.showResend=!0,e.$digest())}var n=30;t&&"null"!=document.getElementById("timeLeftInSeconds")?l=setInterval(function(){n<10&&(n="0"+n),document.getElementById("timeLeftInSeconds").innerHTML="00:"+n,n-=1,o()},1e3):(clearInterval(l),a.showResend=!1)},a.signupWithOTPLinkClicked=function(e,t){t?d(a.mobile):(a.login.showEmailError=!0,shake())},a.loginWithOTP={};var d=function(t){a.ToggleTimer(!1),$(document).trigger("authScreenViews",[{EventName:"Mobile_OTP_Verification_Shown",ScreenType:"Mobile_OTP_verification",ScreenURL:window.location.origin+"/Signup/Mobile_OTP_Verification/",ScreenSlug:"/Signup/Mobile_OTP_Verification/",ReferrerURL:window.location.origin+"/signup/",ReferrerSlug:"/signup/",ReferrerType:"signup"}]),a.loginWithOTP.sendOTP=function(){a.showResend=!1,a.resetServerMessages();var i={identifier:t};a.bbLoader=!0,o.postHulk("/mapi/v4.0.0/member-svc/otp/send/",i,s).then(function(t){a.bbLoader=!1,t.success?t.error_code?a.loginWithOTP.otpError=t.message:(a.loginWithOTP.OTP="",a.loginWithOTPForm.$setUntouched(),a.loginWithOTPForm.$setPristine(),a.otpResendMessage="OTP sent successfully",document.querySelector("#otp").focus(),n(function(){a.otpResendMessage="",e.$digest()},6e3),a.ToggleTimer(!0)):t&&console.log(JSON.stringify(t))})["catch"](function(e){a.bbLoader=!1,a.showResend=!1,a.otpResendMessage="Somethings went wrong,Please try again";var t=JSON.stringify({EventName:"Resend_OTP_Failed",EventSubGroup:"signup",Action:"mobile",FailureReason:e});$(document).trigger("loginInteractions",[t]),n(function(){a.otpResendMessage=""},3e3)})},a.isEditIdentifier=!1,a.showLoginWithOTPForm=!0,a.showBusinessLogin=!1,a.showSignupForm=!1,a.showSocialVerify=!1,a.loginWithOTP.OTP="",a.loginWithOTP.otpError="",s.showNavTabs=!1,n(function(){a.loginWithOTPForm.$setUntouched(),a.loginWithOTPForm.$setPristine(),a.loginWithOTP.sendOTP()},0)};a.verifyOtp=function(e,t){e&&d(t)},a.loginWithOTP.submit=function(t,n){if(a.ToggleTimer(!1),t.preventDefault(),n){var i={mobile_no:a.mobile,mobile_no_otp:a.loginWithOTP.OTP},r="mobile";"social"==a.signupMethod&&void 0!==a.socialUser&&(a.socialUser&&"facebook"===a.socialUser.provider?(i.fb_token=a.socialToken,r="facebook"):(i.google_token=a.socialToken,r="google")),a.resetServerMessages(),a.loginWithOTP.otpError="",a.bbLoader=!0,o.postHulk("/mapi/v4.0.0/member-svc/signup/",i,s).then(function(t){if(a.bbLoader=!1,t.success){if(!t.error_code){var o=JSON.stringify({EventName:"SignUp_Success",EventSubGroup:"signup",Action:r});return $(document).trigger("loginInteractions",[o]),a.ToggleTimer(!1),a.showLoginWithOTPForm=!1,void 0!==a.socialUser&&("facebook"===a.socialUser.provider?(a.fname=a.socialUser.first_name,a.lname=a.socialUser.last_name,a.email=a.socialUser.email):(a.fname=a.socialUser.user&&a.socialUser.user.firstName,a.lname=a.socialUser.user&&a.socialUser.user.lastName,a.email=a.socialUser.user&&a.socialUser.user.email)),s.showNavTabs=!1,a.almostThere=!0,window.loginScreen="almostThere",$(document).trigger("authScreenViews",[{EventName:"Signup_details_screen_Shown",ScreenType:"Signup_details_screen",ScreenURL:window.location.origin+"/signup/Signup_details_screen/",ScreenSlug:"/Signup_details_screen/",ReferrerURL:window.location.origin+"/Signup/Mobile_OTP_verification/",ReferrerSlug:"/Mobile_OTP_verification/",ReferrerType:"Mobile_OTP_verification"}]),void e.$digest()}if("HU4000"===t.error_code)s.showNavTabs=!1,a.showSignupForm=!1,a.showSocialVerify=!0;else if("HU4000"!==t.error_code){a.loginWithOTP.otpServerError=t.message,a.loginWithOTP.errorCode=t.error_code;var o=JSON.stringify({EventName:"SignUp_Failed",EventSubGroup:"signup",Action:"HU4006"===t.error_code?"Mobile":r,FailureReason:t.message});$(document).trigger("loginInteractions",[o]),e.$digest()}}else{t.show_message&&(a.loginWithOTP.otpError=t.data.message),a.error_messages.mobile=t.message,a.loginWithOTPForm.$setUntouched(),a.loginWithOTPForm.$setPristine();var o=JSON.stringify({EventName:"SignUp_Failed",EventSubGroup:"signup",Action:r,FailureReason:"Something went wrong"});$(document).trigger("loginInteractions",[o]),shake()}})["catch"](function(e){a.bbLoader=!1,a.loginWithOTP.otpServerError="Something went wrong , Please try again"})}},e.$on("mbUpdated",function(e){a.mobile=s.preserved.mobileNumber?s.preserved.mobileNumber:""}),a.loginRedirect=function(e){window.mobileNumber=a.mobile,"signup"===e?(a.showLoginWithOTPForm=!1,s.switchLoginTab("signup",a.mobile),s.showNavTabs=!0):(a.showLoginWithOTPForm=!1,s.switchLoginTab("login",a.mobile),s.showNavTabs=!0,s.preservedMobileNumber=a.mobile)},a.signupSubmit=function(t,i){if(a.ToggleTimer(!1),t.preventDefault(),a.fname||a.lname||a.email){var r={first_name:a.fname,last_name:a.lname,email:a.email};a.error_messages={email:""},a.bbLoader=!0,o.postHulk("/mapi/v4.0.0/member-svc/update/",r,s).then(function(t){if(a.bbLoader=!1,t.success)if(t.error_code){a.error_messages.update=t.message,angular.element(document.querySelector("#email")).addClass("ng-invalid"),e.$digest();var o=JSON.stringify({EventName:"AddEmail_Failed",EventSubGroup:"signup",Action:"email",FailureReason:t.message});$(document).trigger("loginInteractions",[o])}else{if(localStorage.getItem("nexUrl"))return window.location.href=window.location.origin+localStorage.getItem("nexUrl"),void localStorage.setItem("nexUrl","");window.location.href="/",s.redirect(),s.close()}else{a.reset_form(),a.show_server_error(t.data),c.addClass("shake"),n(function(){c.removeClass("shake")},500);var o=JSON.stringify({EventName:"SignUp_Failed",EventSubGroup:"signup",Action:"mobile",FailureReason:t.message});$(document).trigger("loginInteractions",[o])}})["catch"](function(e){a.bbLoader=!1,a.error_messages.update="Something went wrong , Please try again"})}else{if(localStorage.getItem("nexUrl"))return window.location.href=window.location.origin+localStorage.getItem("nexUrl"),void localStorage.setItem("nexUrl","");window.location.href="/"}},a.validateOldCaptcha=function(e){a.captcha_0&&a.captcha_1&&a.signupSubmit(e,!0)},a.signup=function(t){a.captcha_public_key?grecaptcha.ready(function(){grecaptcha.execute(CAPTCHA_PUBLIC_KEY,{action:"signup"}).then(function(o){fetch("/post_recaptcha/",{method:"post",headers:{"Content-Type":"application/json","X-CSRFToken":$.cookie("csrftoken"),"X-Requested-With":"XMLHttpRequest"},credentials:"include",body:JSON.stringify({token:o,action:"signup"})}).then(function(o){return o.ok?o.json():(a.showCaptcha=!0,e.$digest(),a.validateOldCaptcha(t,!0),void 0)}).then(function(o){"200"!==o.status?(a.showCaptcha=!0,e.$digest(),a.validateOldCaptcha(t,!0)):(a.showCaptcha=!1,a.signupSubmit(t,!1))})})}):(a.showCaptcha=!0,e.$digest(),a.validateOldCaptcha(t,!0))};var u=function(e,t){return new Promise(function(o,n){var i=document.getElementById(e);if(!i){var r=document.createElement("script");r.setAttribute("type","text/javascript"),r.setAttribute("id",e),r.setAttribute("src",t),r.addEventListener("load",o),r.addEventListener("error",function(){return n(new Error("Error loading ".concat(e,".")))}),r.addEventListener("abort",function(){return n(new Error("".concat(e,"  loading aborted.")))}),document.getElementsByTagName("head")[0].appendChild(r)}})},p=function(){var e="googleAuth",t="//apis.google.com/js/client:platform.js";return u(e,t)};a.initGoogle=function(){try{p();var e={client_id:"610100195438-jbg7jnikaqbn0rsiicbf72s45t55dvt1.apps.googleusercontent.com",scope:"profile email"};window.gapi.load("auth2",function(){window.gapi.auth2.getAuthInstance()||window.gapi.auth2.init(e)})}catch(t){console.log(t.name,":",t.message)}};var g=function(e){console.log("==== google onError ===="),console.log(e)};a.googleSignup=function(){var e=window.gapi.auth2.getAuthInstance();a.bbLoader=!0;var t=JSON.stringify({EventName:"Social_Clicked",EventSubGroup:"signup",Action:"google"});$(document).trigger("loginInteractions",[t]),e.signIn().then(function(e){var t=e.getBasicProfile(),o={};o.identity={uid:t.getId(),provider:"google"},o.user={email:t.getEmail(),firstName:t.getGivenName(),lastName:t.getFamilyName()},o.auth=e.getAuthResponse(),f(o)},function(e){return window.location.href="/",a.bbLoader=!1,g(e)})};var m=function(){var e="facebookAuth",t="http://connect.facebook.net/en_US/sdk.js";return u(e,t)};a.initFacebook=function(){try{m();var e={appId:"1397993430473589",cookie:!0,xfbml:!0,version:"v5.0"};window.FB.init(e),window.FB.getLoginStatus(function(e){console.log("FB:status:",e.status)},!0)}catch(t){console.log(t.name,":",t.message)}},a.initGoogle=function(){try{p();var e={client_id:"610100195438-jbg7jnikaqbn0rsiicbf72s45t55dvt1.apps.googleusercontent.com",scope:"profile email"};window.gapi.load("auth2",function(){window.gapi.auth2.getAuthInstance()||window.gapi.auth2.init(e)})}catch(t){console.log(t.name,":",t.message)}},a.initFacebook(),a.initGoogle(),a.facebookSignup=function(){a.bbLoader=!0;var e=JSON.stringify({EventName:"Social_Clicked",EventSubGroup:"signup",Action:"facebook"});$(document).trigger("loginInteractions",[e]),window.FB.getLoginStatus(function(e){console.log("FB:status:",e.status);var t={provider:"facebook"};return"connected"===e.status?(t.uid=e.authResponse.accessToken,void i().then(function(e){f(t)})):void FB.login(function(e){console.log("FB:status:",e.status),e.authResponse?(t.uid=e.authResponse.accessToken,i().then(function(e){f(t)})):window.location.href="/"},{scope:"public_profile,email",return_scopes:!0})})};var f=function(t){var o={},n="";t.provider&&"facebook"===t.provider?(o.fb_token=t.uid,n="facebook"):(o.google_token=t.auth.id_token,n="google");var i={};t&&"facebook"===t.provider?(a.socialToken=t.uid,i.fb_token=t.uid,i.email=a.socialUser.email):(a.socialToken=t.auth.id_token,i.google_token=t.auth.id_token,i.email=t.user.email,a.socialUser=t),r(o).then(function(t){t.success&&!t.error_code?(a.bbLoader=!1,a.signupMethod="social",s.showNavTabs=!1,a.showSignupForm=!1,a.showSocialVerify=!0,e.$apply(function(){e.$digest()})):(a.loginWithOTP.otpServerError=t.message,e.$digest())})};a.checkPassword=function(e){a.isPasswordValid=e>0},a.donotAllowSpecialChars=function(e){e.key.search(/^[a-zA-Z0-9\s]+$/)==-1&&e.preventDefault()}}function make_req_url(e){return("https:"==window.location.protocol?"/auth":"")+e}function get_cookie(e){var t=document.cookie.indexOf(e);if(t>-1){var o=document.cookie.indexOf("=",t)+2,n=document.cookie.indexOf('"',o);return document.cookie.substring(o,n)}return null}function initializeKaptureSupport(){if("object"==typeof Kapchat)return initKapchat();var e=document.getElementsByTagName("head")[0],t=document.createElement("script");t.type="text/javascript",t.src="https://www.adjetter.com/static/assets/global/plugins/supportmessenger/js/kapturecustomersupport.v2.min.js",t.onload=initKapchat,e.appendChild(t)}function initKapchat(){if(!get_cookie("_bb_mid"))return!1;var e=$.ajax({url:"/get_kptur/",method:"GET"});e.done(function(e){"use strict";t(e.ency,e.kkye)});var t=function(e,t){Kapchat.initialize({customercode:e,key:"183456e7b3122af0e470176ba2d207a4",iv:t,context:"kapchat-widget-btn",label:"Customer Support",widget:"kp_widget_tk",success:function(){},error:function(e){console.log(e)}})}}!function(){"use strict";angular.module("app",["app.core","app.layout","app.customPage","app.engagementStore","app.GiftCard"])}(),function(){"use strict";angular.module("app.core",["ngSanitize","ngAnimate","ui.bootstrap","ui.select"])}(),function(){"use strict";function e(e){e.lazySizesConfig=e.lazySizesConfig||{},e.lazySizesConfig.srcAttr="data-src",e.lazySizesConfig.srcsetAttr="data-srcset"}e.$inject=["$window"],angular.module("app.customPage",["ui.scrollpoint"]).run(e)}(),function(){"use strict";angular.module("app.engagementStore",[])}(),function(){"use strict";angular.module("app.GiftCard",[])}(),function(){"use strict";angular.module("app.layout",["ngCookies"])}(),function(){"use strict";angular.module("blocks.exception",["blocks.logger"])}(),function(){"use strict";angular.module("blocks.logger",[])}(),function(){"use strict";angular.module("blocks.router",["ngRoute","blocks.logger"])}(),function(){"use strict";function e(e,t,o,n){o.useApplyAsync(!0),e.debugEnabled&&e.debugEnabled(!1),t.startSymbol("{[{"),t.endSymbol("}]}"),o.defaults.xsrfCookieName="csrftoken",o.defaults.xsrfHeaderName="X-CSRFToken",o.defaults.headers.common["X-Requested-With"]="XMLHttpRequest",o.defaults.headers.post["X-CSRFToken"]=$.cookie("csrftoken"),n.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|chrome-extension|bigbasket):/)}e.$inject=["$logProvider","$interpolateProvider","$httpProvider","$compileProvider"];var t=angular.module("app.core"),o={appErrorPrefix:"[Bigbasket Error] ",appTitle:"Custom Page",version:"1.0.0"};t.value("config",o),t.config(e),t.config(["$locationProvider",function(e){e.html5Mode({enabled:!0,requireBase:!1,rewriteLinks:!1}).hashPrefix("!")}]),t.constant("R",R),t.constant("toastr",toastr)}(),function(){"use strict";function e(e,t,o,n,i,r){function a(){return function(e){(/(android|ipad|playbook|silk|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(n.channel="mobile")}(navigator.userAgent||navigator.vendor||window.opera),n.channel}function s(e){e.bgColor=void 0==e.bgColor?"#fff":e.bgColor,e.colorStop1=void 0==e.colorStop1?"#fff":e.colorStop1,e.colorStop2=void 0==e.colorStop2?"#fff":e.colorStop2,"bgImage"==e.bgOption&&void 0==e.picFile&&(e.bgOption="plainColor"),void 0==e.picFile&&(e.picFile={});var t={"background-color":e.bgColor,display:"block"},o={"background-image":"-webkit-gradient(linear, left top, right top, color-stop(0%,"+e.colorStop1+"), color-stop(100%, "+e.colorStop2+")"},n={"background-image":"radial-gradient(ellipse farthest-corner at 50% 50% , "+e.colorStop1+" 0%, "+e.colorStop1+" 50%, "+e.colorStop2+" 95%)",height:"100%",margin:"0","background-repeat":"no-repeat","background-attachment":"fixed"},i={background:"url("+e.picFile+")  no-repeat left center","background-size":"cover",height:"100%",margin:"0","background-attachment":"fixed"},r={background:"url("+e.picFile+") repeat",margin:"0"};"plainColor"==e.bgOption?p.appliedStyle=t:"gradientColor"==e.bgOption?"Linear"==e.pattern?p.appliedStyle=o:p.appliedStyle=n:"bgImage"==e.bgOption&&("selectedBGImage"==e.imagePattern?p.appliedStyle=i:p.appliedStyle=r),$(document.body).css(p.appliedStyle)}function c(){1==is_search_page||2==is_search_page?(n.nc="ps",d(slug)):3==is_search_page?(n.nc="sugg-ps",d("")):l()}function l(){t.getCustomPage().then(function(e){if(null!==e){p.customPage=e;var t=u(p.customPage);return t.then(function(){$(m).fadeIn(2e3)}),p.customPage}})}function d(e){1==is_search_page?1==p.searchJsonData.show_deck&&(p.searchJsonData.suggestion&&(e=p.searchJsonData.suggestion),t.getSearchPageData(e,"deck").then(function(e){if(null!=e){p.customPage={},p.customPage={pageGroupId:"",id:"",pgIrlNam:"",internalName:"",pageStyl:{}},e.structure.commonly_searched=p.searchJsonData.commonly_searched,e.structure.suggestion_message=p.searchJsonData.suggestion_message,e.structure.banners=p.searchJsonData.banners,p.customPage.sectionDetails=[e.structure];var t=u(p.customPage);return t.then(function(){$(m).fadeIn(2e3)}),p.customPage}})):2==is_search_page?t.getSearchPageData(e,"now-new").then(function(e){if(null!=e){p.customPage={},p.customPage={pageGroupId:"",id:"",pgIrlNam:"",internalName:"",pageStyl:{}},e.sectionDetails=t.updateNewAtBBList(e.sectionDetails,p.searchJsonData),p.customPage.sectionDetails=e.sectionDetails;var o=u(p.customPage);return o.then(function(){$(m).fadeIn(2e3)}),p.customPage}}):3==is_search_page?t.getSearchPageData(e,"sugg_search").then(function(e){if(null!=e){p.customPage={},p.customPage={pageGroupId:"",id:"",pgIrlNam:"",internalName:"",pageStyl:{}},e.sectionDetails=t.updateSuggestionList(e.sectionDetails,p.searchJsonData.suggested_search),p.customPage.sectionDetails=e.sectionDetails;var o=u(p.customPage);return o.then(function(){$(m).fadeIn(2e3)}),p.customPage}}):3==is_search_page&&t.getSearchPageData(e,"sugg_search").then(function(e){if(null!=e){p.customPage={},p.customPage={pageGroupId:"",id:"",pgIrlNam:"",internalName:"",pageStyl:{}},e.sectionDetails=t.updateSuggestionList(e.sectionDetails,p.searchJsonData.suggested_search),p.customPage.sectionDetails=e.sectionDetails;var o=u(p.customPage);return o.then(function(){$(m).fadeIn(2e3)}),p.customPage}})}function u(t){var n=i.defer();return r(function(){var i=t.sectionDetails;p.setBackgroundColor(t.pageStyl);t.breakStyl;$(m).hide();var r={},a={};i=g(i);var s=1;angular.forEach(i,function(n,i){r=e.$new(),n.display_pos=s++,n.order=Number(n.order)+1,r.dsection=n,r.dsection.pagegroupid=t.pageGroupId,r.dsection.pageid=t.id,r.dsection.pgIrlNam=t.pgIrlNam,r.dsection.pageinternalName=t.internalName,r.dsection.pageStyle=t.pageStyl,a=o(n.layout.renderingDirective)(r),m.append(a)}),n.resolve("Complete")}),n.promise}var p=this;p.customPage={},p.appliedStyle={},p.setBackgroundColor=s,p.searchJsonData="{}",void 0!=SEARCH_JSON_DATA&&(p.searchJsonData=JSON.parse(SEARCH_JSON_DATA));var g=R.sortBy(R.prop("order")),m=$("#dynamicDirective");n.USED_STATIC_URL=USED_STATIC_URL,n.channel="desktop",n.nc="custompage"==ctype?"cp":"ct",a(),c()}angular.module("app.customPage").controller("CustomPage",e),e.$inject=["$scope","CustomPageDataService","$compile","$rootScope","$q","$timeout"]}(),function(){"use strict";function e(){var e={link:function(e,t,o){t.bind("error",function(){angular.element(this).attr("src",o.fallbackSrc)})}};return e}function t(e){function t(t,o,n){var i=e(t.sectionModel.info)(t),r=angular.element(o)[0].querySelector("section");angular.element(r).append(i)}return{restrict:"E",scope:{sectionModel:"="},templateUrl:"app/templates/innertemplates/information.html",link:t}}function o(e){function t(t,o,n){t.sectionData=t.sectionModel.section_data,t.pushToGoogleAnalytics=e.pushToGoogleAnalytics()}return{restrict:"E",scope:{sectionModel:"="},templateUrl:"app/templates/innertemplates/saving.html",link:t}}function n(e,t,o,n,i,r){function a(){S.selectedQuantity=void 0===k?0:k,S.selectedQuantityText=void 0===k?"":S.selectedQuantity+" in basket",k?S.check=!0:S.check=!1}function s(){t.ismember?t.$broadcast("Notify",S.selectedProduct.sku):window.location.href="/auth/login/?nc=nb"}function c(e){S.available=e}function l(e){return R.isEmpty(e)}function d(o){if(void 0!==o&&null!==o&&0!==Object.keys(o).length&&o.constructor!==Object){if(S.flashIsOff=!1,1==o.show_counter){var n=(new Date).getTime()/1e3;e.timeConverter(n),t.$on("TimeCheck",function(t,o){e.timeConverter(o.data)})}else S.flashMessage=S.selectedProduct.sale_info.display_message;return!0}return!1}function u(t){return e.baseurl+"/"+t.p_img_url}function p(e){return E.test(e.fi_type)}function g(e){var o=t.member_stores[e.availability_info_id];if(o){if("normal"==o.fi_type||"jit"==o.fi_type){o.eta}else if("marketplace"==o.fi_type)o.eta=" ";else{if(!t.is_express_availaible||"BB EXPRESS (SLOTS FULL)"===t.express_closed)return!1;o.eta}return o}return!1}function m(e){var o=t.member_stores[e.availability_info_id];return void 0!==o}function f(){S.selectedQuantity=n.getformatedcart()[S.selectedProduct.sku],S.selectedQuantityText=void 0===S.selectedQuantity?"":S.selectedQuantity+" in basket",S.startQuantity=void 0===S.selectedQuantity?1:S.selectedQuantity,S.selectedQuantity?S.check=!0:S.check=!1}function h(){if(S.selectedQuantity>1){var e=Number(S.selectedQuantity)-1;n.updateCartQuantity(S.selectedProduct.sku,e,S.sid).then(function(e){e&&(n.getCart().then(function(e){_(),S.selectedQuantity=n.getformatedcart()[S.selectedProduct.sku],S.startQuantity=S.selectedQuantity,S.selectedQuantityText=S.selectedQuantity+" in basket",S.selectedProduct.is_feature_selected=S.selectedQuantity,0===S.selectedQuantity&&(S.rmActivated(),S.startQuantity=1,S.selectedProduct.is_feature_selected=0)}),$(document).trigger("basketInteractionsPlowerWithAngular",[{EventName:"Basket_Decrement",SkuID:S.selectedProduct.sku,Quantity:1,UnitMrp:S.selectedProduct.mrp,UnitSalePrice:S.selectedProduct.sp,ScreenInPageContext:S.sectionModel.internalName,ScreenInPagePosition:Number(S.sectionModel.display_pos)}]),r.pushToGoogleAnalytics("_trackEvent","decr-quantity","custom-page",S.sectionModel.display_pos+" | "+S.sectionModel.pageinternalName+" | "+S.ga_section_name+" | "+S.sectionModel.internalName+" | "+S.selectedProduct.sku+" | "+S.selectedProduct.p_desc+" | "+S.itemposition,1))})}else 1===S.selectedQuantity&&n.deleteFromBasket(S.selectedProduct.sku,S.sid).then(function(e){e?(n.getCart().then(function(e){_(),S.selectedQuantity=0,S.startQuantity=1,S.check=!1,S.selectedProduct.is_feature_selected=0,i.success("","Successfully Removed "+S.selectedProduct.p_desc+"from basket ",{timeOut:400,positionClass:"toast-top-full-width",closeButton:!0,preventDuplicates:!0})}),$(document).trigger("basketInteractionsPlowerWithAngular",[{EventName:"Basket_Remove",SkuID:S.selectedProduct.sku,Quantity:S.selectedQuantity,UnitMrp:S.selectedProduct.mrp,UnitSalePrice:S.selectedProduct.sp,ScreenInPageContext:S.sectionModel.internalName,ScreenInPagePosition:Number(S.sectionModel.display_pos)}]),r.pushToGoogleAnalytics("_trackEvent","remove-from-cart","custom-page",S.sectionModel.display_pos+" | "+S.sectionModel.pageinternalName+" | "+S.ga_section_name+" | "+S.sectionModel.internalName+" | "+S.selectedProduct.sku+" | "+S.selectedProduct.p_desc+" | "+S.itemposition,1)):i.error("Could not remove product ","Remove From Basket")})}function _(){t.$broadcast("getCart",S.selectedProduct)}function v(){var e=Number(S.selectedQuantity)+1;n.updateCartQuantity(S.selectedProduct.sku,e,S.sid).then(function(e){e&&(n.getCart().then(function(e){_(),S.selectedQuantity=n.getformatedcart()[S.selectedProduct.sku],S.startQuantity=S.selectedQuantity,S.selectedQuantityText=S.selectedQuantity+" in basket"}),$(document).trigger("basketInteractionsPlowerWithAngular",[{EventName:"Basket_Increment",SkuID:S.selectedProduct.sku,Quantity:1,UnitMrp:S.selectedProduct.mrp,UnitSalePrice:S.selectedProduct.sp,ScreenInPageContext:S.sectionModel.internalName,ScreenInPagePosition:Number(S.sectionModel.display_pos)}]),r.pushToGoogleAnalytics("_trackEvent","incr-quantity","custom-page",S.sectionModel.display_pos+" | "+S.sectionModel.pageinternalName+" | "+S.ga_section_name+" | "+S.sectionModel.internalName+" | "+S.selectedProduct.sku+" | "+S.selectedProduct.p_desc+" | "+S.itemposition,1))})}function b(t){S.startQuantity>0?n.updateCartQuantity(t.sku,S.startQuantity,S.sid).then(function(o){if(o.success){S.selectedQuantity=S.startQuantity,S.startQuantity=S.selectedQuantity,S.selectedQuantityText=S.startQuantity+" in basket",S.check=!0,S.selectedProduct.is_feature_selected=S.selectedQuantity,_(),$.cookie("_bb_ftvid")?($(".top-header").addClass("locpops"),$(".bb-brand-section").css("top","26px"),e.$emit("FirstTimeUser"),S.cityMessage=!0):($(".top-header").removeClass("locpops"),$(".bb-brand-section").css("top","0px"),S.cityMessage=!1,i.success("","Successfully added "+t.p_desc+" "+t.w+" to the basket",{timeOut:5e3,positionClass:"toast-top-full-width",closeButton:!0,preventDuplicates:!0,preventOpenDuplicates:!0})),S.check=!0,$(document).trigger("basketInteractionsPlowerWithAngular",[{EventName:"Basket_Add",SkuID:S.selectedProduct.sku,Quantity:S.selectedQuantity,UnitMrp:S.selectedProduct.mrp,UnitSalePrice:S.selectedProduct.sp,ScreenInPageContext:S.sectionModel.internalName,ScreenInPagePosition:Number(S.sectionModel.display_pos)}]);var a={id:t.sku,name:t.pc_n,brand:t.p_brand,category:t.tlc_n,quantity:1,price:t.sp};r.pushToGoogleAnalytics("_trackEvent","add-to-cart","custom-page",S.sectionModel.display_pos+" | "+S.sectionModel.pageinternalName+" | "+S.ga_section_name+" | "+S.sectionModel.internalName+" | "+S.selectedProduct.sku+" | "+S.selectedProduct.p_desc+" | "+S.itemposition,1,a),r.pushToGTM("add_to_basket_onclick",S.selectedProduct.sku,S.selectedQuantity,S.selectedProduct.sp)}else{var s=n.getformatedcart();s[t.sku]?S.startQuantity=s[t.sku]:S.startQuantity=1}}):(i.error("Invalid Quantity","Add To Basket",{timeOut:5e3,positionClass:"toast-top-full-width",closeButton:!0,preventDuplicates:!0,preventOpenDuplicates:!0}),S.check=!1)}function y(o){S.selectedProduct=o,S.selectedProduct.slug_desc=T(S.selectedProduct),S.selectedProduct.available=!1,S.selectedProduct&&!S.selectedProduct.is_promo&&(S.selectedProduct.available=!1,S.selectedProduct.stdDiv=C("standard",t.member_stores,S.selectedProduct.store_availability),S.selectedProduct.expDiv=C("express",t.member_stores,S.selectedProduct.store_availability),P(S.selectedProduct.stdDiv,S.selectedProduct.expDiv)&&(S.selectedProduct.available=!0),null!==S.selectedProduct.stdDiv[2]&&S.selectedProduct.stdDiv[3]===!0&&null!==S.selectedProduct.expDiv[2]&&S.selectedProduct.expDiv[3]===!0&&(S.selectedProduct.showOneOOS=!0),S.calculate5kSlotHide(S.selectedProduct.stdDiv,S.selectedProduct.expDiv)),e.cartItem=n.getformatedcart(),e.cartItem&&e.cartItem[S.selectedProduct.sku]?(e.cartItem=n.getformatedcart(),k=e.cartItem[S.selectedProduct.sku]):k=S.selectedProduct.incart?S.selectedProduct.incart:null,a(),$(this).dropdown("toggle")}function w(e,t){n.getMultiSkuComboProducts(e).then(function(e){if(e){var n=e.data;S.sectionModel.products=n,S.sectionModel.products.length>1?S.sectionModel.comboTitle="Combos using "+t:S.sectionModel.comboTitle="Combo using "+t;var i=S.sectionModel.products.length>3,r=S.sectionModel.products.length<3?S.sectionModel.products.length:3;$("#comboModal_"+S.sectionModel.section_id).modal("show"),$("#comboModal_"+S.sectionModel.section_id+" .close").on("click",function(){$(".comboCarousel").trigger("destroy.owl.carousel")}),o(function(){$("#comboModal_"+S.sectionModel.section_id+" .comboCarousel").trigger("owl.stop");$("#comboModal_"+S.sectionModel.section_id+" .comboCarousel").owlCarousel({loop:!1,margin:10,nav:i,navText:[" "," "],responsive:{0:{items:r},600:{items:r},1e3:{items:r}}})},500),$(document).width()>767&&(1==S.sectionModel.products.length?$("#comboModal_"+S.sectionModel.section_id+" .modal-dialog").css("width","285px"):2==S.sectionModel.products.length?$("#comboModal_"+S.sectionModel.section_id+" .modal-dialog").css("width","520px"):$("#comboModal_"+S.sectionModel.section_id+" .modal-dialog").css("width","730px"));
}})}var S=this,k=null,T=function(e){var t=[],o="";t.push(e.p_brand),t.push(e.p_desc),t.push(e.w);for(var n=function(e){if(e){var t=e.toLowerCase().trim();return t=t.replace(/[^a-z0-9\s-]/g," "),t=t.replace(/[\s-]+/g,"-")}},i=0;i<t.length;i++)o+=n(t[i])||"",i<t.length-1&&(o+="-");return o=n(o)},P=function(e,t){return e[3]===!1&&t[3]===!1||(null!==e[0]||null===e[2]||null!==t[0]||t[3]!==!0)&&(null===e[2]&&e[3]===!0||null===t[2]&&t[3]===!0)};S.calculate5kSlotHide=function(e,o){return!t.is_5k||void(o&&o[0]&&o[0].show_express===!0?S.selectedProduct.hideStdSlotFor5k=!0:o&&o[0]&&o[0].show_express===!1?(S.selectedProduct.stdDiv=S.selectedProduct.expDiv,S.selectedProduct.expDiv=[null,!1,null,!1]):e&&e[0]&&e[0].show_express===!0?(S.selectedProduct.expDiv=S.selectedProduct.stdDiv,S.selectedProduct.stdDiv=[null,!1,null,!1]):e&&e[0]&&e[0].show_express===!1&&(S.selectedProduct.hideExpSlotFor5k=!0))},S.OOSCheck=function(e){for(var o=0;o<e.length;o++){var n=C("standard",t.member_stores,e[o].store_availability),i=C("express",t.member_stores,e[o].store_availability);e[o].oos=!P(n,i)}};var C=function(e,t,o){for(var n=function(t){return t.tab_type===e&&"A"===t.pstat},i=function(t){return t.tab_type===e&&"O"===t.pstat},r=function(t){return t.tab_type===e},a=null,s=null,c=R.filter(n,o),l=R.filter(i,o),d=R.filter(r,o),u=0;u<c.length;u++)if(t[c[u].availability_info_id]){a=t[c[u].availability_info_id];break}for(var p=0;p<l.length;p++){var g=l[p].availability_info_id.replace(".OOSM","");if(t[g]){s=t[g];break}}var m=c.length>1;return[a,m,s,d.length>0]};S.selectedProduct=e.product,S.selectedProduct.hideStdSlotFor5k=!1,S.selectedProduct.hideExpSlotFor5k=!1,S.selectedProduct.slug_desc=T(S.selectedProduct),e.bigSave&&e.bigSave.show_discounted_price&&(S.selectedProduct.discounted_prices_v2?(S.selectedProduct.bigSaveEligible=e.bigSave.discounted_price_id_to_show in S.selectedProduct.discounted_prices_v2,S.selectedProduct.bigSavePrice=S.selectedProduct.discounted_prices_v2[e.bigSave.discounted_price_id_to_show]):S.selectedProduct.discounted_prices&&(S.selectedProduct.bigSaveEligible=e.bigSave.discounted_price_id_to_show in S.selectedProduct.discounted_prices,S.selectedProduct.bigSavePrice=S.selectedProduct.discounted_prices[e.bigSave.discounted_price_id_to_show]),angular.forEach(e.product.all_prods,function(t){t.discounted_prices&&(t.bigSaveEligible=e.bigSave.discounted_price_id_to_show in t.discounted_prices,t.bigSavePrice=t.discounted_prices[e.bigSave.discounted_price_id_to_show])}),S.bigSaveActiveInfo=e.bigSave.discounted_price_def[e.bigSave.discounted_price_id_to_show]),S.selectedProduct&&!S.selectedProduct.is_promo&&(S.selectedProduct.available=!1,S.selectedProduct.stdDiv=C("standard",t.member_stores,S.selectedProduct.store_availability),S.selectedProduct.expDiv=C("express",t.member_stores,S.selectedProduct.store_availability),P(S.selectedProduct.stdDiv,S.selectedProduct.expDiv)&&(S.selectedProduct.available=!0),null!==S.selectedProduct.stdDiv[2]&&S.selectedProduct.stdDiv[3]===!0&&null!==S.selectedProduct.expDiv[2]&&S.selectedProduct.expDiv[3]===!0&&(S.selectedProduct.showOneOOS=!0),S.calculate5kSlotHide(S.selectedProduct.stdDiv,S.selectedProduct.expDiv)),!e.feature&&S.selectedProduct&&(S.selectedProduct.incart||S.selectedProduct.no_items_in_cart)&&(k=S.selectedProduct.incart?S.selectedProduct.incart:S.selectedProduct.no_items_in_cart?S.selectedProduct.no_items_in_cart:null),S.itemposition=e.itmpos,S.sectionModel=e.sectionModel,S.ga_section_name="Default"==S.sectionModel.type?"BRPD":"CRPD",S.sid=e.sid,S.selectedQuantity=0,S.selectedQuantityText="",S.startQuantity=1,S.onProductChange=y,S.addToBasket=b,S.decreamentQuantity=h,S.increamentQuantity=v,S.broadcastEventNotify=s,S.imageUrl=u,S.showDeliveryDetails=g,S.typeOfIcon=p,S.showSlots=m,S.isPromoBlank=l,S.isFlashSaleBlank=d,S.flashIsOff=!0,S.flashMessage="",S.setAvailablity=c,S.check=void 0!==k,S.available=!1;var E=new RegExp("\\bexpress\\b");S.pushToGoogleAnalytics=r.pushToGoogleAnalytics,S.refreshcartQuantityforproduct=f,S.showMultiSkuComboProducts=w,a(),S.is_bb_brand=function(){var e=["fresho","bb royal","bb popular","fresho meat"];angular.forEach(e,function(e){S.selectedProduct.p_brand&&S.selectedProduct.p_brand.toLowerCase()===e&&(S.selectedProduct.bb_brand=!0)}),S.selectedProduct.mp_mrp="MRP: "},e.feature||S.is_bb_brand(),e.feature&&t.$on("getCart",function(e,t){t.is_feature_selected=t.is_feature_selected>0}),e.timeConverter=function(e){var t=S.selectedProduct.sale_info.end_time,o=1e3*(t-e),n=Math.floor(o%864e5/36e5),i=Math.floor(o%36e5/6e4),r="";n<=0?i<=0?o=0:r=i+"Min ":r=n+"Hrs "+i+"Min ",o<=0?S.flashMessage="":S.flashMessage="Ends in "+r},t.$on("CART_ITEM_CHANGED",function(e,t){S.selectedProduct.sku===t.sku&&(S.selectedQuantity=t.qty,S.startQuantity=0===S.selectedQuantity?1:t.qty,0==S.selectedQuantity?S.check=!1:S.check=!0,S.selectedQuantityText=S.selectedQuantity+" in basket")}),t.$on("PAGE_DATA_LOADED",function(){S.selectedProduct=e.product,S.selectedProduct.slug_desc=T(S.selectedProduct),S.selectedProduct&&!S.selectedProduct.is_promo&&(S.selectedProduct.available=!1,S.selectedProduct.stdDiv=C("standard",t.member_stores,S.selectedProduct.store_availability),S.selectedProduct.expDiv=C("express",t.member_stores,S.selectedProduct.store_availability),P(S.selectedProduct.stdDiv,S.selectedProduct.expDiv)&&(S.selectedProduct.available=!0),null!==S.selectedProduct.stdDiv[2]&&S.selectedProduct.stdDiv[3]===!0&&null!==S.selectedProduct.expDiv[2]&&S.selectedProduct.expDiv[3]===!0?S.selectedProduct.showOneOOS=!0:S.selectedProduct.showOneOOS=!1,S.calculate5kSlotHide(S.selectedProduct.stdDiv,S.selectedProduct.expDiv))})}function i(){return{restrict:"E",scope:{product:"=",baseurl:"@",sid:"@",cartItem:"=",sectionModel:"=",itmpos:"@",bigSave:"="},templateUrl:"app/templates/innertemplates/productTemplate.html",controller:["$scope","$rootScope","$timeout","UserDataservice","toastr","CustomPageDataService",n],controllerAs:"vm"}}function r(){return{restrict:"E",scope:{product:"=",baseurl:"@",sid:"@",cartItem:"=",sectionModel:"=",itmpos:"@",bigSave:"="},templateUrl:"app/templates/innertemplates/productTemplateInContainer.html",controller:["$scope","$rootScope","$timeout","UserDataservice","toastr","CustomPageDataService",n],controllerAs:"vm"}}function a(){return{restrict:"E",scope:{product:"=",baseurl:"@",sid:"@",cartItem:"=",sectionModel:"=",itmpos:"@",bigSave:"="},templateUrl:"app/templates/innertemplates/featuredProductTemplate.html",controller:["$scope","$rootScope","$timeout","UserDataservice","toastr","CustomPageDataService",n],controllerAs:"vm"}}function s(e,t,o){function n(e,t,o,n){function i(){A.filterCount=0,angular.forEach(A.filters,function(e,t){"tabbed"!=e.type&&angular.forEach(e.appliedFilters,function(e,t){A.filterCount+=1})})}function r(e){A.ignore_productdeck_call=!1,A.is_init=!1,A.selectedSort=e,A.execute=!1;var t=R.find(R.propEq("value",e))(A.sortOptions).display_name;o.pushToGoogleAnalytics("_trackEvent",A.nc_sort,"custom-page",t,1),c(),A.currentActiveTab.currentpage=1,location.hash="!page="+A.currentActiveTab.currentpage,angular.forEach(A.bootstrapTabs,function(e,t){e.currentpage=1}),A.justFiltered=!0,F()?A.endofPage=!0:A.endofPage=!1;var n={};n.o=A.selectedSort,n.sid="",n.sortCriteria=t,$(document).trigger("filterInteractionsPlower",[n])}function a(e){return"/pc/"+e+"/?nc=fa&sid="+A.sid}function s(e,t,n,i){var r=1==e.selected?"Apply":"Unapply";if(o.pushToGoogleAnalytics("_trackEvent",A.nc,"custom-page",t+"|"+e.display_name+"|"+r,1),A.is_init=!1,A.ignore_productdeck_call=!1,A.currentActiveTab.currentpage=1,A.justFiltered=!0,A.execute=!1,F()?A.endofPage=!0:A.endofPage=!1,location.hash="!page="+A.currentActiveTab.currentpage,angular.forEach(A.bootstrapTabs,function(e,t){e.currentpage=1}),e.selected){R.find(R.propEq("name",t))(A.filters)?("categories"==n&&(R.find(R.propEq("name",t))(A.filters).appliedFilters=[]),R.find(R.propEq("name",t))(A.filters).appliedFilters.push({name:e.display_name,facetFilter:e})):A.filters.push({name:t,type:"facet",slug:n,appliedFilters:[{name:e.display_name,facetFilter:e}]});var a={};a.apply=!0,a.filter="1",a.filter_type=t,a.referrerInPageContext=void 0===i?"":i;var s=e.display_name;a.label=s.replace(/<\/?span[^>]*>/g,""),$(document).trigger("filterInteractionsPlower",[a])}else if("categories"!=n){var c=R.findIndex(R.propEq("name",t))(A.filters),l=R.findIndex(R.propEq("name",e.display_name))(A.filters[c].appliedFilters);A.filters[c].appliedFilters.splice(l,1),d(A.filters[c].appliedFilters,c)}A.reapplyFilters()}function c(){A.currentActiveTab.showmore=!1,M.sid=A.sid;var e=[];A.filters.length>0&&angular.forEach(A.filters,function(t,o){var n=[];angular.forEach(t.appliedFilters,function(e,t){n.push(e.facetFilter.filter_value_slug)}),e.push({filter_slug:t.slug,values:n})}),A.promos_cached=[],M.filters=e,A.is_init||A.ignore_productdeck_call||(A.ignore_productdeck_call=!1,A.sectionModel.productwidgetuserslug?o.updateProductDeck(A.sectionModel.productsystemtype,M,A.selectedSort,A.sectionModel.productwidgetuserslug,A.currentActiveTab.tab_type,sid,A.base_sid,A.offer_sub_type).then(S):slug&&o.updateProductDeck(A.sectionModel.productsystemtype,M,A.selectedSort,slug,A.currentActiveTab.tab_type,sid,A.base_sid,A.offer_sub_type).then(S))}function l(e,t,n){A.is_init=!1,A.ignore_productdeck_call=!1,o.pushToGoogleAnalytics("_trackEvent",A.nc,"custom-page",n.name+"|"+n.appliedFilters[t].facetFilter.display_name+"|Unapply",1);var i={};i.apply=!1,i.filter="1",i.filter_type=n.name,i.label=n.appliedFilters[t].facetFilter.display_name,$(document).trigger("filterInteractionsPlower",[i]),"tabbed"!==n.type?n.appliedFilters[t].facetFilter.selected=!1:A.activeTab=1,n.appliedFilters.splice(t,1),d(n.appliedFilters,e),A.filters.length>0?A.reapplyFilters():A.clearAllFilters()}function d(e,t){0===e.length&&A.filters.splice(t,1)}function u(){A.activeTab=1,A.currentActiveTab=A.bootstrapTabs[0],A.is_init=!1,o.pushToGoogleAnalytics("_trackEvent",A.nc,"custom-page","Clear All",1),g(),$(document).trigger("clearAll"),A.justFiltered=!0,F()?A.endofPage=!0:A.endofPage=!1,A.reapplyFilters()}function p(){var e=null;A.justFiltered=!0,A.currentActiveTab.product_info&&F()?A.endofPage=!0:A.endofPage=!1,A.activeTab=1,A.filters.length>0&&angular.forEach(A.filters,function(t,o){"tabbed"==t.type&&(e=o)}),null!=e&&A.filters.splice(e,1),c()}function g(){var e=R.filter(O,A.filters);angular.forEach(e,function(e,t){angular.forEach(e.appliedFilters,function(e,t){e.facetFilter.selected=!1})}),A.filters=[]}function m(e){if(A.currentActiveTab=e,e.product_info&&(A.numberOfProducts=e.product_info.p_count),e.header_section&&(A.header_section=e.header_section),A.ignore_productdeck_call=!1,e.customfacets?(A.facetFilters=e.customfacets.facets,f(A.facetFilters,R.findIndex(R.propEq("filter_name","Category"))(A.facetFilters),0),T(e)):e.filter_opts&&(A.facetFilters=e.filter_opts,f(A.facetFilters,R.findIndex(R.propEq("filter_name","Category"))(A.facetFilters),0),T(e)),"all"!==e.tab_type){A.is_init=!1;var t=null;A.filters.length>0&&angular.forEach(A.filters,function(e,o){"tabbed"==e.type&&(t=o)}),null!=t&&A.filters.splice(t,1),void 0===R.find(R.propEq("name",e.tab_name))(A.filters)&&(A.filters.push({name:e.tab_name,type:"tabbed",slug:e.tab_type,appliedFilters:[{name:"Yes",facetFilter:A.facetFilters}]}),$(document).trigger("filterInteractionsPlower",{filter_type:e.tab_name,apply:!0})),A.execute=!1,c()}else"all"===e.tab_type&&(p(),A.is_init===!1&&$(document).trigger("filterInteractionsPlower",{filter_type:e.tab_name,apply:!0}))}function f(e,t,o){if(t>0){var n=e.splice(t,1);e.unshift(n[0])}}function h(e){return"standard"===R.toLower(e)?"All Products":e}function _(){if(A.slug="",slug?A.slug=slug:A.sectionModel.productwidgetuserslug&&(A.slug=A.sectionModel.productwidgetuserslug),A.sectionModel.ignoresectionupload&&"1"==A.sectionModel.ignoresectionupload){if(void 0!=A.sectionModel.productwidgetuserslug&&A.sectionModel.productwidgetuserslug.length>0)var e=[y(A.sectionModel.productsystemtype,A.sectionModel.productwidgetuserslug)];else if(slug)var e=[y(A.sectionModel.productsystemtype,slug)];else if("mem.sb"===A.sectionModel.productsystemtype)var e=[y(A.sectionModel.productsystemtype)]}else var e=[w(A.sid)];return A.offer_sub_type&&"all-offers"!=A.offer_sub_type&&(A.is_offers_on_cat=!0),o.ready(e).then(function(){n(function(){$("#refine").click(function(){$("#offcanvas-refine").animate({bottom:"0"},0),$("#left-menu-overlay").fadeIn("slow")}),$("#close-refine, #apply-refine").click(function(){$("#offcanvas-refine").animate({bottom:"-100%"},0),$("#left-menu-overlay").fadeOut("slow")})})})}function v(){"ps"==A.sectionModel.productsystemtype&&(A.selectedSort="relevance",A.sortOrder="relevance")}function b(e){e.tab_info.length>0&&(t.sid=e.tab_info[0].sid,A.sid=e.tab_info[0].sid,A.filtered_sid=sid,L(e)),C(e),v(),A.execute=!0,$(window).scroll(function(){var e=$("#idToJump"+A.currentActiveTab.tab_type)[0],t=e.offsetTop,o=t+e.offsetHeight-$(window).height(),n=o-$(window).scrollTop();A.execute&&t+e.offsetHeight!=0&&n/(t+e.offsetHeight)*100<1&&(A.pagginator.loaded=!0,A.execute=!1,A.pagginator.paginate(2),$("#filterbar").trigger("sticky_kit:recalc"))})}function y(e,t){t||A.sectionModel.productwidgetuserslug.length>0&&(t=A.sectionModel.productwidgetuserslug),o.getSysGenProductDeck(e,t,A.sectionModel.productsystemtype,A.sectionModel.alloffersubtype).then(b)}function w(e){o.getProductDeck(e,null,A.offer_sub_type).then(C)}function S(e){var t=I(e.tab_info);A.quick_filterItems={},L(e),angular.forEach(A.bootstrapTabs,function(o,n){var i=R.findIndex(R.propEq("tab_name",o.tab_name))(e.tab_info);"Express"==o.tab_name&&"all"==o.tab_type&&(i=1),o.showmore=!1,o.currentpage=1,i<0?o.product_info&&(o.product_info.products=[]):(t[o.tab_type][0].customfacets?(o.filter_opts=t[o.tab_type][0].customfacets.facets,A.filtered_sid=t[o.tab_type][0].customfacets.sid):o.filter_opts=t[o.tab_type][0].filter_opts,o.filtered_on=t[o.tab_type][0].filtered_on,o.product_info=t[o.tab_type][0].product_info)});var o=t[A.currentActiveTab.tab_type][0];A.sortOptions=t[A.currentActiveTab.tab_type][0].sort_opts,A.sortOrder=t[A.currentActiveTab.tab_type][0].sorted_on,t[A.currentActiveTab.tab_type][0].customfacets?A.facetFilters=o.customfacets.facets:A.facetFilters=o.filter_opts,f(A.facetFilters,R.findIndex(R.propEq("filter_name","Category"))(A.facetFilters),0),D(o,o.reverse_merge),A.numberOfProducts=o.product_info.p_count,A.screen_name=e.screen_name,A.currentActiveTab.product_info.products=o.product_info.products,"mem.sb"===A.sectionModel.productsystemtype&&(A.short_list=o.product_info.short_list,A.long_list=o.product_info.long_list,A.reco_list=o.product_info.reco_list,1==A.currentActiveTab.show_reco_only?(P(A.reco_list.products),A.sb_list=[A.reco_list]):(P(A.short_list.products),P(A.long_list.products),A.sb_list=[A.short_list,A.long_list])),A.currentActiveTab.active=!0,setTimeout(function(){A.execute=!0},2e3),A.getfilterCount(),T(o)}function k(e,t){var o=!1;0==A.filters.length&&e.filtered_on.length>0&&(o=!0,"all"!==e.tab_type&&void 0===R.find(R.propEq("name",e.tab_name))(A.filters)&&A.filters.push({name:e.tab_name,type:"tabbed",slug:e.tab_type,appliedFilters:[{name:"Yes",facetFilter:t}]}));var n=e.filtered_on;angular.forEach(n,function(e,n){angular.forEach(t,function(t,n){e.filter_slug===t.filter_slug&&angular.forEach(e.values,function(e,n){angular.forEach(t.values,function(n,i){e===n.filter_value_slug&&(n.selected=!0,1==o&&(R.find(R.propEq("name",t.filter_name))(A.filters)?("categories"==t.filter_slug&&(R.find(R.propEq("name",t.filter_name))(A.filters).appliedFilters=[]),R.find(R.propEq("name",t.filter_name))(A.filters).appliedFilters.push({name:n.display_name,facetFilter:n})):A.filters.push({name:t.filter_name,type:"facet",slug:t.filter_slug,appliedFilters:[{name:n.display_name,facetFilter:n}]})))})})})}),A.getfilterCount()}function T(e){var t=e.filtered_on;angular.forEach(t,function(e,t){angular.forEach(A.facetFilters,function(t,o){e.filter_slug===t.filter_slug&&angular.forEach(e.values,function(e,o){angular.forEach(t.values,function(t,o){e===t.filter_value_slug&&(t.selected=!0)})})})})}function P(e){for(var t=0;t<e.length;t++){e[t].is_reco=!1,A.reco_list.id_list.indexOf(e[t].sku.toString())==-1&&1!=A.currentActiveTab.show_reco_only||(e[t].is_reco=!0);for(var o=0;o<e[t].all_prods.length;o++)if(e[t].all_prods[o].is_reco=!1,A.reco_list.id_list.indexOf(e[t].all_prods[o].sku.toString())!=-1||1==A.currentActiveTab.show_reco_only){e[t].all_prods[o].is_reco=!0;break}}}function C(e){A.bootstrapTabs=[],A.cart_info=e.cart_info,A.baseImageUrl=e.base_img_url,A.screen_name=e.screen_name,void 0!=e.base_sid&&(A.base_sid=e.base_sid,"all"==e.tab_to_show&&(sid=e.base_sid)),A.tab_info=I(e.tab_info);var t=1;angular.forEach(A.tab_info,function(o,n){A.currentActiveTab=o[0],A.facetFilters=o[0].customfacets.facets,D(o[0],o[0].reverse_merge),A.bootstrapTabs.push(o[0]),A.sortOptions=o[0].sort_opts,A.sortOrder=o[0].sorted_on,e.tab_to_show==o[0].tab_type&&(k(o[0],A.facetFilters),A.activeTab=t,$("#deck").show());var i=[];if(void 0!=A.currentActiveTab.product_info){var r=A.currentActiveTab.product_info.products.length;r>10&&(r=10);for(var a=0;a<r;a++)i.push(A.currentActiveTab.product_info.products[a].sku);window.dataLayer&&dataLayer.push({productlist1:i})}"mem.sb"===A.sectionModel.productsystemtype&&(A.short_list=A.currentActiveTab.product_info.short_list,A.long_list=A.currentActiveTab.product_info.long_list,A.reco_list=A.currentActiveTab.product_info.reco_list,1==A.currentActiveTab.show_reco_only?(P(A.reco_list.products),A.sb_list=[A.reco_list]):(P(A.short_list.products),P(A.long_list.products),A.sb_list=[A.short_list,A.long_list])),t+=1}),A.bootstrapTabs=x(A.bootstrapTabs)}function E(e,t,n,i,r){function a(n){"mem.sb"===A.sectionModel.productsystemtype&&(A.short_list.products&&(P(n.tab_info.product_map[e].short_list),A.short_list.products=R.concat(A.short_list.products,n.tab_info.product_map[e].short_list)),A.long_list.products&&(P(n.tab_info.product_map[e].long_list),A.long_list.products=R.concat(A.long_list.products,n.tab_info.product_map[e].long_list)),A.reco_list.products&&(P(n.tab_info.product_map[e].reco_list),A.reco_list.products=R.concat(A.reco_list.products,n.tab_info.product_map[e].reco_list))),A.tab_info[e][0].product_info.products?A.tab_info[e][0].product_info.products=R.concat(A.tab_info[e][0].product_info.products,n.tab_info.product_map[e].prods):A.tab_info[e][0].product_info.products=n.tab_info.product_map[e].prods,A.tab_info[e][0].promo_info?A.tab_info[e][0].promo_info.promos=n.tab_info.product_map[e].promos:A.tab_info[e][0].promo_info={promos:n.tab_info.product_map[e].promos},o.pushToGoogleAnalytics("_trackEvent",A.nc_paginate,"custom-page","pageview|scrolldown|page="+t,1),D(A.tab_info[e][0],A.tab_info[e][0].reverse_merge),A.numberOfProducts=A.tab_info[e][0].product_info.p_count,A.execute=!0;var i=$("#idToJump"+A.currentActiveTab.tab_type)[0],r=i.offsetTop,a=r+i.offsetHeight-$(window).height(),s=a-$(window).scrollTop();A.execute&&r+i.offsetHeight!=0&&s/(r+i.offsetHeight)*100<-25&&$("html, body").animate({scrollTop:$("#idToJump"+e).offset().top})}if(A.justFiltered=!1,A.sectionModel.productwidgetuserslug)if("mem.sb"==A.sectionModel.productsystemtype){var s=[],c=[],l=[];A.currentActiveTab.show_reco_only?l=A.reco_list.id_list.splice(0,20):(s=A.short_list.id_list.splice(0,20),s.length<20&&(c=A.long_list.id_list.splice(0,20-s.length))),o.getProductsForRestofTheTabs(A.sectionModel.productsystemtype,A.sid,e,t,i,A.selectedSort,r,A.sectionModel.productwidgetuserslug,A.offer_sub_type,s,c,l).then(a)}else o.getProductsForRestofTheTabs(A.sectionModel.productsystemtype,A.sid,e,t,i,A.selectedSort,r,A.sectionModel.productwidgetuserslug,A.offer_sub_type).then(a);else o.getProductsForRestofTheTabs(A.sectionModel.productsystemtype,A.sid,e,t,i,A.selectedSort,r,slug,A.offer_sub_type).then(a)}var A=this,M={sid:"",filters:[]};A.outofstockproduct="",A.sectionModel=e.sectionModel,e.Math=window.Math,A.dynamicBanners=[],A.sectionModel.banners&&(A.dynamicBanners=A.sectionModel.banners),A.tab_info={},A.bootstrapTabs=[],A.activeTab=1,A.screen_name="",A.header_section={},A.changeNameToAllProductsIfStandard=h,A.onClickingTabHeader=m,A.removeFilter=l,A.onFacetFilterChange=s,A.clearAllFilters=u,A.buildCategoryURL=a,A.sortOn=r,A.selectedSort="popularity",A.cart_info={},A.filters=[],A.facetFilters=[],A.brandSearch="",A.baseImageUrl="",A.numberOfProducts=0,A.sid=A.sectionModel.viewAllUrl,t.sid=A.sectionModel.viewAllUrl,A.filtered_sid=A.sectionModel.viewAllUrl,A.USED_STATIC_URL=USED_STATIC_URL,A.currentActiveTab={},A.sortOrder="popularity",A.reapplyFilters=c,A.ignore_productdeck_call=!1,A.is_init=!0,A.base_sid="",A.getfilterCount=i,A.filterCount=0,A.commonly_searched=e.sectionModel.commonly_searched?e.sectionModel.commonly_searched:{},A.suggestion_message=e.sectionModel.suggestion_message?e.sectionModel.suggestion_message:{},A.products_cached=[],A.promos_cached=[],A.is_offers_on_cat=!1,A.nc="custompage"==ctype?"cp-fa":"ct-fa",A.offer_sub_type=A.sectionModel.alloffersubtype,A.nc_paginate="custompage"==ctype?"cp":"ct",A.nc_sort="custompage"==ctype?"cp-sort":"ct-sort",A.justFiltered=!0,A.endofPage=!1,A.execute=!0,"undefined"!=typeof discount_data&&(A.bigSave=JSON.parse(discount_data));var I=R.groupBy(function(e){return e.tab_type}),x=R.sortBy(R.compose(R.toLower,R.prop("tab_type"))),O=(R.sortBy(R.compose(R.toLower,R.prop("filter_name"))),function(e){return"facet"===e.type});A.show_products=function(e){return e.product_info?e.product_info.products:[]};var D=function(e,t){var o=[],n=[];if(e.promo_info&&e.promo_info.promos){var i=function(e){return e.sku},r=function(e){return e.is_promo},a=R.filter(i,e.product_info.products),s=R.filter(r,e.product_info.products);o=R.concat(s,R.concat(e.promo_info.promos,A.promos_cached)),n=R.concat(a,A.products_cached);var c=U(n,o,"display_order",t);A.promos_cached=c.prom,A.products_cached=c.prod,console.log("final:",c),e.product_info.products=R.concat(c["final"],A.products_cached),A.products_cached=[],e.product_info.product_page==e.product_info.tot_pages&&(e.product_info.products=R.concat(e.product_info.products,A.promos_cached))}},U=function(e,t,o,n){function i(e,t,o){return e[o]<t[o]}function r(e,t,o){return e[o]>t[o]}var a=0,s=0,c=[],l=-1;n&&(l=1);var d=function(e,t){return(e[o]-t[o])*l};e=R.sort(d,R.uniqBy(R.prop("sku"),e)),t=R.sort(d,R.uniqBy(R.prop("promo_id"),t));var u=i;for(n&&(u=r);s<e.length&&a<t.length;)u(e[s],t[a],o)?(c.push(t[a]),t[a]=-1,a++):(c.push(e[s]),e[s]=-1,s++);var p=R.filter(function(e){return e!=-1},t),g=R.filter(function(e){return e!=-1},e);return c=R.concat(c,g),g=[],0==c.length&&p.length>0&&(c=p),{"final":c,prod:g,prom:p}},L=function(e){if(e.tab_info[0].header_section){var t=N(e.tab_info[0].header_section.items);delete t.undefined,A.quick_filterItems=t}};setTimeout(function(){$("#filterbar").stick_in_parent({parent:".sticky-parent",offset_top:60})},100);var N=R.groupBy(function(e){return e.filter_group}),F=function(){var e=A.currentActiveTab.currentpage>=A.currentActiveTab.product_info.tot_pages;return 1==e?A.endofPage=!0:A.endofPage=!1,e};A.pagginator={loaded:!1,loaderwidget:$("#pgloader"),tabcount:0,showmore:function(){return!!(A.currentActiveTab.product_info&&A.currentActiveTab.currentpage<A.currentActiveTab.product_info.tot_pages)||A.currentActiveTab.showmore},showmorepage:function(){location.hash="!page="+A.currentActiveTab.currentpage;var e=M.filters.length>0?M:null;E(A.currentActiveTab.tab_type,A.currentActiveTab.currentpage,A.currentActiveTab.tab_name,e,!0),$(".pd-loader").fadeIn(),setTimeout(function(){$(".pd-loader").fadeOut(),$("#filterbar").css("position","fixed")},1500)},paginate:function(t,o){if(A.currentActiveTab.showmore)A.currentActiveTab.product_info&&F()&&(A.currentActiveTab.showmore=!1);else if(A.pagginator.loaded){if(A.currentActiveTab.currentpage||(A.currentActiveTab.currentpage=1,location.hash="!page="+A.currentActiveTab.currentpage),A.currentActiveTab.product_info.tot_pages&&F())return A.currentActiveTab.showmore=!1,A.endofPage=!0,e.$apply(),!0;if(t>=0&&A.currentActiveTab.currentpage&&A.currentActiveTab.currentpage<A.currentActiveTab.product_info.tot_pages){var n=M.filters.length>0?M:null;if($(".pd-loader").fadeIn(),setTimeout(function(){$(".pd-loader").fadeOut(),$("#filterbar").css("position","fixed")},1500),A.currentActiveTab.currentpage?A.currentActiveTab.currentpage=A.currentActiveTab.currentpage+1:A.currentActiveTab.currentpage=2,A.currentActiveTab.currentpage<7){var i=R.findIndex(R.propEq("tab_name",A.currentActiveTab.tab_name))(A.bootstrapTabs);i&&(A.bootstrapTabs[i].currentpage=A.currentActiveTab.currentpage);var r=!0;$(document).trigger("snowscroll",[A.currentActiveTab.currentpage-1]),$(document).trigger("bannersOnScroll"),E(A.currentActiveTab.tab_type,A.currentActiveTab.currentpage,A.currentActiveTab.tab_name,n,r),location.hash="!page="+A.currentActiveTab.currentpage,e.$apply()}}}else A.pagginator.loaded=!0}},A.pagginator.loaderwidget.hide(),_()}return{restrict:"E",scope:{sectionModel:"="},controller:["$scope","$rootScope","CustomPageDataService","$timeout",n],controllerAs:"vm",templateUrl:"app/templates/innertemplates/productDeck.html"}}function c(e,t){function o(o,n,i){o.uid=_(),o.pushToGoogleAnalytics=t.pushToGoogleAnalytics,o.title=o.sectionModel.title,o.CategoryDetails=o.sectionModel.section_data.excel_data.CategoryDetails,o.BannerDetails=o.sectionModel.section_data.excel_data.BannerDetails,o.sectionId=o.sectionModel.section_id,o.pagegroupid=o.sectionModel.pagegroupid,o.viewAllUrl=o.sectionModel.viewAllUrl,o.viewAllUrlText=o.sectionModel.viewAllUrlText,o.pageid=o.sectionModel.pageid,o.MEDIA_URL=MEDIA_URL,o.CUSTOM_STATIC_URL=CUSTOM_STATIC_URL,o.status={},o.status.open=!1,o.useStaticImages=""===MEDIA_URL,e(function(){$("#"+o.uid).owlCarousel({autoplay:!0,autoplayTimeout:5e3,smartSpeed:600,autoplayHoverPause:!0,nav:!0,navText:[" "," "],items:1,lazyLoad:!0,loop:!0,responsiveClass:!0,responsive:{0:{items:1,loop:!0},600:{items:1,loop:!0},1e3:{items:1,loop:!0}}})}),o.style={},o.style.viewall=o.sectionModel.layout.viewAllStyle,o.style.headerStyle=o.sectionModel.pageStyle,o.style.categoryStyle=o.sectionModel.layout.style.CategoryStyle,o.style.categoryTitleStyle=o.sectionModel.layout.style.CategoryTitleStyle}return{restrict:"E",scope:{sectionModel:"="},templateUrl:"app/templates/innertemplates/combo.html",link:o}}function l(e){function t(t,o,n){t.sectionData=t.sectionModel.section_data.excel_data,t.title=t.sectionModel.title,t.uid=_(),t.pushToGoogleAnalytics=e.pushToGoogleAnalytics,t.sectionId=t.sectionModel.section_id,t.pagegroupid=t.sectionModel.pagegroupid,t.pageid=t.sectionModel.pageid,t.MEDIA_URL=MEDIA_URL,t.CUSTOM_STATIC_URL=CUSTOM_STATIC_URL,t.useStaticImages=""===MEDIA_URL,t.style={},t.style.headerStyle=t.sectionModel.pageStyle,t.style.block1={},t.style.block1.titleStyle=t.sectionModel.layout.style.blocks.block1.Title,t.style.block1.infoStyle=t.sectionModel.layout.style.blocks.block1.Info,t.style.block2={},t.style.block2.titleStyle=t.sectionModel.layout.style.blocks.block2.Title,t.style.block2.infoStyle=t.sectionModel.layout.style.blocks.block2.Info,t.style.block3={},t.style.block3.titleStyle=t.sectionModel.layout.style.blocks.block3.Title,t.style.block3.infoStyle=t.sectionModel.layout.style.blocks.block3.Info,t.style.block4={},t.style.block4.titleStyle=t.sectionModel.layout.style.blocks.block4.Title,t.style.block4.infoStyle=t.sectionModel.layout.style.blocks.block4.Info,t.style.block5={},t.style.block5.titleStyle=t.sectionModel.layout.style.blocks.block5.Title,t.style.block5.infoStyle=t.sectionModel.layout.style.blocks.block5.Info}return{restrict:"E",scope:{sectionModel:"="},templateUrl:"app/templates/innertemplates/nonLinear.html",link:t}}function d(e,t){function o(o,n,i){if(null==o.sectionModel.section_data)return!1;if("0"==o.sectionModel.ignoresectionupload)o.sectionData=o.sectionModel.section_data.excel_data;else if(o.sectionData=o.sectionModel.section_data,o.sectionData&&1==o.sectionData[0].show_random){var r=Math.floor(Math.random()*o.sectionData.length),a=R.splitAt(r,o.sectionData);o.sectionData=R.concat(a[1],a[0])}var s=function(){return o.sectionData[0].show_random&&1==o.sectionData[0].show_random?Math.floor(Math.random()*o.sectionData.length):0},c=o.sectionData.length>1;o.title=o.sectionModel.title,o.sectionId=o.sectionModel.section_id,o.pagegroupid=o.sectionModel.pagegroupid,o.pageid=o.sectionModel.pageid,o.MEDIA_URL=MEDIA_URL,o.CUSTOM_STATIC_URL=CUSTOM_STATIC_URL,o.useStaticImages=""===MEDIA_URL,o.uid=_(),o.pushToGoogleAnalytics=t.pushToGoogleAnalytics,e(function(){$("#"+o.uid).owlCarousel({autoplay:!0,autoplayTimeout:5e3,smartSpeed:600,autoplayHoverPause:!0,nav:!0,navText:[" "," "],items:1,lazyLoad:!0,mouseDrag:c,touchDrag:c,freeDrag:c,pullDrag:c,loop:c,responsiveClass:!0,responsive:{0:{items:1,loop:!0},600:{items:1,loop:!0},1e3:{items:1,loop:!0}},startPosition:s()})}),o.style={},o.style.BannerText=o.sectionModel.layout.style.BannerText,o.style.headerStyle=o.sectionModel.pageStyle}return{restrict:"E",scope:{sectionModel:"="},templateUrl:"app/templates/innertemplates/banners.html",link:o}}function u(e,t){function o(o,n,i){if(null==o.sectionModel.section_data)return!1;if("0"==o.sectionModel.ignoresectionupload)o.sectionData=o.sectionModel.section_data.excel_data;else if(o.sectionData=o.sectionModel.section_data,o.sectionData&&1==o.sectionData[0].show_random){var r=Math.floor(Math.random()*o.sectionData.length),a=R.splitAt(r,o.sectionData);o.sectionData=R.concat(a[1],a[0])}o.sectionData.length>1;o.title=o.sectionModel.title,o.sectionId=o.sectionModel.section_id,o.pagegroupid=o.sectionModel.pagegroupid,o.pageid=o.sectionModel.pageid,o.MEDIA_URL=MEDIA_URL,o.CUSTOM_STATIC_URL=CUSTOM_STATIC_URL,o.useStaticImages=""===MEDIA_URL,o.uid=_(),o.pushToGoogleAnalytics=t.pushToGoogleAnalytics,e(function(){var e=$(".fullWidth.outer-div .owl-carousel").owlCarousel({items:1,loop:!0,center:!0,navigation:!1,autoplayHoverPause:!0,autoplay:!0,autoplayTimeout:6e3,responsiveClass:!0,responsive:{991:{dotsContainer:"#carousel-custom-dots",dots:!0},0:{dots:!0,pagination:!1,navigation:!0}}});$("#carousel-custom-dots .owl-dot").click(function(){e.trigger("to.owl.carousel",[$(this).find("a").attr("id")])})}),o.style={},o.style.BannerText=o.sectionModel.layout.style.BannerText,o.style.headerStyle=o.sectionModel.pageStyle}return{restrict:"E",scope:{sectionModel:"="},templateUrl:"app/templates/innertemplates/bannerCaption.html",link:o}}function p(e,t){function o(o,n,i){o.sectionData=o.sectionModel.section_data.excel_data,o.uid=_(),o.pushToGoogleAnalytics=t.pushToGoogleAnalytics,o.sectionId=o.sectionModel.section_id,o.pagegroupid=o.sectionModel.pagegroupid,o.pageid=o.sectionModel.pageid,o.viewAllUrl=o.sectionModel.viewAllUrl,o.viewAllUrlText=o.sectionModel.viewAllUrlText,o.MEDIA_URL=MEDIA_URL,o.CUSTOM_STATIC_URL=CUSTOM_STATIC_URL,o.useStaticImages=""===MEDIA_URL,o.title=o.sectionModel.title,"Carousel"==o.sectionModel.type&&e(function(){$("#"+o.uid).owlCarousel({autoplay:!0,autoplayTimeout:9e3,autoplayHoverPause:!0,nav:!0,navText:[" "," "],items:4,slideBy:4,loop:!0,responsiveClass:!0,responsive:{0:{items:1,slideBy:1,loop:!0},480:{items:2,slideBy:2,loop:!0},600:{items:3,slideBy:3,loop:!0},1e3:{items:4,slideBy:4,loop:!0}}})}),o.style={},o.style.Title=b(o.sectionModel.layout.style.TitleStyle),o.style.CategoryStyle=b(o.sectionModel.layout.style.CategoryStyle),o.style.DiscountinfoStyle=o.sectionModel.layout.style.DiscountinfoStyle,o.style.viewall=o.sectionModel.layout.viewAllStyle,o.style.sectionViewAll=o.sectionModel.layout.style.SectionViewAllRenderingInfo,o.style.headerStyle=o.sectionModel.pageStyle}return{restrict:"E",scope:{sectionModel:"="},templateUrl:"app/templates/innertemplates/imageInfoViewAll.html",link:o}}function g(e,t){function o(o,n,i){if("0"==o.sectionModel.ignoresectionupload||void 0==o.sectionModel.ignoresectionupload)o.sectionData=o.sectionModel.section_data.excel_data;else if(o.sectionData=o.sectionModel.section_data,o.sectionData&&1==o.sectionData[0].show_random){
var r=Math.floor(Math.random()*o.sectionData.length),a=R.splitAt(r,o.sectionData);o.sectionData=R.concat(a[1],a[0])}o.viewAllUrl=o.sectionModel.viewAllUrl,o.viewAllUrlText=o.sectionModel.viewAllUrlText,o.sectionId=o.sectionModel.section_id,o.pagegroupid=o.sectionModel.pagegroupid,o.pushToGoogleAnalytics=t.pushToGoogleAnalytics,o.pageid=o.sectionModel.pageid,o.MEDIA_URL=MEDIA_URL,o.CUSTOM_STATIC_URL=CUSTOM_STATIC_URL,o.useStaticImages=""===MEDIA_URL,o.uid=_(),o.title=o.sectionModel.title,"Carousel"==o.sectionModel.type&&e(function(){$("#"+o.uid).owlCarousel({autoplay:!0,autoplayTimeout:5e3,autoplayHoverPause:!0,nav:!0,navText:[" "," "],items:4,slideBy:4,loop:!0,responsiveClass:!0,responsive:{0:{items:2,slideBy:2,loop:!0},600:{items:3,slideBy:3,loop:!0},1e3:{items:4,slideBy:4,loop:!0}}})}),o.style={},o.style.viewall=o.sectionModel.layout.viewAllStyle,o.style.Title=b(o.sectionModel.layout.style.Title),o.style.headerStyle=o.sectionModel.pageStyle}return{restrict:"E",scope:{sectionModel:"="},templateUrl:"app/templates/innertemplates/carouselWithTitle.html",link:o}}function m(e,t){function o(o,n,i){if("0"==o.sectionModel.ignoresectionupload||void 0==o.sectionModel.ignoresectionupload)o.sectionData=o.sectionModel.section_data.excel_data;else if(o.sectionData=o.sectionModel.section_data,o.sectionData&&1==o.sectionData[0].show_random){var r=Math.floor(Math.random()*o.sectionData.length),a=R.splitAt(r,o.sectionData);o.sectionData=R.concat(a[1],a[0])}o.sectionId=o.sectionModel.section_id,o.pagegroupid=o.sectionModel.pagegroupid,o.pageid=o.sectionModel.pageid,o.viewAllUrl=o.sectionModel.viewAllUrl,o.viewAllUrlText=o.sectionModel.viewAllUrlText,o.pushToGoogleAnalytics=t.pushToGoogleAnalytics,o.MEDIA_URL=MEDIA_URL,o.CUSTOM_STATIC_URL=CUSTOM_STATIC_URL,o.useStaticImages=""===MEDIA_URL,o.uid=_(),o.title=o.sectionModel.title,"Carousel"==o.sectionModel.type&&e(function(){$("#"+o.uid).owlCarousel({autoplay:!0,autoplayHoverPause:!0,nav:!0,navText:[" "," "],items:4,slideBy:4,lazyLoad:!0,loop:!0,responsiveClass:!0,responsive:{0:{items:2,slideBy:2,loop:!0},600:{items:3,slideBy:3,loop:!0},1e3:{items:4,slideBy:4,loop:!0}}})}),o.style={},o.style.viewall=o.sectionModel.layout.viewAllStyle,o.style.headerStyle=o.sectionModel.pageStyle}return{restrict:"E",scope:{sectionModel:"="},templateUrl:"app/templates/innertemplates/carouselOnlyImage.html",link:o}}function f(e,t,o,n){function i(t,i,r){t.sectionModel.section_data&&t.sectionModel.section_data.excel_data&&(t.sectionData=t.sectionModel.section_data.excel_data);t.cartitems=n.getformatedcart(),t.sectionId=t.sectionModel.section_id,t.pagegroupid=t.sectionModel.pagegroupid,t.pageid=t.sectionModel.pageid,t.viewAllUrl=t.sectionModel.viewAllUrl,t.viewAllUrlText=t.sectionModel.viewAllUrlText,t.pushToGoogleAnalytics=o.pushToGoogleAnalytics,t.MEDIA_URL=MEDIA_URL,t.base_img_url="",t.CUSTOM_STATIC_URL=CUSTOM_STATIC_URL,t.useStaticImages=""===MEDIA_URL,t.uid=_(),t.title=t.sectionModel.title,"undefined"!=typeof discount_data&&(t.bigSave=JSON.parse(discount_data)),t.sectionModel.productsystemtype?o.getProductsBySlug(t.sectionModel.productsystemtype,t.sectionModel.productwidgetuserslug,ctype,slug,tlc,t.sectionModel.alloffersubtype).then(function(o){var n=[];angular.forEach(o,function(e){n.push({product:e})}),t.sectionData=n,"Carousel"==t.sectionModel.type&&(t=y(t,e,{loop:!1,lazy:!1,items:8,slideBy:8}))}):o.getProductbyId(R.map(function(e){return e.PDID},t.sectionData)).then(function(o){var n=[];angular.forEach(o,function(e,i){var r=R.findIndex(R.propEq("PDID",String(e.sku)))(t.sectionData);r!=-1&&(t.sectionData[r].product=o[i],n.push(t.sectionData[r]))}),t.sectionData=n,"Carousel"==t.sectionModel.type&&(t=y(t,e,{loop:!1,lazy:!1,items:8,slideBy:8}))}),t.style={},t.style.viewall=t.sectionModel.layout.viewAllStyle,t.style.headerStyle=t.sectionModel.pageStyle}return{restrict:"E",scope:{sectionModel:"="},templateUrl:"app/templates/innertemplates/productwidgetmini.html",link:i}}function h(e,t,o){function n(n,i,r){n.sectionModel.section_data&&n.sectionModel.section_data.excel_data&&(n.sectionData=n.sectionModel.section_data.excel_data),n.cartitems=o.getformatedcart(),n.sectionId=n.sectionModel.section_id,n.pagegroupid=n.sectionModel.pagegroupid,n.pageid=n.sectionModel.pageid,n.viewAllUrl=n.sectionModel.viewAllUrl,n.viewAllUrlText=n.sectionModel.viewAllUrlText,n.pushToGoogleAnalytics=t.pushToGoogleAnalytics,n.MEDIA_URL=MEDIA_URL,n.base_img_url="",n.CUSTOM_STATIC_URL=CUSTOM_STATIC_URL,n.useStaticImages=""===MEDIA_URL,n.uid=_(),n.title=n.sectionModel.title,"undefined"!=typeof discount_data&&(n.bigSave=JSON.parse(discount_data)),n.sectionModel.productsystemtype?t.getProductsBySlug(n.sectionModel.productsystemtype,n.sectionModel.productwidgetuserslug,ctype,slug,tlc,n.sectionModel.alloffersubtype).then(function(t){var o=[];angular.forEach(t,function(e){o.push({product:e})}),n.sectionData=o,"Carousel"==n.sectionModel.type&&(n=y(n,e,{loop:!1,lazy:!1}))}):t.getProductbyId(R.map(function(e){return e.PDID},n.sectionData)).then(function(t){var o=[];angular.forEach(t,function(e,i){var r=R.findIndex(R.propEq("PDID",String(e.sku)))(n.sectionData);r!=-1&&(n.sectionData[r].product=t[i],o.push(n.sectionData[r]))}),n.sectionData=o,"Carousel"==n.sectionModel.type&&(n=y(n,e,{loop:!1,lazy:!1}))}),n.style={},n.style.viewall=n.sectionModel.layout.viewAllStyle,n.style.headerStyle=n.sectionModel.pageStyle}return{restrict:"E",scope:{sectionModel:"="},templateUrl:"app/templates/innertemplates/carouselproductwidgetlayout.html",link:n}}function _(){var e=(new Date).getTime();window.performance&&"function"==typeof window.performance.now&&(e+=performance.now());var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var o=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?o:3&o|8).toString(16)});return t}function v(e){function t(e){return"-"+e.toLowerCase()}return e.replace(/[A-Z]/g,t)}function b(e){var t={};return angular.forEach(e,function(e,o){t[v(o)]=e}),t}function y(e,t,o){return t(o.items&&o.slideBy?function(){$("#"+e.uid).owlCarousel({autoplay:!1,autoplayHoverPause:!1,nav:!0,navText:[" "," "],items:6,slideBy:6,lazyLoad:!1,loop:o.loop,responsiveClass:!0,responsive:{0:{items:2,slideBy:2,loop:o.loop},520:{items:2,margin:10,slideBy:2,loop:o.loop},768:{items:3,margin:10,slideBy:3,loop:o.loop},991:{items:4,slideBy:4,margin:10,mouseDrag:!1,loop:o.loop},1025:{items:6,slideBy:6,margin:10,mouseDrag:!1,loop:o.loop}}})}:function(){$("#"+e.uid).owlCarousel({autoplay:!1,autoplayHoverPause:!1,nav:!0,navText:[" "," "],items:5,slideBy:5,lazyLoad:!1,loop:o.loop,responsiveClass:!0,responsive:{0:{items:1,loop:o.loop},520:{items:2,margin:10,slideBy:2,loop:o.loop},768:{items:3,margin:10,slideBy:3,loop:o.loop},991:{items:4,slideBy:4,margin:10,mouseDrag:!1,loop:o.loop},1025:{items:5,slideBy:5,margin:10,mouseDrag:!1,loop:o.loop}}})}),e}t.$inject=["$compile"],angular.module("app.customPage").directive("carouselWithTitle",g).directive("carouselOnlyImage",m).directive("imageInfoViewAll",p).directive("banners",d).directive("bannerCaption",u).directive("nonLinear",l).directive("combo",c).directive("productDeck",s).directive("productTemplate",i).directive("information",t).directive("saving",o).directive("productWidgetMini",f).directive("productTemplateInContainer",r).directive("carouselProductWidget",h).directive("featuredProductTemplate",a).directive("fallbackSrc",e),o.$inject=["CustomPageDataService"],i.$inject=["$timeout"],s.$inject=["CustomPageDataService","$compile","$timeout"],c.$inject=["$timeout","CustomPageDataService"],l.$inject=["CustomPageDataService"],d.$inject=["$timeout","CustomPageDataService"],u.$inject=["$timeout","CustomPageDataService"],p.$inject=["$timeout","CustomPageDataService"],g.$inject=["$timeout","CustomPageDataService"],m.$inject=["$timeout","CustomPageDataService"],f.$inject=["$timeout","$rootScope","CustomPageDataService","UserDataservice"],h.$inject=["$timeout","CustomPageDataService","UserDataservice"]}(),function(){"use strict";function e(e,n,i){function r(t){function o(e){}e.post("/log/prodavialbility/",{toBeLoggedData:t}).then(o)}function a(t,o,n,i,r,a){function s(e){return e.data.products}var c="/custompage/pd/?type="+t+"&ctype="+n;return o&&(c=c+"&slug="+o),r&&(c=c+"&d_slug="+i+"&tlc="+r),i&&(c=c+"&d_slug="+i),a&&(c=c+"&offer_type="+a),e.get(c).then(s)}function s(t,o,i,r){function a(e,t,o,n){return"sis"==i?e.data:e.data}var s="/custompage/sysgenpd/?type="+t+"&slug="+o;if(sid)var s=s+"&sid="+sid;return r&&(s=s+"&offer_sub_type="+r),"ps"==t?n.when(!0).then(function(){return w}):e.get(s).then(a)}function c(t){function o(e){return e.data.products}return e({method:"GET",url:"/custompage/pd/",params:{"id[]":t}}).then(o)}function l(){function t(e,t,o,n){return e.data}var o=null;if("true"===ADMIN_REQUEST&&"true"===LIVE_PREVIEW){var n=window.location.search.match(/(city=)(.*)/);n&&3===n.length&&(o="/admin/custompage/draftpreview?url="+customPageURL+"&ar=true&city="+n[2]+"&isB2B="+ISB2B)}else if("true"===ADMIN_REQUEST){var n=window.location.search.match(/(city=)(.*)/);n&&3===n.length&&(o="/admin/custompage/display?url="+customPageURL+"&ar=true&city="+n[2]+"&isB2B="+ISB2B)}else o="custompage"==ctype?"/"+ctype+"/display?url="+customPageURL+"&cai="+i.CURRENT_ADDRESS_ID+"&isB2B="+ISB2B:"True"==ADMIN_REQUEST?"/"+ctype+"/display?url="+customPageURL+"&pageid="+PAGEID+"&slug="+slug+"&cityid="+CITYID+"&ar=1&isB2B="+ISB2B:"/"+ctype+"/display?url="+customPageURL+"&slug="+slug+"&cai="+i.CURRENT_ADDRESS_ID+"&isB2B="+ISB2B;return e.get(o).then(t)}function d(t,o){function n(e,t,o,n){if(e.data)return w=e.data.json_data,e.data}var i=null;return i="/custompage/getsearchdata/?slug="+t+"&type="+o,e.get(i).then(n)}function u(t,o,n){function i(e,t,o,n){return e.data}var r="/product/get-products/?="+t;return o&&(r=r+"&sorted_on="+o),n&&(r=r+"&offer_sub_type="+n),e.get(r).then(i)}function p(t,o,n,i,r,a,s,c,l,d,u,p){function g(e,t,o,n){return e.data}var m="";return m=r&&void 0==s?t?"/product/get-products/?slug="+c+"&filters="+JSON.stringify(r.filters)+"&sorted_on="+a+"&listtype="+t:"/product/get-products/?sid="+r.sid+"&filters="+JSON.stringify(r.filters)+"&sorted_on="+a:t?null!=r&&void 0!=r?"/product/get-products/?slug="+c+"&page="+i+'&tab_type=["'+n+'"]&filters='+JSON.stringify(r.filters)+"&sorted_on="+a+"&listtype="+t:"/product/get-products/?slug="+c+"&page="+i+'&tab_type=["'+n+'"]&sorted_on='+a+"&listtype="+t:null!=r&&void 0!=r?"/product/get-products/?sid="+o+"&page="+i+'&tab_type=["'+n+'"]&filters='+JSON.stringify(r.filters)+"&sorted_on="+a:"/product/get-products/?sid="+o+"&page="+i+'&tab_type=["'+n+'"]&sorted_on='+a,l&&(m=m+"&offer_sub_type="+l),"mem.sb"==t&&(d.length&&(m=m+"&sList="+d),u.length&&(m=m+"&lList="+u),p.length&&(m=m+"&rList="+p)),e.get(m).then(g)}function g(t,o,n,i,r,a,s,c){function l(e,o,n,i){return sid!=s&&(sid=s),$("html, body").animate({scrollTop:$(".custom-component.product-deck").offset().top-50},2e3),"sis"==t?($(".pd-overlay").fadeOut(),e.data):($(".pd-overlay").fadeOut(),e.data)}$(".pd-overlay").fadeIn();var d=null;if(d=t?"/product/get-products/?sid="+a+"&listtype="+t+"&filters="+JSON.stringify(o.filters)+"&sorted_on="+n+"&slug="+i+'&tab_type=["'+r+'"]':"/product/get-products/?sid="+o.sid+"&filters="+JSON.stringify(o.filters)+"&sorted_on="+n,c&&(d=d+"&offer_sub_type="+c),d)return e.get(d).then(l)}function m(){function e(){y=!0}return b?b:b=n.when(!0).then(e)}function f(e){var t=b||m();return t.then(function(){return n.all(e)})["catch"](function(e){})}function h(e,t,o,n,i){$(document).trigger("screenViewReferralsEvent",[{}]),"custompage"==ctype?o="cp | "+window.location.pathname:"customtemplates"==ctype&&(o="cptp | "+window.location.pathname),void 0!=window.dataLayer&&gtag("event",o,{event_category:t,event_label:n,value:i})}function _(e,t,o,n){dataLayer.push({event:"add_to_basket_onclick",product_id:t,price:n,quantity:o})}function v(e){return n.all(e).then(function(e){return!0})}var b,y=!1,w={},S={getCustomPage:l,getProductDeck:u,ready:f,updateProductDeck:g,getProductsForRestofTheTabs:p,pushToGoogleAnalytics:h,pushToGTM:_,getProductbyId:c,getRequestQueue:v,getProductsBySlug:a,getSysGenProductDeck:s,getSearchPageData:d,updateNewAtBBList:t,updateSuggestionList:o,logProductAvailablity:r};return S}function t(e,t){return e.forEach(function(e){if(e.section_data.excel_data=[],"now_at_bigbasket"==e.internalName&&1==t.show_now_at_bb){if(void 0!=t.now_at_bb.product_list)for(var o=0;o<t.now_at_bb.product_list.length;o++)e.section_data.excel_data.push({PDID:t.now_at_bb.product_list[o].toString()})}else if("new_at_bigbasket"==e.internalName&&1==t.show_new_at_bb&&void 0!=t.new_at_bb.product_list)for(var o=0;o<t.now_at_bb.product_list.length;o++)e.section_data.excel_data.push({PDID:t.new_at_bb.product_list[o].toString()})}),e}function o(e,t){var o=-1,n=!1;return e.forEach(function(e,i){void 0!=t[i]?(e.productsystemtype=t[i].slug_type,e.productwidgetuserslug=t[i].slug_value,e.viewAllUrl=t[i].view_all_url,e.title=t[i].title):0==n&&(o=i,n=!0)}),o>-1&&e.splice(o,5),e}angular.module("app.customPage").service("CustomPageDataService",e),e.$inject=["$http","$q","$window"]}(),function(){"use strict";function e(e,t,o){o(function(){var t=(new Date).getTime()/1e3;e.$emit("TimeCheck",{data:t})},5e3,0,!0)}angular.module("app.customPage").controller("TimeCalculator",e),e.$inject=["$scope","$rootScope","$interval"]}(),angular.module("app.layout").component("login",{templateUrl:"app/templates/innertemplates/login.html",bindings:{},controller:["$scope","$http","$window","loginAndSignupService","$timeout",function(e,t,o,n,i){function r(){return new Promise(function(e,t){window.FB.api("/me",{fields:"name,email,first_name,last_name"},function(t){t.provider="facebook",a.socialUser=t,e(t)})})}var a=this,s=e.$parent,c=angular.element(document.querySelector(".signup-modal"));a.showForgotPasswordForm=!1,a.isB2B=s.isB2B,a.showLoginForm=!0,a.showLoginWithOTPForm=!1,a.showSocialVerify=!1,a.isEditIdentifier=!1,a.identifier="",a.bbLoader=!1,a.showBusinessLogin=!!a.isB2B,a.togglePasswordDisplay=function(e){e.showHidePassword="view"==e.showHidePassword?"hide":"view",e.passwordDisplayType="password"==e.passwordDisplayType?"text":"password"},a.back=function(){a.showForgotPasswordForm=!1,a.showLoginForm=!0,a.showSocialVerify=!1,a.login.otpMembershipError="",s.businessLogin=!1,a.showLoginWithOTPForm=!1,a.showBusinessLogin=!!a.isB2B,s.showNavTabs=!a.isB2B,a.ToggleTimer(!1)},a.login={},a.login.emailID="",a.login.OTPemailID="",a.login.password="",a.login.passwordDisplayType="password",a.login.showHidePassword="view",a.loginErrorMessage="",a.login.showEmailError=!1,a.socialUser={},a.timer=0,a.time={},a.seconds=30,a.isUpdateEmail="",a.showResend=!1,a.change=!1,a.is_mobile_no_update=!1,window.mobileNumber&&(a.login.OTPemailID=window.mobileNumber),e.$on("mbUpdated",function(e){a.login.OTPemailID=s.preserved.mobileNumber?s.preserved.mobileNumber:""}),a.initFacebook=function(){try{var e={appId:"1397993430473589",cookie:!0,xfbml:!0,version:"v5.0"};window.FB.init(e),window.FB.getLoginStatus(function(e){},!0)}catch(t){console.log(t.name,":",t.message)}};var l=function(){var e="googleAuth",t="//apis.google.com/js/client:platform.js";return d(e,t)},d=function(e,t){return new Promise(function(o,n){var i=document.getElementById(e);if(!i){var r=document.createElement("script");r.setAttribute("type","text/javascript"),r.setAttribute("id",e),r.setAttribute("src",t),r.addEventListener("load",o),r.addEventListener("error",function(){return n(new Error("Error loading ".concat(e,".")))}),r.addEventListener("abort",function(){return n(new Error("".concat(e,"  loading aborted.")))}),document.getElementsByTagName("head")[0].appendChild(r)}})};a.initGoogle=function(){try{l();var e={client_id:"610100195438-jbg7jnikaqbn0rsiicbf72s45t55dvt1.apps.googleusercontent.com",scope:"profile email"};window.gapi.load("auth2",function(){window.gapi.auth2.getAuthInstance()||window.gapi.auth2.init(e)})}catch(t){console.log(t.name,":",t)}},a.initFacebook(),a.initGoogle(),a.toggleEditIdentifier=function(){a.ToggleTimer(!1),setTimeout(function(){$("#mobileEmail").focus()},100);var e="email address"==a.identifier?"Email_change":"Mobile_Change",t=JSON.stringify({EventName:e,EventSubGroup:"login",Action:"change"});$(document).trigger("loginInteractions",[t]),a.isEditIdentifier=!0,a.showResend=!1},a.changeIdentifier=function(){var e="email address"==a.identifier?"Email_change":"Mobile_Change",t=JSON.stringify({EventName:e,EventSubGroup:"login",Action:"submit"});$(document).trigger("loginInteractions",[t]),a.isEditIdentifier=!1,a.showResend=!0,a.resendOTP(),a.loginWithOTP.OTP="",a.resetServerMessages()},a.login.submit=function(e){if(e){a.login.emailError="";var t={username:a.login.emailID,password:a.login.password,Submit:"LOG IN",next:"/"};a.resetServerMessages(),n.submitForm(t,"/auth/login/",s).then(function(e){if(e.data.success){a.ToggleTimer(!1);var t="email address"==a.identifier?"email OTP":"mobile OTP",o=JSON.stringify({EventName:"Login_Success",EventSubGroup:"login",Action:t});if($(document).trigger("loginInteractions",[o]),localStorage.getItem("nextUrl"))return window.location.href=localStorage.getItem("nextUrl"),void localStorage.setItem("nextUrl","");s.redirect(),s.close()}else{a.login.emailError=e.data.error,a.loginForm.$setPristine(),a.loginForm.$setUntouched(),_();var t="email address"==a.identifier?"email":"mobile",o=JSON.stringify({EventName:"Login_Failed",EventSubGroup:"login",Action:t,FailureReason:e.data.error});$(document).trigger("loginInteractions",[o])}})}else _()};var u=function(e){};a.googleLogin=function(){var e=window.gapi.auth2.getAuthInstance();a.bbLoader=!0;var t=JSON.stringify({EventName:"Social_Clicked",EventSubGroup:"login",Action:"google"});$(document).trigger("loginInteractions",[t]),e.signIn().then(function(e){var t=e.getBasicProfile(),o={};o.identity={uid:t.getId(),provider:"google"},o.user={email:t.getEmail(),firstName:t.getGivenName(),lastName:t.getFamilyName()},o.auth=e.getAuthResponse(),g(o)},function(e){return window.location.href="/",a.bbLoader=!1,u(e)})};var p=function(){var e="facebookAuth",t="http://connect.facebook.net/en_US/sdk.js";return d(e,t)};a.initFacebook=function(){try{p();var e={appId:"1397993430473589",cookie:!0,xfbml:!0,version:"v5.0"};window.FB.init(e),window.FB.getLoginStatus(function(e){},!0)}catch(t){}},a.facebookLogin=function(){a.bbLoader=!0;var e=JSON.stringify({EventName:"Social_Clicked",EventSubGroup:"login",Action:"facebook"});$(document).trigger("loginInteractions",[e]),window.FB.getLoginStatus(function(e){var t={provider:"facebook"};return"connected"===e.status?(t.uid=e.authResponse.accessToken,void r().then(function(e){g(t)})):void FB.login(function(e){e.authResponse?(t.uid=e.authResponse.accessToken,r().then(function(e){g(t)})):window.location.href="/"},{scope:"email, public_profile",return_scopes:!0})})};var g=function(t){var o={},i="";a.is_mobile_no_update&&(o.is_mobile_no_update=a.is_mobile_no_update),t&&"facebook"===t.provider?(o.fb_token=t.uid,o.email=a.socialUser.email,i="facebook"):(a.socialUser=t,o.google_token=t.auth.id_token,o.email=t.user.email,i="google"),a.bbLoader=!0,n.postHulk("/mapi/v4.0.0/member-svc/login/",o,s).then(function(t){if(a.bbLoader=!1,t.success)if(t.error_code)if("HU4000"===t.error_code||"HU4004"===t.error_code)a.showSocialVerify=!0,a.showLoginForm=!1,a.showLoginWithOTPForm=!1,s.showNavTabs=!1,e.$apply(function(){e.$digest()});else if("HU4290"===t.error_code){var o=JSON.stringify({EventName:"Login_Failed",EventSubGroup:"login",Action:i,FailureReason:t.message,AdditionalInfo2:"OTP submit failed"});$(document).trigger("loginInteractions",[o])}else"HU4000"===t.error_code&&"HU4004"===t.error_code&&"HU4290"===t.error_code||!t.show_message||(a.loginWithOTP.otpError=t.message,e.$digest());else{var o=JSON.stringify({EventName:"Login_Success",EventSubGroup:"login",Action:i});$(document).trigger("loginInteractions",[o]),localStorage.getItem("nexUrl")?(window.location.href=window.location.origin+localStorage.getItem("nexUrl"),localStorage.setItem("nexUrl","")):s.redirect(),s.redirect(),s.close()}else if(t){var n=JSON.stringify({EventName:"Login_Failed",EventSubGroup:"login",Action:i,FailureReason:t.message});$(document).trigger("loginInteractions",[n])}})["catch"](function(e){a.bbLoader=!1,a.loginWithOTP.otpError="Something went wrong , Please try again"})};a.loginInteraction=function(e){data=e.currentTarget.getAttribute("data-logininteraction"),$(document).trigger("loginInteractions",[data])},a.forgotPasswordLinkCLicked=function(t,o){if(o){a.loginInteraction(t),a.login.emailError="";var r={email_id:a.login.emailID};a.resetServerMessages(),n.submitForm(r,"/auth/member_check/",s).then(function(t){if(t.data.success){m();var o=r;n.getRequest("/auth/reset-password",o,s).then(function(t){0===t.data.success&&(a.otpResendMessage="OTP sent successfully",document.querySelector("#otp").focus(),i(function(){a.otpResendMessage="",e.$digest()},3e3))})}else a.login.membershipError=t.data.error,a.loginForm.$setPristine(),a.loginForm.$setUntouched(),_()})}else a.login.showEmailError=!0,_()},a.forgotPassword={};var m=function(){a.showForgotPasswordForm=!0,a.showLoginForm=!1,a.showBusinessLogin=!1,s.showNavTabs=!1,a.forgotPassword.OTP="",a.forgotPassword.newPassword="",a.forgotPassword.confirmPassword="",a.forgotPassword.passwordDisplayType="password",a.forgotPassword.showHidePassword="view",a.forgotPassword.isPasswordValid=!1,a.forgotPassword.passwordMatch=!1,a.forgotPassword.otpError="",a.loginWithOTP.serverError="",i(function(){a.forgotPasswordForm.$setUntouched(),a.forgotPasswordForm.$setPristine(),document.querySelector("#otp").focus()},0)};a.forgotPassword.checkPassword=function(e){a.forgotPassword.isPasswordValid=e>0},a.resetServerMessages=function(){a.forgotPassword.successMessage="",a.login.emailError="",a.forgotPassword.otpError="",a.login.membershipError="",a.loginWithOTP.otpError="",a.loginWithOTP.serverError="",a.loginWithOTP.errorCode=""},a.forgotPassword.validatePassword=function(e){a.forgotPassword.newPassword==a.forgotPassword.confirmPassword?a.forgotPassword.passwordMatch=!0:a.forgotPassword.passwordMatch=!1},a.resendOTP=function(){a.ToggleTimer(!1),a.showResend=!1;var t={identifier:a.login.OTPemailID},o="email address"==a.identifier?"email":"mobile";"email"===o?a.change=!0:a.change=!1;var r=JSON.stringify({EventName:"Resend_OTP",EventSubGroup:"login",Action:o});$(document).trigger("loginInteractions",[r]),a.resetServerMessages(),a.bbLoader=!0,n.postHulk("/mapi/v4.0.0/member-svc/otp/send/",t,s).then(function(t){a.bbLoader=!1,a.otpResendMessage=t.message,document.querySelector("#otp").focus(),i(function(){a.otpResendMessage="",e.$digest()},3e3),a.ToggleTimer(!0)})["catch"](function(e){a.bbLoader=!1,a.showResend=!1,a.otpResendMessage="Somethings went wrong,Please try again",i(function(){a.otpResendMessage=""},6e3);var t="email address"==a.identifier?"email":"mobile",o=a.is_mobile_no_update?"phone":"login",n=JSON.stringify({EventName:"Resend_OTP_Failed",EventSubGroup:o,Action:t,FailureReason:e});$(document).trigger("loginInteractions",[n])})},a.forgotPassword.submit=function(e,t){if(t&&a.forgotPassword.passwordMatch&&a.forgotPassword.isPasswordValid){var o={otp:a.forgotPassword.OTP,newpwd:a.forgotPassword.newPassword,secpwd:a.forgotPassword.confirmPassword,emailid:a.login.emailID};a.loginInteraction(e),a.resetServerMessages(),n.submitForm(o,"/auth/reset-password/",s).then(function(e){0!==e.data.success?(a.forgotPassword.otpError=e.data.message,a.forgotPasswordForm.$setUntouched(),a.forgotPasswordForm.$setPristine(),_()):(s.redirect(),s.close())})}else _()},a.socialLogin=function(e){"fb"==e&&n.fb_login("login"),"gplus"==e&&n.gplus_login("login")},a.loginRedirect=function(e){window.mobileNumber=a.login.OTPemailID,a.showLoginForm=!0,"signup"===e?a.isB2B?(s.dismiss(!0),window.location.href="/signup"):(a.showLoginWithOTPForm=!1,s.switchLoginTab("signup",a.login.OTPemailID),s.showNavTabs=!0):a.isB2B?a.back():(a.showLoginWithOTPForm=!1,s.switchLoginTab("login",a.login.OTPemailID),s.showNavTabs=!0,a.ToggleTimer(!1))};var f={};a.ToggleTimer=function(t){function o(){n<0&&(clearInterval(f),a.showResend=!0,e.$digest())}var n=30;t&&"null"!=document.getElementById("timeLeftInSeconds")?f=setInterval(function(){n<10&&(n="0"+n),document.getElementById("timeLeftInSeconds").innerHTML="00:"+n,n-=1,o()},1e3):(clearInterval(f),a.showResend=!1)},a.verifyOtp=function(e,t,o){e.preventDefault(),a.is_mobile_no_update&&(o=a.mobile),t&&(a.is_mobile_no_update=!0,o=a.mobile,h(o))},a.loginWithOTPLinkClicked=function(e,t,o){a.isUpdateEmail=a.login.OTPemailID,t?(a.loginInteraction(e),a.login.emailError="",a.resetServerMessages(),h(o)):(a.login.showEmailError=!0,_())},a.loginWithOTP={};var h=function(t){a.ToggleTimer(!1),a.login.OTPemailID=t;var o="",r="";RegExp(/(^(?!.{76,}))(^(([^<>()δ[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@(?=[^-])((([\w-]+\.)+[a-zA-Z-]+)[a-zA-Z])$)/).test(t)?(a.identifier="email address",o="Email_OTP_Verification_Shown",r="Email_OTP_Verification"):(a.identifier="mobile number",o="Mobile_OTP_Verification_Shown",r="Mobile_OTP_verification"),$(document).trigger("authScreenViews",[{EventName:o,ScreenType:r,ScreenURL:window.location.origin+"/login//"+r,ScreenSlug:"/Mobile_OTP_verification/",ReferrerURL:window.location.origin+"/login/",ReferrerSlug:"/login/",ReferrerType:"login"}]),a.loginWithOTP.sendOTP=function(){a.showResend=!1,a.resetServerMessages();var o={identifier:t},r="email address"==a.identifier?"email":"mobile";"email"===r?a.change=!0:a.change=!1,a.bbLoader=!0,n.postHulk("/mapi/v4.0.0/member-svc/otp/send/",o,s).then(function(t){if(a.bbLoader=!1,t.success)t.error_code?a.loginWithOTP.otpError=t.message:(a.loginWithOTP.OTP="",a.loginWithOTPForm.$setUntouched(),a.loginWithOTPForm.$setPristine(),a.otpResendMessage="OTP sent successfully",document.querySelector("#otp").focus(),i(function(){a.otpResendMessage="",e.$digest()},3e3),a.ToggleTimer(!0));else{var o=JSON.stringify({EventName:"Resend_OTP_Failed",EventSubGroup:"login",Action:r,FailureReason:"Something went wrong"});$(document).trigger("loginInteractions",[o])}})["catch"](function(e){a.bbLoader=!1,a.showResend=!1,a.otpResendMessage="Something went wrong,Please try again",i(function(){a.otpResendMessage=""},6e3)})},a.isEditIdentifier=!1,a.showSocialVerify=!1,a.showLoginWithOTPForm=!0,a.showBusinessLogin=!1,a.showLoginForm=!1,a.loginWithOTP.OTP="",a.loginWithOTP.otpError="",a.loginWithOTP.serverError="",s.showNavTabs=!1,i(function(){a.loginWithOTPForm.$setUntouched(),a.loginWithOTPForm.$setPristine(),a.loginWithOTP.sendOTP()},0)};a.initBusinessLogin=function(){a.login.membershipError="",s.businessLogin=!0,a.showBusinessLogin=!0,s.showNavTabs=!1},a.donotAllowSpecialChars=function(e){e.key.search(/^[a-zA-Z0-9\s]+$/)==-1&&e.preventDefault()},a.loginWithOTP.submit=function(t,o){if(t.preventDefault(),o){var i="",r={},c="";a.is_mobile_no_update?(r.is_mobile_no_update=a.is_mobile_no_update,Object.keys(a.socialUser).length>0?r.email=a.socialUser&&"facebook"===a.socialUser.provider?a.socialUser.email:a.socialUser.user&&a.socialUser.user.email:r.email=a.isUpdateEmail||a.login.emailID,i=a.login.OTPemailID||a.mobile):i=a.login.OTPemailID?a.login.OTPemailID:a.login.emailID,RegExp(/(^(?!.{76,}))(^(([^<>()δ[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@(?=[^-])((([\w-]+\.)+[a-zA-Z-]+)[a-zA-Z])$)/).test(i)?(r.email=a.login.OTPemailID?a.login.OTPemailID:a.login.emailID,r.email_otp=a.loginWithOTP.OTP,c="email OTP"):(r.mobile_no=i,r.mobile_no_otp=a.loginWithOTP.OTP,c="mobile OTP"),a.resetServerMessages(),a.loginWithOTP.otpError="",a.loginWithOTP.serverError="",a.bbLoader=!0,n.postHulk("/mapi/v4.0.0/member-svc/login/",r,s).then(function(t){if(a.bbLoader=!1,t.success)if(t.error_code)if("HU4000"===t.error_code||"HU4004"===t.error_code)a.showSocialVerify=!0,a.showLoginForm=!1,a.showLoginWithOTPForm=!1,$(document).trigger("authScreenViews",[{EventName:"Mobile_Number_verification_Shown",ScreenType:"Mobile_Number_verification",ScreenURL:window.location.origin+"/login/Mobile_Number_verification/",ScreenSlug:"/Mobile_Number_verification/",ReferrerURL:window.location.origin+"/login/",ReferrerSlug:"/Email_OTP_Verification/",ReferrerType:"Email_OTP_Verification"}]),e.$digest();else if("HU4290"===t.error_code){var o=JSON.stringify({EventName:"Login_Failed",EventSubGroup:"login",Action:c,FailureReason:t.message,AdditionalInfo2:"OTP submit failed"});$(document).trigger("loginInteractions",[o]),a.loginWithOTP.serverError=t.message,a.loginWithOTP.errorCode=t.error_code,a.loginWithOTPForm.$setUntouched(),a.loginWithOTPForm.$setPristine(),e.$digest()}else if("HU4000"===t.error_code&&"HU4004"===t.error_code&&"HU4290"===t.error_code||!t.show_message){var o=JSON.stringify({EventName:"Login_Failed",EventSubGroup:"login",Action:c,FailureReason:t.message});$(document).trigger("loginInteractions",[o])}else{if(a.loginWithOTP.serverError=t.message,a.loginWithOTP.errorCode=t.error_code,a.loginWithOTPForm.$setUntouched(),a.loginWithOTPForm.$setPristine(),"HU4002"===t.error_code){e.$digest();var o=JSON.stringify({EventName:"Login_Failed",EventSubGroup:"login",Action:"mobile",FailureReason:"The mobile number is not registered with us"});$(document).trigger("loginInteractions",[o])}e.$digest()}else{var o=JSON.stringify({EventName:"Login_Success",EventSubGroup:"login",Action:c});if($(document).trigger("loginInteractions",[o]),localStorage.getItem("nexUrl"))return window.location.href=window.location.origin+localStorage.getItem("nexUrl"),void localStorage.setItem("nexUrl","");s.redirect(),s.close()}else{a.loginWithOTP.otpError=t.data.message,a.loginWithOTP.serverError="",a.loginWithOTPForm.$setUntouched(),a.loginWithOTPForm.$setPristine();var o=JSON.stringify({EventName:"Login_Failed",EventSubGroup:"login",Action:c,FailureReason:"Something went wrong"});$(document).trigger("loginInteractions",[o]),_()}})["catch"](function(e){a.bbLoader=!1,a.loginWithOTP.serverError="Something went wrong , Please try again"})}else _()};var _=function(){c.addClass("shake"),i(function(){c.removeClass("shake")},500)}}]}),angular.module("app.layout").controller("loginAndSignupBase",["$scope","$uibModalInstance","modalData","loginAndSignupService",function(e,t,o,n){var i=this;e.bbLoader=!1,e.goBack=!1,e.loadSignupCaptcha=!0,e.captcha_url="",e.captcha_0="",e.isB2B="True"==window.ISB2B,e.businessLogin=!!e.isB2B,e.showNavTabs=!e.isB2B,e.preserved={},e.showPhoneNumberModal=!1,e.memberPhoneOtpData={};var r="undefined"!=typeof MEDIA_URL?MEDIA_URL:"",a={};localStorage.getItem("newLogin")&&(o.next=localStorage.getItem("next"),localStorage.removeItem("newLogin"),localStorage.removeItem("next")),i.getSearchQueryParam=function(e,t){var o=t||window.location.href;e=e.replace(/[[\]]/g,"\\$&");var n=new RegExp("[?&]${name}(=([^&#]*)|&|#|$)"),i=n.exec(o);return i&&i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):""},(window.location.pathname.indexOf("/auth/login/")>-1||window.location.pathname.indexOf("/auth/signup/")>-1)&&(o.next=""!==i.getSearchQueryParam("next")?i.getSearchQueryParam("next"):"/",o.tab=window.location.pathname.indexOf("/auth/login/")>-1?"login":"signup"),e.dismiss=function(){"almostThere"===window.loginScreen?(delete window.loginScreen,window.location.href="/"):($(document).trigger("ScreenViewLoginClose"),t.dismiss(),window.location.search.indexOf("next")>-1&&(window.location.pathname=window.location.search.split("next=")[1]))},e.close=function(){t.dismiss()},i.tabs={login:!0,signup:!1},i.switchTab=function(e){Object.keys(i.tabs).forEach(function(e){i.tabs[e]=!1}),i.tabs[e]=!0,i.bannerUrl=a[e]?a[e].url:"",i.bannerId=a[e]?a[e].id:"",screenSlug=i.tabs.login?"/auth/login":"/auth/signup",$(document).trigger("trackLSBanners",[i.bannerId,screenSlug,o.pageContext])},e.switchLoginTab=function(t,n){Object.keys(i.tabs).forEach(function(e){i.tabs[e]=!1}),i.tabs[t]=!0,i.bannerUrl=a[t]?a[t].url:"",i.bannerId=a[t]?a[t].id:"",screenSlug=i.tabs.login?"/auth/login":"/auth/signup",$(document).trigger("trackLSBanners",[i.bannerId,screenSlug,o.pageContext]),
e.preserved.mobileNumber=n,e.$broadcast("mbUpdated")},e.redirect=function(){if($(document).trigger("LoginRedirection"),window.location.href!=o.next){var e=new RegExp("^(http[s]?:\\/\\/(www\\.)?|ftp:\\/\\/(www\\.)?|www\\.){1}([0-9A-Za-z-\\.@:%_+~#=]+)+((\\.[a-zA-Z]{2,3})+)(/(.)*)?(\\?(.)*)?|(https?://)?(www.)?[a-z0-9-]+.(com|org|in|co|inc)(.[a-z]{2,3})?");null==o.next||e.test(o.next)?window.location.href="/":window.location.href=o.next}else window.location.reload()},i.loginClicked=function(e){data=e.currentTarget.getAttribute("data-logininteraction"),$(document).trigger("loginInteractions",[data])},i.loginPageShown=function(e,t){var n="";void 0===t?(n=i.tabs.login?"/auth/login":"/auth/signup",$(document).trigger("LoginScreenView",[n,o.pageContext])):("signup"==t&&i.tabs.login||"login"==t&&i.tabs.signup)&&(n=i.tabs.login?"/auth/signup":"/auth/login",$(document).trigger("LoginScreenView",[n,o.pageContext]))};var s=function(){i.banners={},o.tab?i.switchTab(o.tab):i.switchTab("login"),n.getRequest("/auth/lsbanners/",{}).then(function(e){e.data.login_banner&&(i.loginBannerImgUrl=r+e.data.login_banner.img,a.login=e.data.login_banner),e.data.signup_banner&&(i.signupBannerImgUrl=r+e.data.signup_banner.img,a.signup=e.data.signup_banner),i.bannerUrl=a[o.tab]?a[o.tab].url:"",i.bannerId=a[o.tab]?a[o.tab].id:"",screenSlug=i.tabs.login?"/auth/login":"/auth/signup",$(document).trigger("trackLSBanners",[i.bannerId,screenSlug,o.pageContext])})};s()}]),angular.module("app.layout").component("passwordStrength",{templateUrl:"app/templates/innertemplates/password-strength.html",bindings:{password:"<",username:"<",onChange:"&"},controller:["$scope",function(e){var t=this;t.message="",t.messageClass="",t.barClass="",t.barHeight="1px";var o="";t.$onChanges=function(e){if(void 0!=e.password){var n=d(e.password.currentValue||"",t.username);t.message=d.messages[n.messageKey],t.messageClass="password-meter-message-"+n.messageKey,t.barClass="password-meter-"+n.messageKey,t.barHeight=0==n.rate?"1px":"2px",n.rate!==o&&(t.onChange({valid:n.rate}),o=n.rate)}};var n=/[a-z]/,i=/[A-Z]/,r=/[0-9]/,a=/[0-9].*[0-9]/,s=/[^a-zA-Z0-9]/,c=/^(.)\1+$/,l=function(e,t){return{rate:e,messageKey:t}},d=function(e,t){if(e.length<8)return l(0,"too-short");if(e.length>29)return l(0,"too-long");if(e.match(/\s{1,}/))return l(0,"spaces");if(t&&e.toLowerCase().match(t.toLowerCase()))return l(0,"similar-to-username");if(c.test(e))return l(2,"weak");if(e.match(/^[a-zA-Z]*$/)||e.match(/^(\d)\1*$/))return l(2,"weak");var o=n.test(e),d=i.test(e),u=r.test(e),p=(a.test(e),s.test(e));return e.length>12&&o&&d&&u&&p?l(4,"strong"):l(3,"good")};d.messages={"similar-to-username":"Too similar to username","too-short":"Min 8 Characters","very-weak":"Very weak",weak:"Weak",good:"Medium",strong:"Strong","too-long":"Password must be less than 30 characters",spaces:"Spaces are not allowed. Please try again"}}],controllerAs:"passwordCtrl"}),angular.module("app.layout").component("pnv",{templateUrl:"app/templates/innertemplates/memberPhoneVerification.html",bindings:{},controller:["$scope","loginAndSignupService",function(e,t){var o=this,n=e.$parent;o.manualEntry={},e.phoneNumberFlow=!0,e.otpCounter="00",e.errorMessage="",e.disablePhoneContinueButton=!0,e.disableOtpContinueButton=!0,e.disableOtpResendButton=!0,e.disableOtpSubmitButton=!0,e.checkPhoneNumberLength=function(){o.manualEntry&&10==o.manualEntry.phone.length?e.disablePhoneContinueButton=!1:e.disablePhoneContinueButton=!0},e.validateMemberPhone=function(){e.disablePhoneContinueButton=!0,e.failedMessage="";var i={first_name:n.memberPhoneOtpData.first_name,last_name:n.memberPhoneOtpData.last_name,date_of_birth:n.memberPhoneOtpData.date_of_birth,email:n.memberPhoneOtpData.email,mobile_number:o.manualEntry.phone,telephone_number:n.memberPhoneOtpData.telephone_number,city_id:$.cookie("_bb_cid"),newsletter_subscription:n.memberPhoneOtpData.newsletter_subscription};t.submitForm({user_details:JSON.stringify(i)},"/mapi/v3.5.1/member/?_bb_client_type=web",n).then(function(t){t&&(181==t.data.status||t.data.success?(e.phoneNumberFlow=!1,e.startOtpCounter()):e.failedMessage=t.data.message)})},e.otpWaitTime,e.startOtpCounter=function(){e.disableOtpResendButton=!0;var t=30;e.otpWaitTime=setInterval(function(){var o=t-1;e.$apply(function(){e.otpCounter=o}),t-=1,t<=0&&e.$apply(function(){e.disableOtpResendButton=!1,clearInterval(e.otpWaitTime)})},1e3)},e.phoneNumberFlow||e.startOtpCounter(),e.resendOtpNumber=function(){e.disableOtpResendButton=!0,e.validateMemberPhone(),e.errorMessage="Resent OTP"},e.goBackToPhoneNumberFlow=function(){e.errorMessage="",o.manualEntry={},e.disableOtpResendButton=!0,e.phoneNumberFlow=!0,clearInterval(e.otpWaitTime)},e.checkOtpNumberLength=function(){o.manualEntry&&6==o.manualEntry.otp.length?e.disableOtpContinueButton=!1:e.disableOtpContinueButton=!0},e.validateMemberOtp=function(){e.errorMessage="",e.disableOtpContinueButton=!0;var i={first_name:n.memberPhoneOtpData.first_name,last_name:n.memberPhoneOtpData.last_name,date_of_birth:n.memberPhoneOtpData.date_of_birth,email:n.memberPhoneOtpData.email,mobile_number:o.manualEntry.phone,telephone_number:n.memberPhoneOtpData.telephone_number,city_id:$.cookie("_bb_cid"),newsletter_subscription:n.memberPhoneOtpData.newsletter_subscription,otp:o.manualEntry.otp};t.submitForm({user_details:JSON.stringify(i)},"/mapi/v3.5.1/member/?_bb_client_type=web",n).then(function(t){t&&t.data.message&&(0==t.data.status?n.redirect():e.errorMessage="Invalid OTP")})}}]}),angular.module("app.layout").component("signup",{templateUrl:"app/templates/innertemplates/signup.html",controller:["$scope","$window","loginAndSignupService","$timeout",signupController],controllerAs:"signup"}),angular.module("app.layout").component("myOrder",{templateUrl:"app/templates/innertemplates/myOrder.html",bindings:{order:"<",index:"<",showDropdown:"<",toggleDropDown:"&"},controllerAs:"vm",controller:["$scope","$timeout",function(e,t){var o=this;o.voucher=!1;var n="",i={pay_now:"/payment/pay_now/",add_on_order:"",change_slot:"/member/self-service/change-delivery-slot/",cancel_order:"/member/self-service/cancel-order/",apply_voucher:"/co/forgot-voucher/"},r={pay_now:"PayNow_Clicked",add_on_order:"AddonOrder_Clicked",change_slot:"ChangeSlot_Clicked",cancel_order:"CancelOrder_Clicked",apply_voucher:"ApplyVoucher_Clicked"};o.$onInit=function(){o.active=0==o.order.order_state,o.isExpress=o.order.is_express,n=o.order.p_order_id,o.cancelledOrder=2==o.order.order_state,i.apply_voucher+=o.order.p_order_id+"/",o.showSavings=Number(o.order.order_details.total_savings)>0},o.closeAddonModal=function(){o.showAddOnModal=!o.showAddOnModal,$(document).trigger("AddonOrderClosed",[{}])},o.getSlotClass=function(){return o.cancelledOrder?"strike":""},o.getWidgetClass=function(){return o.active?"":"bg-dbdbdb"},o.actionClick=function(e,t){"add_on_order"==e.type?(o.showAddOnModal=!0,o.slotDate=new window.Date(o.order.slot_info.date)):window.location.href=i[e.type]+"?nc=oadtls_page",t&&($(document).trigger("selfServiceInteractionPlower",[{EventName:r[e.type],UserFlow:"oadtls_page",OrderId:t.order_id,OrderNumber:t.order_number,AdditionalInfo2:t.order_status},!0]),"add_on_order"==e.type&&$(document).trigger("AddonOrderScreenView",[{EventName:"FlatPages_Shown",ScreenType:"flat",ScreenURL:window.location.origin+"/order/slot_close_time_page/?nc=oadtls_page",ScreenSlug:"/order/slot_close_time_page/",PageTemplate:"default",AdditionalInfo2:t.order_status}]))}}]}),dataLayer=null,angular.module("app.layout").component("myOrderList",{templateUrl:"app/templates/innertemplates/myOrderList.html",bindings:{},controllerAs:"vm",controller:["$scope","$http","$timeout","$q",function(e,t,o,n){var i=this;i.page=1,i.totalPages=1,i.showViewMore=!1,i.activeOrders=[],i.pastOrders=[],i.currentExpandedOrder=void 0,i.activeOrderResponse=!1,i.pastOrderResponse=!1,i.$onInit=function(){t.get("/mapi/v3.5.0/order/order-assistant/?&page=1&type=active&&_bb_client_type=web").then(function(e){var t=e.data.response,o=t.total_active_orders;i.orderList=t.orders,i.activeOrders=i.orderList,i.activeOrderResponse=!0,i.triggerScreenView(),o>0&&(i.activeOrders[0].showDropdown=!0)}),t.get("/mapi/v3.5.0/order/order-assistant/?&page=1&type=past&&_bb_client_type=web").then(function(e){i.page++;var t=e.data.response;i.pastOrders=t.orders,i.totalPages=Number(t.total_pages),i.pastOrderResponse=!0,i.triggerScreenView(),i.totalPages>1&&(i.showViewMore=!0)})},i.triggerScreenView=function(){if(i.activeOrderResponse&&i.pastOrderResponse){var e="",t="";i.activeOrders&&i.activeOrders.length>0?(e=i.activeOrders[0].order_id,t=i.activeOrders[0].order_status,i.currentExpandedOrder=i.activeOrders[0]):i.pastOrders&&i.pastOrders.length>0&&(e=i.pastOrders[0].order_id,t=i.pastOrders[0].order_status,i.currentExpandedOrder=i.pastOrders[0]),screenViewValue=JSON.parse($($("[data-scrv]")[$("[data-scrv]").length-1]).val()),screenViewValue.ScreenTypeID=e,screenViewValue.AdditionalInfo2=t,screenViewValue.skipScreenView="false",$($("[data-scrv]")[$("[data-scrv]").length-1]).val(JSON.stringify(screenViewValue)),$(document).trigger("OADetailsShown",[{}]),i.activeOrders&&i.activeOrders.length>0&&$(document).trigger("selfServiceInteractionPlower",[{EventName:"OrderExpanded",UserFlow:"oadtls_page",OrderId:i.currentExpandedOrder.order_id,OrderNumber:i.currentExpandedOrder.order_number,AdditionalInfo2:i.currentExpandedOrder.order_status}])}},i.toggleDropDown=function(e){var t=e.showDropdown;i.activeOrders&&i.activeOrders.forEach(function(e){e.showDropdown=!1}),i.pastOrders&&i.pastOrders.forEach(function(e){e.showDropdown=!1}),e.showDropdown=!t,e.showDropdown&&(i.currentExpandedOrder=e,screenViewValue=JSON.parse($($("[data-scrv]")[$("[data-scrv]").length-1]).val()),screenViewValue.ScreenTypeID=e.order_id,$($("[data-scrv]")[$("[data-scrv]").length-1]).val(JSON.stringify(screenViewValue)),$(document).trigger("selfServiceInteractionPlower",[{EventName:"OrderExpanded",UserFlow:"oadtls_page",OrderId:i.currentExpandedOrder.order_id,OrderNumber:i.currentExpandedOrder.order_number,AdditionalInfo2:i.currentExpandedOrder.order_status}]))},i.viewmore=function(){t.get("/mapi/v3.5.0/order/order-assistant/?&page="+i.page+"&type=past&&_bb_client_type=web").then(function(e){i.page++;var t=e.data.response,o=t.orders;i.pastOrders=i.pastOrders.concat(o),i.totalPages<i.page&&(i.showViewMore=!1)})},i.helpClicked=function(){i.currentExpandedOrder?$(document).trigger("selfServiceInteractionPlower",[{EventName:"Help_Clicked",UserFlow:"oadtls_page",OrderId:i.currentExpandedOrder.order_id,OrderNumber:i.currentExpandedOrder.order_number,AdditionalInfo2:i.currentExpandedOrder.order_status},!0]):$(document).trigger("selfServiceInteractionPlower",[{EventName:"Help_Clicked",UserFlow:"oadtls_page",OrderId:-1,OrderNumber:"-1"},!0])}}]}),angular.module("app.layout").component("orderAssistant",{templateUrl:"app/templates/header/orderAssistant.html",bindings:{closeOrderAssistant:"&"},controllerAs:"vm",controller:["$scope","$http","$timeout","$window",function(e,t,o,n){var i=this;i.order={},i.hide=!0,i.cancelledOrder=!1,i.$onInit=function(){t.get("/mapi/v3.5.0/order/order-assistant/?_bb_client_type=web").then(function(e){var t=e.data.response;if(t&&t.orders){var r=t.orders.length,a=t.orders;r>0&&(i.hide=!1,i.order=a[t.display_index],i.noOfactiveOrders=t.total_active_orders,$(document).trigger("selfServiceInteractionPlower",[{EventName:"OaWidget_launched",UserFlow:"system",OrderId:i.order.order_id,OrderNumber:i.order.order_number,AdditionalInfo2:i.order.order_status}])),i.isExpress=i.order.is_express,i.cancelledOrder=2==i.order.order_state,o(function(){n.scrollBy(0,1)},200)}})},i.getSlotClass=function(){return i.cancelledOrder?"strike":"bold-dark"},i.oaWidgetClicked=function(){$(document).trigger("screenViewReferralsEvent",[{}]),$(document).trigger("selfServiceInteractionPlower",[{EventName:"OaWidget_Clicked",UserFlow:"User_action",OrderId:i.order.order_id,OrderNumber:i.order.order_number,AdditionalInfo2:i.order.order_status}])},i.oaWidgetClosed=function(){$(document).trigger("selfServiceInteractionPlower",[{EventName:"OaWidget_Closed",UserFlow:"User_action",OrderId:i.order.order_id,OrderNumber:i.order.order_number,AdditionalInfo2:i.order.order_status}])}}]}),angular.module("app.layout").component("orderStatusWidget",{templateUrl:"app/templates/header/orderStatusWidget.html",bindings:{arrowIndex:"<",states:"<",showArrow:"<"},controllerAs:"vm",controller:["$scope","$timeout",function(e,t){var o=this;o.statusMeter=0,o.$onChanges=function(){o.states.forEach(function(e,t){e.is_active&&(o.statusMeter=t)}),console.log(o.statusMeter)}}]}),function(){"use strict";function e(){this.config={appErrorPrefix:void 0},this.configure=function(e){this.config.appErrorPrefix=e},this.$get=function(){return{config:this.config}}}function t(e){e.decorator("$exceptionHandler",o)}function o(e,t,o){return function(n,i){var r=t.config.appErrorPrefix||"",a={exception:n,cause:i};n.message=r+n.message,e(n,i),o.error(n.message,a)}}t.$inject=["$provide"],o.$inject=["$delegate","exceptionHandler","logger"],angular.module("blocks.exception").provider("exceptionHandler",e).config(t)}(),function(){"use strict";function e(e){function t(t){return function(o){e.error(t,o)}}var o={catcher:t};return o}e.$inject=["logger"],angular.module("blocks.exception").factory("exception",e)}(),function(){"use strict";function e(e,t){function o(o,n,i){t.error(o,i),e.error("Error: "+o,n)}function n(o,n,i){t.info(o,i),e.info("Info: "+o,n)}function i(o,n,i){t.success(o,i),e.info("Success: "+o,n)}function r(o,n,i){t.warning(o,i),e.warn("Warning: "+o,n)}var a={showToasts:!0,error:o,info:n,success:i,warning:r,log:e.log};return a}angular.module("blocks.logger").factory("logger",e),e.$inject=["$log","toastr"]}(),function(){"use strict";function e(){this.config={},this.$get=function(){return{config:this.config}}}function t(e,t,o,n,i){function r(e){e.forEach(function(e){e.config.resolve=angular.extend(e.config.resolve||{},i.config.resolveAlways),g.when(e.url,e.config)}),g.otherwise({redirectTo:"/"})}function a(){t.$on("$routeChangeError",function(t,o,i,r){if(!d){u.errors++,d=!0;var a=o&&(o.title||o.name||o.loadedTemplateUrl)||"unknown target",s="Error routing to "+a+". "+(r.msg||"");n.warning(s,[o]),e.path("/")}})}function s(){a(),l()}function c(){for(var e in o.routes)if(o.routes.hasOwnProperty(e)){var t=o.routes[e],n=!!t.title;n&&p.push(t)}return p}function l(){t.$on("$routeChangeSuccess",function(e,o,n){u.changes++,d=!1;var r=i.config.docTitle+" "+(o.title||"");t.title=r})}var d=!1,u={errors:0,changes:0},p=[],g=i.config.$routeProvider,m={configureRoutes:r,getRoutes:c,routeCounts:u};return s(),m}angular.module("blocks.router").provider("routehelperConfig",e).factory("routehelper",t),t.$inject=["$location","$rootScope","$route","logger","routehelperConfig"]}(),function(){"use strict";function e(e,t){function o(){var t=[r()];e.ready(t).then(function(){})}function n(){u.categories=p(u.engagementStore.products),u.filters.category=""}function i(e){$("#engagementStoreFlatPage").hide(),$("#engagementStoreFlatPage").append(e),$("#engagementStoreFlatPage").show()}function r(){var t=function(t){u.engagement_stores=t.data,e.getEngagementStore(m).then(f)};e.getAllStores().then(t)}function a(e){u.grandTotal=0,u.totalSaved=0,angular.forEach(R.filter(g,e),function(e,t){u.grandTotal=u.grandTotal+e.product.selectedQuantity*e.product.sell_price,u.totalSaved=u.totalSaved+e.product.selectedQuantity*e.product.mrp})}function s(){angular.forEach(R.filter(g,u.engagementStore.products),function(e,t){e.product.selectedQuantity>0&&add_to_basket(e.pid,e.product.selectedQuantity,1,null,ADD_TO_CART_SOURCES.ENGAGEMENT_STORE,null)})}function c(){angular.forEach(R.filter(g,u.engagementStore.products),function(e,t){e.product.selectedQuantity<0&&(e.product.selectedQuantity=0),e.product.selectedQuantity>25&&(e.product.selectedQuantity=25)})}function l(e,o){angular.forEach(u.engagementStore.products,function(n,i){n.pid===Number(e)&&(n.cart.quantity=o,t.$digest())})}function d(){angular.forEach(u.engagementStore.products,function(e,o){void 0!==$("#p_"+e.pid)&&(0===$("#p_"+e.pid).length?e.cart.quantity=0:e.cart.quantity=$("#p_"+e.pid).val(),t.$digest())})}var u=this,p=R.groupBy(function(e){return e.category}),g=function(e){return e.product.select===!0};u.engagementStore={},u.categories={},u.filters={},u.numSelectedProducts=0,u.grandTotal=0,u.totalSaved=0,u.isItemAlreadyInCart=!1,u.addProductstoCart=s,u.selectStore=engagementStoreName,u.updateEngagementStore=l,u.updateEngagementStoreFromCart=d;var m=engagementStoreName,f=function(e){return u.filters={},u.engagementStore=e.data,n(),i(u.engagementStore.flatPage),t.$watch("vm.engagementStore.products",function(e,t){u.numSelectedProducts=R.filter(g,e).length,a(e),c()},!0),t.$watch("vm.engagementStore.store.numberOfGuests",function(e,t){e<2&&(u.engagementStore.store.numberOfGuests=2),angular.forEach(u.engagementStore.products,function(t,o){t.product.selectedQuantity=Math.round(t.fractionatedUnits*e)})},!0),R.isEmpty(u.engagementStore.promo)&&(u.engagementStore.promo=null),$("#engagementStoreMainContainer").fadeIn("slow"),HoldOn.close(),u.engagementStore};o()}angular.module("app").controller("EngagementStore",e),e.$inject=["engagementStore_dataService","$scope"]}(),function(){"use strict";function e(e,t){function o(t){function o(e,t,o,n){return e.data}return e({method:"GET",url:"/engagementStore?store="+t}).then(o)}function n(){function e(){c=!0}return s?s:s=t.when(!0).then(e)}function i(t){return e({method:"POST",url:"/basket/add/",data:$.param(t)})}function r(e){var o=s||n();return o.then(function(){return t.all(e)})}function a(){return e({method:"GET",url:"/engagementStore/engage/getStores/"})}var s,c=!1,l={ready:r,getEngagementStore:o,addtocart:i,getAllStores:a};return l}angular.module("app").factory("engagementStore_dataService",e),e.$inject=["$http","$q"]}(),function(){"use strict";function e(e,t,o){e.get_gift_card_data=function(){t.getGiftCardData().then(function(t){e.response=t,e.cat_msg=t.data.cat_msg,e.amount_msg=t.data.amount_msg,e.themes=t.data.themes,e.amts=t.data.amts,e.pm_list=t.data.pm_list,e.wal_balance=t.data.wal_balance,e.final_wal_balance=0,e.sub_total=0,e.final_total=0,e.wallet_sel=!1,e.selected_theme="",e.selected_image="",e.first_name="",e.email_id="",e.mobile_no="",e.gift_sender=t.data.user_name,e.selected_recipient="",e.selected_theme=e.themes[0].slug,e.selected_amt=e.amts[0],e.edit_card=!1,e.images=e.themes[0].images,e.show_drop=!1,e.is_member=$.cookie("_bb_mid"),null===window.localStorage.getItem("recipient_list")?e.recipient_list=[{first_name:"",email_id:"",mobile_no:""}]:e.recipient_list=angular.fromJson(localStorage.getItem("recipient_list")),null===window.localStorage.getItem("gift_msg")?e.gift_msg="":e.gift_msg=localStorage.getItem("gift_msg"),o(function(){$("#gift-carousel").owlCarousel({items:1,loop:!1,nav:!0,dots:!0,callbacks:!0,navText:["<i class='fa fa-chevron-left' aria-hidden='true'></i>","<i class='fa fa-chevron-right' aria-hidden='true'></i>"]})},0);for(var n=0;n<e.pm_list.length;n++)e.payment_methods=e.pm_list[n].options,e.sel_pm=e.pm_list[n].options[n].value;e.gift_card_google_analytics("create-gift-card-page","gift-card","/member/gift_cards/"),window.scope=e})},e.get_images=function(){console.log("images:"+e.images),console.log("slec theme:"+e.selected_theme);for(var t=0;t<e.themes.length;t++)e.themes[t].slug==e.selected_theme&&(e.images=e.themes[t].images)},e.save_recipient=function(t){var n=$(".recipients .recipient-details").length,i=$(".recipients .recipient-details").size()+1,r=5;i<=r?(e.recipient_list.push({first_name:e.first_name,email_id:e.email_id,mobile_no:e.mobile_no}),t&&(e.recipient_list.pop(),localStorage.setItem("recipient_list",angular.toJson(e.recipient_list)),localStorage.setItem("gift_msg",e.gift_msg))):($(".add_recipient_alert").fadeIn(),o(function(){$(".add_recipient_alert").fadeOut()},2e3)),e.first_name="",e.email_id="",e.mobile_no="",$("#gift-carousel").owlCarousel().trigger("destroy.owl.carousel"),o(function(){$("#gift-carousel").owlCarousel({items:1,dots:!0,nav:!0,navText:["<i class='fa fa-chevron-left' aria-hidden='true'></i>","<i class='fa fa-chevron-right' aria-hidden='true'></i>"]}),$("#gift-carousel").trigger("to.owl.carousel",n),$(".recipient-details").removeClass("active"),$(".recipient-details:last-child").addClass("active")},0)},e.go_to_slide=function(e){$("#gift-carousel").trigger("to.owl.carousel",e),$(".recipient-details").removeClass("active"),$(".recipient-details.count_"+e).addClass("active")},e.update_recipient_name=function(t,o){console.log("Preview name"+t),e.selected_recipient=t,$("#gift-carousel").trigger("to.owl.carousel",o)},e.remove_recipient=function(t){var n=$(".recipients .recipient-details").size()+1;$("#gift-carousel").owlCarousel().trigger("destroy.owl.carousel"),o(function(){$("#gift-carousel").owlCarousel({items:1,dots:!0,nav:!0,navText:["<i class='fa fa-chevron-left' aria-hidden='true'></i>","<i class='fa fa-chevron-right' aria-hidden='true'></i>"]}),$("#gift-carousel").trigger("to.owl.carousel",t-1),$(".recipient-details").removeClass("active"),$(".recipient-details:nth-last-child(2)").addClass("active")},100),n>2&&e.recipient_list.splice(t,1)},e.gift_card_google_analytics=function(e,t,o){void 0!=window.gtag&&gtag("event",t,{event_category:e,event_label:o,value:""})},e.editCard=function(){e.edit_card=!1,e.wallet_sel=!1,e.final_wal_balance=0,$("#collapseOne").collapse("show"),$("#collapseTwo").collapse("hide")},e.calc_total=function(){if(e.is_member)if(e.gift_card_google_analytics("clicked-proceed-to-payment","gift-card","/member/gift_cards/"),e.giftForm.$valid){var t=e.selected_amt*e.recipient_list.length;e.sub_total=t,e.final_total=e.sub_total,e.edit_card=!0,$("#collapseTwo").collapse("show"),$(this).fadeOut(),localStorage.removeItem("recipient_list"),localStorage.removeItem("gift_msg")}else console.log("Unable to save. Validation error!");else e.save_recipient(!0),window.openLoginModal("login","/co/create-gift-card/")}}var t=angular.module("app.GiftCard");t.directive("allowOnlyNumbers",function(){return{restrict:"A",link:function(e,t,o,n){t.on("keydown",function(e){var t=$(this),o=t.val();return o=o.replace(/[^0-9]/g,""),t.val(o),64!=e.which&&16!=e.which&&(e.which>=48&&e.which<=57||(e.which>=96&&e.which<=105||([8,9,13,27,37,38,39,40].indexOf(e.which)>-1||(e.preventDefault(),!1))))})}}});t.controller("GiftCardController",e),e.$inject=["$scope","GiftCardService","$timeout"]}(),angular.module("app.GiftCard").service("GiftCardService",["$http","$q",function(e,t){function o(){return e.get("/co/gift-card-data/")}return{getGiftCardData:o}}]),function(){"use strict";function e(e){function t(e,t,o,n,i){$(document).trigger("screenViewReferralsEvent",[{}]),"custompage"==ctype?o="cp | "+o:"customtemplates"==ctype&&(o="cptp | "+o),void 0!=window.gtag&&gtag("event",o,{event_category:t,event_label:n,value:i})}var o={pushToGoogleAnalytics:t};return o}angular.module("app.layout").service("GAService",e),e.$inject=["$window"]}(),function(){function e(e){return("https:"==window.location.protocol?"/auth":"")+e}function t(t,n,i,r){function a(){return S.items?S.items.length:null}function s(){var e={};return angular.forEach(S.items,function(t){e[t.pid]=t.quantity}),e}function c(){function o(e){return S=e.data}return t.get(e("/basket/get/")).then(o)}function l(e,o,n){function a(e){var t=e.data.success;return t||i.error("",e.data.mesg,{timeOut:500,positionClass:"toast-top-full-width",closeButton:!0,preventDuplicates:!0,preventOpenDuplicates:!0}),e.data}var s={prod_id:e,qty:o,cart_type:1,is_list:[],term:$.query.get("q"),term_source:"/ps/"===location.pathname?"ps":"",sid:n,is_express_tab:!1,cartitem_mode:"normal"},c=new BasketUrlBuilder;return c=r.useNodeCart?c.withNodeCartUrl().build():c.build(),r.useNodeCart||(s=$.param(s)),t.post(c.updateQtyUrl,s).then(a)}function d(e,o,n,i){function a(e){var t=e.data.success;return t}var s={prod_id:e,qty:o,ru:"/ & spn = 0",cart_type:1,nc:"auto - search",term:i,term_source:"AUTO",sid:n,csrfmiddlewaretoken:$.cookie("csrftoken"),cartitem_mode:"normal"},c=new BasketUrlBuilder;return c=r.useNodeCart?c.withNodeCartUrl().build():c.build(),r.useNodeCart||(s=$.param(s)),t.post(c.addToCartUrl,s).then(a)}function u(e,o){"use strict";function n(e){return e.data}var i={sid:o,prod_id:e,cart_type:1,is_list:[]},a=new BasketUrlBuilder;return a=r.useNodeCart?a.withNodeCartUrl().build():a.build(),r.useNodeCart||(i=$.param(i)),t.post(a.delItemUrl,i).then(n)}function p(){function o(e){return k.memberinfo=e.data,k}return t.get(e("/get_member_details/")).then(o)}function g(o,n){function i(e){if(e.data.success)return e.data&&e.data.items&&!R.isEmpty(e.data.items)?e.data:null}var r={city_id:o,address_id:n};return t.post(e("/basket/get-cart-item-difference/"),$.param(r)).then(i)}function m(o,n){function i(e){return!!e.data.success}var r={city_id:o,address_id:n,csrfmiddlewaretoken:$.cookie("csrftoken")};return t.post(e("/set-city/"),$.param(r)).then(i)}function f(o){function n(e){if(e.data.success){var t={},o=[];return angular.forEach(e.data.adresses,function(e){o=e.is_5k?[{type:"Express Delivery",slot:e.darkstore_next_slot,img:"custPage/build/content/img/bike_red.png",bb_star_avail:e.bb_star_avail,is_5k:e.is_5k,show_express:e.show_express},{type:"Standard Delivery",slot:e.darkstore_next_slot,img:"custPage/build/content/img/van_icon_green.png",bb_star_avail:e.bb_star_avail,is_5k:e.is_5k,show_express:e.show_express}]:[{type:"Express Delivery",slot:e.express_closed_5k?"(Slots Full)":e.darkstore_next_slot,img:"custPage/build/content/img/bike_red.png",bb_star_avail:e.bb_star_avail,is_5k:e.is_5k,show_express:e.show_express},{type:"Standard Delivery",slot:e.express_closed_5k?e.darkstore_next_slot:e.normal_next_slot,img:"custPage/build/content/img/van_icon_green.png",bb_star_avail:e.bb_star_avail,is_5k:e.is_5k,show_express:e.show_express},{type:"Express Delivery",slot:e.express_next_slot,img:"custPage/build/content/img/bike_red.png",bb_star_avail:e.bb_star_avail,is_5k:e.is_5k,show_express:e.show_express}],o=R.filter(function(e){return!!e.slot&&""!=e.slot},o),o=o.length>0?o:null,o=R.forEach(function(e){"Standard Delivery"===e.type?e.type="Standard":e.slot=e.type+":"+e.slot},o),o=R.filter(function(e){return!e.is_5k||!(e.show_express&&"Standard"===e.type||!e.show_express&&"Standard"!==e.type)},o),t[e.id]=o}),t}return null}var i={address_id:o,all:!0};return t.post(e("/member/get-address-slots/"),$.param(i)).then(n)}function h(){if(k&&k.memberinfo)return k.memberinfo}function _(o,n){function i(e){var t=e.data;return t}var r={product_id:n,notify_type:o,is_ct:!0,csrfmiddlewaretoken:$.cookie("csrftoken")};return t.post(e("/product/call-notify-popup/"),$.param(r)).then(i)}function v(o){function n(e){return e.data}return t.get(e("/product/get-multi-combo-products?is_cp=1&sku_id="+o)).then(n)}function b(){function e(){T=!0}return w?w:w=n.when(!0).then(e)}function y(e){var t=w||b();return t.then(function(){return n.all(e)})["catch"](function(e){})}var w,S={},k=new o(null),T=!1,P={getCart:c,getMember:p,updateBasket:d,deleteFromBasket:u,ready:y,getCartDifference:g,setdelivertoArea:m,sendStockNotification:_,getSlotsForAddress:f,updateCartQuantity:l,getmembername:h,getformatedcart:s,getCartLength:a,getMultiSkuComboProducts:v};return P}var o=function(){this.memberinfo=null,this.currentAddress=null};angular.module("app.layout").factory("UserDataservice",t),t.$inject=["$http","$q","toastr","$rootScope"]}(),function(){function e(e,t){var o=this;o.footerData=[],$.cookie("_bb_vid")&&t.getfooter().then(function(e){o.footerData=e})}angular.module("app.layout").controller("Footer",e),e.$inject=["$scope","FooterDataservice"]}(),function(){function e(e,t){function o(){function o(e){"use strict";return e.data}var n=document.getElementById("city_id"),i="/auth/get_footer/?";return i+=n&&n.value?"city_id="+Number(n.value):"cai="+t.CURRENT_ADDRESS_ID,e.get(i).then(o)}function n(){function e(){a=!0}return r?r:r=$q.when(!0).then(e)}function i(e){var t=r||n();return t.then(function(){return $q.all(e)})["catch"]()}var r,a=!1,s={getfooter:o,ready:i};return s}angular.module("app.layout").factory("FooterDataservice",e),e.$inject=["$http","$window"]}(),function(){function e(e,t,o,n,i,r,a,s,c,l){function d(){var t=A.hideOnscroll;r.scrollY>2*r.innerHeight?A.hideOnscroll=!1:A.hideOnscroll=!0,t!=A.hideOnscroll&&e.$apply()}function u(e,t){$(".dropbtn").removeClass("dropdown-active"),$(document).trigger("addressInteractionPlower",[{EventName:"ChangeAddress_MessageDisplay"}]),window.show_cart_change_popup(e,t)}function p(e){A.deliveryaddress={address:e},n.getCartDifference(e.city_id,e.id).then(function(e){A.deliveryaddress.addresschangeqc=e,$(document).trigger("addressInteractionPlower",[{EventName:"ChangeAddress_MessageDisplay"}]),A.deliveryaddress.addresschangeqc||!A.newPopup?($(".dropdown-menu1, .overlay-dropdown").hide(),$(".dropbtn").removeClass("dropdown-active"),$("#uiv2-multicity-change").show(),$("#shoplist-mask").fadeIn()):($("body").removeClass("pos-fixed"),$(".dropdown-menu1").hide(),$(".dropbtn").removeClass("dropdown-active"),$(".top-header").removeClass("locpops"),$(".middle-header").css("top","0px"),$("#pageLoader").show(),$(".basket-loader").css("display","block"),A.setdeliveryArea())})}function g(e){return decodeURIComponent((new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[null,""])[1].replace(/\+/g,"%20"))||null}function m(){"use strict";o.getPageInfo().then(function(n){if(A.member_done=!0,"/"==window.location.pathname){if(A.isHomePage=!0,n.special_notifications&&n.special_notifications.length>0)for(var i in n.special_notifications)"bbstar_expiry"===n.special_notifications[i].special_notification_type&&(n.special_notifications[i].member_name=n.member_info.first_name,A.specialnotification=n.special_notifications[i],A.specialnotification.show_popup&&($("#bbstarAutoRenewalReminder").modal(),$("#bbstarAutoRenewalReminder").on("hidden.bs.modal",function(e){o.bbstarAutoRenewalPopupViewed().then(function(e){A.autoRenewalClicked&&(window.location.href="/bbstar-renewal/")})["catch"](function(e){})})))}else A.isHomePage=!1;0==n.selected_address.is_partial&&(n.selected_address.address_1&&(A.currentAddress=A.currentAddress+n.selected_address.address_1+", "),n.selected_address.residential_complex&&(A.currentAddress=A.currentAddress+n.selected_address.residential_complex+", "),n.selected_address.address_2&&(A.currentAddress=A.currentAddress+n.selected_address.address_2+", "),A.currentAddress=A.currentAddress+n.selected_address.area+", ",A.currentAddress=A.currentAddress+n.selected_address.city_name+" - ",A.currentAddress=A.currentAddress+n.selected_address.pin,$("#tokenWidgetPopup__addr").text(A.currentAddress)),t.is_5k=!!n.selected_address&&n.selected_address.is_5k,b(),t.member_stores=n.member_stores,t.express_closed="BB EXPRESS",t.is_express_availaible=v(n.member_stores),t.$broadcast("PAGE_DATA_LOADED",{}),window.foo&&(foo.emit("PAGE_DATA_LOADED",n.member_stores),window.member_stores=n.member_stores),t.useNodeCart=n.USE_NODE_CART_SERVICE,A.current_city=n.current_city,A.selectedAddressDefault.city_id=A.current_city.id,A.selectedAddressDefault.city_name=A.current_city.name,n.site_message&&(A.siteMessageAvaiable(n.site_message),$("#site_msg_label").text(n.site_message),$("#site_msg").show()),A.address_city_name=void 0===n.selected_address?A.selectedAddressDefault.city_name:n.selected_address.city_name,A.address_city_id=void 0===n.selected_address?A.selectedAddressDefault.city_id:n.selected_address.city_id,A.user.currentAddress=void 0===n.selected_address?A.selectedAddressDefault:n.selected_address,A.user.currentAddress.residential_complex&&A.user.currentAddress.residential_complex.length>0&&(A.user.currentAddress.address_display_name=A.user.currentAddress.residential_complex+","+A.user.currentAddress.area),window.dataLayer&&dataLayer.push({city:A.address_city_name}),A.user.currentAddress.city_support_number=n.city_support_number,
A.user.cart_no_items=r.CART,t.cart_no_items=A.user.cart_no_items,A.offerFlowEnabled=n.OFFERS_FLOW_ENABLED,$("#totalNumberOfCartItems").html(A.user.cart_no_items+" items"),$("#mobiletotalNumberOfCartItems").html(A.user.cart_no_items),A.user.is_member=n.is_member,n.selected_address?A.selectedlocation.cityquery=A.address_city_name:A.selectedlocation.cityquery="",t.has_speciality=n.has_speciality,A.all_cities=I(n.all_cities_choices),A.selectedlocation.city={name:A.address_city_name,value:A.address_city_id,id:A.address_city_id},A.kapture_chat=n.kapture_chat,A.cityselected=!0,A.selectedlocation.area="",A.headerBanner=n.header_banner,A.searchPlaceholder=n.search_label,A.show_my_membership_link=n.show_my_membership_link,A.show_priority_slot_msg=n.show_priority_slot_msg,A.is_active_bb_star_member=n.is_active_bb_star_member,A.giftingMsg=n.gifting_msg,1==loggedInUser&&(1==n.selected_address.is_partial&&t.cart_no_items>0?a(function(){A.cityMessage=!1,$(document).trigger("addressInteractionPlower",[{EventName:"Login_PartialAddressPopUp_Shown",Location:A.user.currentAddress.city_name+"|"+A.user.currentAddress.area,AdditionalInfo2:$.cookie("_bb_locSrc")}]),A.locdropdown()},0):a(function(){A.cityMessage=!1,$.removeCookie("_bb_ftvid",{path:"/",domain:window.location.host.replace("www","")}),$.removeCookie("_bb_locSrc",{path:"/",domain:window.location.host.replace("www","")})},0)),$.cookie("_bb_mid")&&(A.cityMessage=!1,$.removeCookie("_bb_locSrc",{path:"/",domain:window.location.host.replace("www","")})),U(),A.hp_sections={},A.hp_sections.section1=n.hp_sec1_banner;var s=g("pg");null!=A.headerBanner&&(A.headerBanner["Image name"]=MEDIA_URL+A.headerBanner["Image name"]),null!=A.searchPlaceholder||void 0!=A.searchPlaceholder?A.searchPlaceholder=A.searchPlaceholder["Banner Text"].caption1:A.searchPlaceholder="Search for Products..",n.has_speciality&&(A.has_speciality=n.has_speciality),A.user.is_member&&(A.user.memberinfo=n.member_info,A.user.other_address=!1,t.ismember=!0,n.top_nav_addresses&&!R.isEmpty(n.top_nav_addresses)&&(A.user.other_address=n.top_nav_addresses),window.location.href.indexOf("choose-city/?pg=1&next=/")>-1&&1==s&&e.$$postDigest(function(){A.locationMWDropdown()}),window.dataLayer&&dataLayer.push({noo:A.user.memberinfo.noo,dolo:A.user.memberinfo.dolo,dofo:A.user.memberinfo.dofo}));var c=[{type:"Express",slot:n.express_closed_5k?"Express Delivery: (Slots Full)":n.darkstore_next_slot,img:USED_STATIC_URL+"img/express-del.svg"},{type:"Standard",slot:n.express_closed_5k?n.darkstore_next_slot:n.normal_next_slot,img:USED_STATIC_URL+"img/standard-del.svg"},{type:"Express",slot:n.express_next_slot,img:USED_STATIC_URL+"img/express-del.svg"}];if(c=R.filter(function(e){return!!e.slot&&e.slot.length>0},c),A.availaible_slots=c.length>0?c:null,angular.forEach(A.availaible_slots,function(e,t){A.availaible_slots[t].slot=A.format_slot(A.availaible_slots[t].slot)}),void 0===n.selected_address){$("#main_menu_icon").removeAttr("onclick"),$(".cart-image").removeAttr("href"),$(".mw-bb-logo").removeAttr("href"),$("#main_menu_icon, .user-mw-drop, .mw-bb-logo, .cart-image, .mask").click(function(){$(".dropdown-menu").effect("shake",{times:1},{distance:5},300)});var l=f();1==l&&A.locationMWDropdown()}A.user.is_member||window.location.href.indexOf("choose-city/?pg=1&next=/")>-1&&1==s&&e.$$postDigest(function(){A.locationMWDropdown()});for(var d=0;d<A.all_cities.length;d++)n=A.all_cities[d],n.label=A.all_cities[d].name,n.value=A.all_cities[d].name,n.id=A.all_cities[d].id,M.push(n)})}function f(){return function(e){if(/(android|ipad|playbook|silk|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))return!0}(navigator.userAgent||navigator.vendor||window.opera),!1}function h(){A.user.is_member?n.sendStockNotification("B",A.outofstockproduct).then(function(e){e&&i.success("","You will be notified via Email, SMS/Push Notification when the product is available",{timeOut:5e3,positionClass:"toast-top-full-width",closeButton:!0,preventDuplicates:!0})}):window.location.href="/auth/login/?nc=nb"}function _(){"use strict";return{residential_complex:" ",isdummy:!0,nick:" ",first_name:" ",last_name:" ",is_partial:!1,pin:560001,area:" ",city_id:0,contact_area:"",contact_no:"",landmark:"",address_display_name:"M.G Road   ",city_name:"",address_1:"",address_2:"",lat:12.919697509246365,lng:77.57679894536898,nickname:"",id:"",is_express:!0}}function v(e){var t=!1;for(var o in e)if(e[o].show_express){t=!0;break}return t}function b(){"use strict";return o.getShops().then(function(e){A.shops=e.shops,A.express_shops=R.filter(function(e){return 1==e.is_express},A.shops),A.shops=R.filter(function(e){return 0==e.is_express},A.shops),A.offers=e.offers,A.mainMenuEntryShop1=e.main_menu_banner1,null!=A.mainMenuEntryShop1&&(A.mainMenuEntryShop1["Image name"]=MEDIA_URL+A.mainMenuEntryShop1["Image name"])})}function y(){var e=[];e=void 0!=PAGE_TYPE&&"hpcp"===PAGE_TYPE?[m(),S()]:[m()],o.ready(e).then(function(){"use strict";$("#pageLoader").hide()}),A.VERSIONED_STATIC="True"==VERSIONED_STATIC,A.STATIC_URL=STATIC_URL,A.VERSION=VERSION,A.MEDIA_URL=MEDIA_URL,A.USE_NODE=USE_NODE,A.BBPLUS_ENABLED=!1,"undefined"!=typeof CUSTOMER_SELF_SERVICE_WEB_DISABLED&&(A.CUSTOMER_SELF_SERVICE_WEB_DISABLED=CUSTOMER_SELF_SERVICE_WEB_DISABLED),A.MEMBER_REFERAL_ACTIVE=!1,A.currenturl=window.location.pathname+window.location.search;var t=window.location.search.match(/next=(.*)/);t&&t.length>1?A.currenturl=encodeURIComponent(t[1]):A.currenturl="/",U()}function w(e,t,o){var n;return function(){var i=this,r=arguments,a=function(){n=null,o||e.apply(i,r)},s=o&&!n;clearTimeout(n),n=setTimeout(a,t),s&&e.apply(i,r)}}function S(){"use strict";o.getLeftMenu().then(function(e){var t=e;A.leftmenu=t.topcats,A.viewAllBanner=t.viewallbanner,A.viewAllBanner&&(A.viewAllBanner=A.viewAllBanner[0]),A.showSubmenu(A.leftmenu[0]);var o=[];angular.forEach(A.leftmenu,function(e,t){o.push(C(e,t)),e.top_category.nav_banner&&(e.top_category.nav_banner.banners=e.top_category.nav_banner.banners[0],e.top_category.nav_banner.banners.image={background:"url('"+A.MEDIA_URL+e.top_category.nav_banner.banners.image+"')",height:"400px","background-repeat":"no-repeat","background-position":"right"})}),A.showSubmenu(A.leftmenu[0]),setTimeout(function(){$("#navBarMegaNav").menuAim({activate:k,deactivate:P,submenuDirection:"right"}),$("#navBarSticky").menuAim({activate:k,deactivate:P,submenuDirection:"right"})},3e3)})}function k(e){var t=$(e);x=e,L.scope().vm.menuHoverFixCallingshowSubmenu(t.data("l2"));var o=t.data("submenuId"),n=$("#"+o),i=$(t).parent().outerHeight();width=$(t).parent().outerWidth(),n.css({display:"block",top:-1,left:width-3,height:i-4}),t.find("a").addClass("active")}function T(e){var t=$(e),o=t.data("submenuId"),n=$("#"+o),i=$(t).parent().outerHeight();width=$(t).parent().outerWidth(),n.css({display:"block",top:-1,left:width-3,height:i-4}),t.find("a").addClass("active")}function P(e){var t=$(e),o=t.data("submenuId"),n=$("#"+o);n.css("display","none"),t.find("a").removeClass("active")}function C(e,t){"use strict";var o=E(e.sub_cats);e.subcategories=o,e.subcategories.chunks={chunk1:o[0]},o.length>1&&(e.subcategories.chunks.chunk2=o[1],o[1].length>9&&(e.subcategories.chunks.chunk2=o[1].splice(0,9),e.subcategories.chunks.showmore=!0))}function E(e){var t=[];if(e){angular.forEach(e,function(e){var o=[];angular.forEach(e,function(e){var t={name:e.sub_category[0],slug:e.sub_category[1],url:e.sub_category[2]};if(t.search_term=e.search_term,e.l2_banner){var n={};n.type=e.l2_banner.type,angular.forEach(e.l2_banner.banners,function(e){n[e.display_name]=e}),t.banner=n}t.options=null,e.cats&&e.cats.length>0&&(t.options=[],angular.forEach(e.cats,function(e){var o={name:e.cat[0],slug:e.cat[1],url:e.cat[2]};t.options.push(o)})),o.push(t)}),o&&t.push(o)})}return t}window.loadGTA&&window.loadGTA();var A=this,M=[];"true"===$.cookie("_fls")&&(r.remove_cache=!0),"undefined"==typeof new_checkout&&(new_checkout=!1),"/basket/"==window.location.pathname&&new_checkout&&(A.newPopup=!0),$.cookie("_bb_ftvid")?A.cityMessage=!0:A.cityMessage=!1,A.firstTimeUser=!1,A.showError=!1,A.autoRenewalClicked=!1,A.user={},A.cart={},A.showSearchContent=!1,A.searchfound=!1,A.showdrop=!1,A.cartupdate=!0,A.availaible_slots={},A.leftmenu={},A.shops={},A.offers={},A.AreaList=[],A.notifymethod="E",A.notifyMe=h,A.currentAddress="",A.isB2BSite="True"===$("#IS_B2B_SITE").val(),A.selectedAddressDefault=_(),A.set_city_cart_check=p,A.newLoginFlow=window.NEW_LOGIN_FLOW,t.member_stores={},t.cart_no_items=0,t.ismember=!1,t.csrf=$.cookie("csrftoken");var I=R.sortBy(R.compose(R.toLower,R.prop("name")));A.selectedlocation={city:I[0],area:""};var x=[];A.readyToShow=!1,A.show_cart_change_popup=u,A.showOrderAssistant=!1,$(".top-header").removeClass("dispNone"),$(".clear-search").removeClass("dispNone"),window.OA_WIDGET&&r.addEventListener("load",function(){A.showOrderAssistant="/"==window.location.pathname&&!("hide"==sessionStorage.getItem("orderAssistant")),d(),A.showOrderAssistant&&angular.element(r).bind("scroll",function(e){d()}),e.$apply()}),A.gotosubcategory=function(e){window.location.href=e.url},A.getNumberOfCartItems=function(){A.user.cart_no_items=n.getCartLength()?n.getCartLength():A.user.cart_no_items},A.siteMessageAvaiable=function(e){return A.siteMessage=e,$("#site_msg_label").text(e),$("#site_msg").show(),1},A.bbstarAutoRenewalPopupViewed=function(){A.autoRenewalClicked=!0,$("#bbstarAutoRenewalReminder").modal("hide")},t.$on("Notify",function(e,t){"use strict";A.outofstockproduct=t,null!=$("div[id*='comboModal']")&&$("div[id*='comboModal']").modal("hide"),A.notifyMe()}),A.showDropdown=function(){A.showdrop=!0};var O=function(e){return R.is(Object,e)},D=function(e){e.qty=1},U=function(){"/gifting/"==window.location.pathname&&(A.currenturl="/gifting/",A.cityMessage=!0)};A.validate_cookie=function(){return void 0!=$.cookie("_bb_vid")||(window.location.href="/",!1)},A.searchProducts=function(){"use strict";function e(e){A.searchResults=e.results,A.searchResults.data=R.filter(O,A.searchResults.data),0===A.searchResults.data.length?A.searchfound=!1:(A.searchfound=!0,angular.forEach(A.searchResults.data,D),R.isEmpty(A.searchResults.suggestions.ads)&&(A.searchResults.suggestions.ads=!1),R.isNil(A.searchResults.suggestions.discounts)?A.searchResults.suggestions.discounts=!1:(A.searchResults.suggestions.discounts.pid=A.searchResults.suggestions.discounts.id,A.searchResults.suggestions.discounts.text=A.searchResults.suggestions.discounts.description,D(A.searchResults.suggestions.discounts))),A.showSearchContent=!0}var t=A.validate_cookie();t&&(A.searchPhrase.length>=3?(A.showSearchContent=!0,o.searchProducts(A.searchPhrase,A.current_city.id,"").then(e)):0===A.searchPhrase.length&&(A.showSearchContent=!1))},A.addProductsFromSearch=function(e){isNaN(e.qty)||e.qty<0?i.error("Invalid Quantity","Add To Basket",{timeOut:5e3,positionClass:"toast-top-full-width",closeButton:!0,preventDuplicates:!0,preventOpenDuplicates:!0}):n.updateBasket(e.pid,e.qty,"",A.searchPhrase).then(function(o){o&&(i.success("","Successfully added "+e.text+" to the basket",{timeOut:500,positionClass:"toast-top-full-width",closeButton:!0,preventDuplicates:!0}),t.$broadcast("getCart",A.selectedProduct),$(document).trigger("basketInteractionsPlowerWithAngular",[{EventName:"Basket_Add",SkuID:e.pid,Quantity:e.qty,UnitMrp:e.price,UnitSalePrice:e.price,ScreenInPageContext:"auto-search"}]))})},A.callBroadcastGetCart=function(){"use strict";t.$broadcast("getCart",{})},A.clearSearch=function(){A.searchResults=null,A.showSearchContent=!1},A.clearSearches=function(){A.searchResults=null,A.showSearchContent=!1,A.searchPhrase=""},A.canShowSearchSuggestions=function(){return!!(A.searchResults&&A.searchResults.suggestions&&(A.searchResults.suggestions.ads||A.searchResults.suggestions.terms.length>0||A.searchResults.suggestions.brands.length>0||A.searchResults.suggestions.categories.length>0))},A.userManualSearch=function(){A.searchPhrase&&A.searchPhrase.length>0&&($(document).trigger("screenViewReferralsEvent",[{}]),window.location.href="/ps/?q="+encodeURIComponent(A.searchPhrase))},A.debouncedsearchProducts=w(function(){A.searchProducts()},250);var L=angular.element(document.getElementById("headerControllerId"));A.showL2Category=function(e){A.selectedl2=e},A.showSubmenu=function(e){A.selectedtop=e,A.selectedtop.subcategories&&A.showL2Category(A.selectedtop.subcategories.chunks.chunk1[0])},A.selectmenubanner=function(){window.location.href=A.selectedtop.top_category.nav_banner.banners.url},A.clearMenu=function(){A.viewall=!1,A.showSubmenu(A.leftmenu[0]),T([$("#navBarMegaNav li")[0]]),T([$("#navBarSticky li")[0]]),P(x)},A.menuHoverFixCallingshowSubmenu=function(t){"use strict";void 0!==t&&(A.showSubmenu(A.leftmenu[t]),e.$apply())},A.offcanvasToggle=function(e){var t=$("#offsubmenu"+e);t.find("ul").slideToggle(),t.find("i").toggleClass("fa-plus fa-minus")},A.changeLocation=function(){A.showdrop=!1},A.chooseCity=function(e){A.selectedlocation.city=e.id},A.skipandexplore=function(e){e?window.location.href="/skip_explore/?c="+e+"&l=0&s=0&n="+A.currenturl:(A.cityselected&&A.selectedlocation.cityquery&&0!==A.selectedlocation.cityquery.length||(A.selectedlocation.city={name:A.current_city.name,value:A.current_city.id,id:A.current_city.id}),A.selectedlocation.cityquery!==A.selectedlocation.city.name&&(A.selectedlocation.city=R.find(R.propEq("name",A.selectedlocation.cityquery))(A.all_cities)),$(document).trigger("addressInteractionPlower",[{EventName:"SkipExplore_Clicked",Location:A.selectedlocation.city.name,AdditionalInfo2:$.cookie("_bb_locSrc")}]),$.removeCookie("_bb_locSrc",{path:"/",domain:window.location.host.replace("www","")}),window.location.href="/skip_explore/?c="+A.selectedlocation.city.id+"&l=0&s=0&n="+A.currenturl)},A.continueClicked=function(){$(document).trigger("addressInteractionPlower",[{EventName:"ChangeMyLocation_ContinueClicked",Location:A.selectedlocation.cityquery+"|"+A.selectedlocation.area.label,AdditionalInfo2:$.cookie("_bb_locSrc")}]),$.removeCookie("_bb_locSrc",{path:"/",domain:window.location.host.replace("www","")}),s.pushToGoogleAnalytics("_trackEvent","city-select","change-city | Success",A.user.currentAddress.city_name+"|"+A.user.currentAddress.area,1)},A.emptyCheck=function(){A.selectedlocation.query||(A.showError=!1)},A.getAreasForCity=function(e,t){return A.selectedlocation.query=e,A.selectedlocation.cityquery&&A.selectedlocation.cityquery.length>0&&A.selectedlocation.query&&R.find(R.propEq("name",A.selectedlocation.cityquery))(A.all_cities)?o.getAreasForCity(A.selectedlocation.city.id,A.selectedlocation.query,A.USE_NODE).then(function(e){return A.AreaList=e,0===e.length&&(A.areaselected=!1,A.showError=!0),t?void t(e):e.map(function(e){return e.display_name===e.pincode?e.label=e.display_name+" , "+A.selectedlocation.city.name:e.label=e.display_name+"-"+e.pincode+","+A.selectedlocation.city.name,e})}):(A.areaselected=!1,A.showError=!0,[])},A.isSkipnExplore=function(){return!(A.cityselected&&A.selectedlocation.cityquery&&A.areaselected&&A.selectedlocation.query)},A.onSelect=function(e){A.selectedlocation.city;A.selectedlocation.area=e,A.selectedlocation.submit=!0,A.areaselected=!0,A.showError=!1},A.onSelectCity=function(e){A.selectedlocation.city={id:e.id,name:e.name},A.selectedlocation.cityquery=A.selectedlocation.city.name,A.citychanged(),setTimeout(function(){$("#areaselect").focus()},100)},A.changeDeliveryAddress=function(e){$(document).trigger("addressInteractionPlower",[{EventName:"ChangeAddress_MessageDisplay"}]),$("#left-menu-overlay").hide(),A.showdrop=!1,A.deliveryaddress={address:e},n.getCartDifference(e.city_id,e.id).then(function(e){A.deliveryaddress.addresschangeqc=e})},A.setdeliveryArea=function(){A.newPopup&&($("#uiv2-multicity-change").hide(),$(".basket-loader").css("display","block"),$(".overlay-dropdown").css("display","block")),n.setdelivertoArea(A.deliveryaddress.address.city_id,A.deliveryaddress.address.id).then(function(e){if(e){var t=[];if(A.deliveryaddress.addresschangeqc)for(var o=0;o<A.deliveryaddress.addresschangeqc.items.length;o++)t.push(""+A.deliveryaddress.addresschangeqc.items[o].skuid);$(document).trigger("addressInteractionPlower",[{EventName:"ChangeAddress_Continue",ItemsRemoved:t}]),window.location.reload()}})},A.getslotsforaddress=function(e){var t=[];n.getSlotsForAddress(R.map(function(e){return e.id},e)).then(function(o){angular.forEach(e,function(e,n){if(o&&o[e.id]){e.availaibleslots=o[e.id],angular.forEach(e.availaibleslots,function(t,o){e.availaibleslots[o].slot=A.format_slot(e.availaibleslots[o].slot),1===t.bb_star_avail&&(e.bb_star_avail=1)});var i=e.availaibleslots;2==i.length&&1!=i[0].bb_star_avail&&1!=i[1].bb_star_avail?e.bb_star_avail=0:1==i.length&&1!=i[0].bb_star_avail&&(e.bb_star_avail=0),t.push(e)}}),A.user.other_address=t})},A.citychanged=function(){A.selectedlocation.query="",A.selectedlocation.submit=!1,A.cityselected=!0},A.format_slot=function(e){var t=e;return t=t.replace("Standard Delivery:",""),t=t.replace("Express Delivery:",""),t=t.replace("By",""),t=t.replace("Next",""),t=t.replace(/AM.*to/," -"),t=t.replace(/PM.*to/," -")},A.showuserdrop=function(){A.user.currentAddress.isdummy||($(".mask").show(),$(".dropbtn").removeClass("dropdown-active"),$(".user-btn").addClass("dropdown-active"),$(".mask").click(function(){$(this).fadeOut(),$("body").removeClass("pos-fixed"),$(".user-btn").removeClass("dropdown-active")}))},A.locationMWDropdown=function(){$("#city-select").val(A.user.currentAddress.city_name),A.selectedlocation.query="";var t=$(".dropbtn");$(".user-btn").removeClass("dropdown-active"),$(".dropbtn").addClass("dropdown-active"),$("body").addClass("pos-fixed"),$(".mask").fadeIn(),1==$("dropbtn.xhrcalls-only").hasClass("dropdown-active")&&A.user.is_member&&A.user.other_address&&A.getslotsforaddress(A.user.other_address),A.user.currentAddress.isdummy||$(".mask").click(function(){$(this).fadeOut(),$("body").removeClass("pos-fixed"),t.removeClass("dropdown-active")}),"function"==typeof jQuery("#area-select").autocomplete&&(jQuery("#area-select").autocomplete({source:function(e,t){A.getAreasForCity(A.selectedlocation.query,function(e){formatted=[];for(var o=0;o<e.length;o++)e[o].display_name===e[o].pincode?e[o].label=e[o].display_name+" , "+A.selectedlocation.city.name:e[o].label=e[o].display_name+"-"+e[o].pincode+","+A.selectedlocation.city.name,formatted.push(e[o]);t(formatted)})},select:function(t,o){var n=angular.element(document.getElementById("headercontroller"));n.scope().vm.onSelect(o.item),e.$digest()},minLength:3}),jQuery("#city-select").autocomplete({source:M,select:function(t,o){var n=angular.element(document.getElementById("headercontroller"));n.scope().vm.onSelectCity(o.item),e.$digest(),$("#area-select").focus(),A.user.currentAddress.isdummy&&A.skipandexplore(o.item.id)},minLength:0}).focus(function(){"use strict";$("#city-select").val(""),$("#city-select").autocomplete("search",$("#city-select").val()),A.selectedlocation.query=""}))},A.openAutoSearch=function(){$("#city-select").autocomplete("search","")},$(".mask").click(function(){$("#city-select").autocomplete("close")}),$(document).on("firstBasketAdd",function(){a(function(){A.firstTimeUser=!0,A.dont_send_changemylocation_event=!0,A.locationChangeDropdown(),$(document).trigger("addressInteractionPlower",[{EventName:"AddToCart_AddressPopUp_Shown",Location:A.user.currentAddress.city_name+"|"+A.user.currentAddress.area,AdditionalInfo2:$.cookie("_bb_locSrc")}])},0)}),A.cancelFirstStaticPopup=function(){A.firstTimeUser=!1,$(".overlay-dropdown").fadeOut(),$("body").removeClass("pos-fixed"),$(".dropdown-menu1").hide(),$(".dropbtn").removeClass("dropdown-active"),$(".top-header").removeClass("locpops"),$(".middle-header").css("top","0px"),s.pushToGoogleAnalytics("_trackEvent","city-select","continue",A.user.currentAddress.city_name,1),$(document).trigger("addressInteractionPlower",[{EventName:"AddToCart_AddressPopUp_Continue_Clicked",Location:A.user.currentAddress.city_name+"|"+A.user.currentAddress.area,AdditionalInfo2:$.cookie("_bb_locSrc")}])},A.locationChangeDropdown=function(t){A.cityMessage=!1,$.cookie("_bb_ftvid")&&$.removeCookie("_bb_ftvid",{path:"/",domain:window.location.host.replace("www","")}),t&&$.cookie("_bb_locSrc")&&$.removeCookie("_bb_locSrc",{path:"/",domain:window.location.host.replace("www","")}),$("#city-select").val(A.user.currentAddress.city_name),A.selectedlocation.query="";var o=$(".dropbtn");$(".user-btn").removeClass("dropdown-active"),$(".dropdown-menu1").show(),o.addClass("dropdown-active"),$(".overlay-dropdown").fadeIn(),$("body").addClass("pos-fixed"),1==$("button.dropbtn.xhrcalls-only").hasClass("dropdown-active")&&A.user.is_member&&A.user.other_address&&A.getslotsforaddress(A.user.other_address),A.user.currentAddress.isdummy||$(".overlay-dropdown").click(function(){$(this).fadeOut(),$("body").removeClass("pos-fixed"),$(".dropdown-menu1").hide(),o.removeClass("dropdown-active"),$(".top-header").removeClass("locpops"),$(".middle-header").css("top","0px"),A.showError=!1,s.pushToGoogleAnalytics("_trackEvent","city-select","continue",A.user.currentAddress.city_name,1)}),"function"==typeof jQuery("#area-select").autocomplete&&(jQuery("#area-select").autocomplete({source:function(e,t){A.getAreasForCity(A.selectedlocation.query,function(e){formatted=[];for(var o=0;o<e.length;o++)e[o].display_name===e[o].pincode?e[o].label=e[o].display_name+" , "+A.selectedlocation.city.name:e[o].label=e[o].display_name+"-"+e[o].pincode+","+A.selectedlocation.city.name,formatted.push(e[o]);t(formatted)})},select:function(t,o){var n=angular.element(document.getElementById("headercontroller"));n.scope().vm.onSelect(o.item),e.$digest()},minLength:3}),jQuery("#city-select").autocomplete({source:M,select:function(t,o){var n=angular.element(document.getElementById("headercontroller"));n.scope().vm.onSelectCity(o.item),e.$digest(),$("#area-select").focus()},minLength:0}).focus(function(){"use strict";$("#city-select").val(""),$("#city-select").autocomplete("search",$("#city-select").val()),A.selectedlocation.query=""})),$(".overlay-dropdown").click(function(){$("#city-select").autocomplete("close")}),A.dont_send_changemylocation_event||$(document).trigger("addressInteractionPlower",[{EventName:"ChangeMyLocation_Shown",Location:A.user.currentAddress.city_name+"|"+A.user.currentAddress.address_display_name}]),A.dont_send_changemylocation_event=!1},A.cityMessageClose=function(){A.cityMessage=!1,$.removeCookie("_bb_ftvid",{path:"/",domain:window.location.host.replace("www","")})},A.loginClick=function(){window.location="/",localStorage.setItem("newLogin",!0),localStorage.setItem("next",window.location.pathname+window.location.search)},t.$on("FirstTimeUser",function(){A.firstTimeUser=!0,A.dont_send_changemylocation_event=!0,A.locdropdown(),$(document).trigger("addressInteractionPlower",[{EventName:"AddToCart_AddressPopUp_Shown",Location:A.user.currentAddress.city_name+"|"+A.user.currentAddress.area,AdditionalInfo2:$.cookie("_bb_locSrc")}])}),A.cancelFirstPopup=function(){A.firstTimeUser=!1,$("#city-drop-overlay").fadeToggle(),$("body").removeClass("toggle-scroll"),$(".new-to-bb").removeClass("drop-z-index"),$(".dropdown.new-to-bb").removeClass("open"),$(".top-header").removeClass("locpops"),$(".bb-brand-section").css("top","0px"),s.pushToGoogleAnalytics("_trackEvent","city-select","continue",A.user.currentAddress.city_name,1),A.user.is_member?A.user.currentAddress.is_partial&&$(document).trigger("addressInteractionPlower",[{EventName:"Login_PartialAddressPopUp_Continue_Clicked",Location:A.user.currentAddress.city_name+"|"+A.user.currentAddress.area,AdditionalInfo2:$.cookie("_bb_locSrc")}]):$(document).trigger("addressInteractionPlower",[{EventName:"AddToCart_AddressPopUp_Continue_Clicked",Location:A.user.currentAddress.city_name+"|"+A.user.currentAddress.area,AdditionalInfo2:$.cookie("_bb_locSrc")}])},A.changeFirstPopup=function(){A.firstTimeUser=!A.firstTimeUser,$(document).trigger("addressInteractionPlower",[{EventName:"AddToCart_AddressPopUp_ChangeCity_Clicked",Location:A.user.currentAddress.city_name+"|"+A.user.currentAddress.area,AdditionalInfo2:$.cookie("_bb_locSrc")}])},A.locdropdown=function(e){A.cityMessage=!1,$.cookie("_bb_ftvid")&&$.removeCookie("_bb_ftvid",{path:"/",domain:window.location.host.replace("www","")}),e&&$.cookie("_bb_locSrc")&&$.removeCookie("_bb_locSrc",{path:"/",domain:window.location.host.replace("www","")}),$("#city-drop-overlay").fadeToggle(),$("body").toggleClass("toggle-scroll"),$(".new-to-bb").toggleClass("drop-z-index"),$(".dropdown.new-to-bb").toggleClass("open"),1==$(".dropdown.new-to-bb.xhrcalls-only").hasClass("open")&&A.user.is_member&&A.user.other_address&&A.getslotsforaddress(A.user.other_address),A.user.currentAddress.isdummy||$("#city-drop-overlay").click(function(){$("#city-drop-overlay").fadeOut("slow"),$("body").removeClass("toggle-scroll"),$(".new-to-bb").removeClass("drop-z-index"),$(".dropdown.new-to-bb").removeClass("open"),$(".top-header").removeClass("locpops"),$(".bb-brand-section").css("top","0px"),A.showError=!1,A.firstTimeUser=!1,s.pushToGoogleAnalytics("_trackEvent","city-select","continue",A.user.currentAddress.city_name,1)}),A.selectedlocation.cityquery=A.address_city_name,A.selectedlocation.city.name=A.address_city_name,A.selectedlocation.city.id=A.address_city_id,A.selectedlocation.query="",A.dont_send_changemylocation_event||(A.user.is_member&&A.user.currentAddress.is_partial?$(document).trigger("addressInteractionPlower",[{EventName:"Login_PartialAddressPopUp_Shown",Location:A.user.currentAddress.city_name+"|"+A.user.currentAddress.area,AdditionalInfo2:$.cookie("_bb_locSrc")}]):$(document).trigger("addressInteractionPlower",[{EventName:"ChangeMyLocation_Shown",Location:A.address_city_name+"|"+A.user.currentAddress.address_display_name}])),A.dont_send_changemylocation_event=!1},A.locdropclose=function(){$("#city-drop-overlay").fadeOut(),$("body").removeClass("toggle-scroll"),$(".new-to-bb").removeClass("drop-z-index"),$(".dropdown.new-to-bb").removeClass("open")},A.loginClicked=function(e){localStorage.setItem("nexUrl",window.location.pathname),data=e.currentTarget.getAttribute("data-logininteraction"),$(document).trigger("loginInteractions",[data])},A.handleLogin=function(){A.changeFirstPopup(),document.getElementById("city-drop-overlay").click(),A.openLoginAndSignupModal("login")},A.is_ie=function(){for(var e,t=3,o=document.createElement("div"),n=o.getElementsByTagName("i");o.innerHTML="<!--[if gt IE "+ ++t+"]><i></i><![endif]-->",n[0];);return t>4?t:e},A.openLoginAndSignupModal=function(t,o){A.is_ie()<10&&(window.location.href="/auth/"+t+"/?next="+o),o=location.href;var n=c.open({templateUrl:"app/templates/innertemplates/loginAndSignupBaseTemplate.html",scope:e,controller:"loginAndSignupBase",controllerAs:"loginAndSignupBase",windowClass:"signup-modal",resolve:{modalData:function(){return{tab:t,next:o||"/",pageContext:"nb"}}},backdrop:"static",keyboard:!1});n.result.then(function(e){},function(){})},window.openLoginModal=A.openLoginAndSignupModal,A.logout=function(){window.FB&&window.FB.logout(function(e){console.log(e)}),r.location.href="/auth/logout/?nc=md&page=custom",sessionStorage.clear()},A.closeOrderAssistant=function(){A.showOrderAssistant=!1,sessionStorage.setItem("orderAssistant","hide")},y()}angular.module("app.layout").controller("Header",e),e.$inject=["$scope","$rootScope","HeaderDataservice","UserDataservice","toastr","$window","$timeout","GAService","$uibModal","$cookies"]}(),function(){function e(e,t,o){function n(e){return("https:"==window.location.protocol?"/auth":"")+e}function i(t,o,n){"use strict";function i(e){return e.data}return e.get("/productservice/autocomplete/?term="+encodeURIComponent(t)+"&city_id="+o+"&_="+n).then(i)}function r(){function t(e){"use strict";return h=e.data.shops,h.express_closed=e.data.express_closed,e.data}return o.remove_cache?e.get(n("/get_page_data/?cai="+o.CURRENT_ADDRESS_ID),{headers:{"Cache-Control":"no-cache"}}).then(t):e.get(n("/get_page_data/?cai="+o.CURRENT_ADDRESS_ID)).then(t)}function a(){var t={notification_type:"bbstar_expiry",member_id:$.cookie("_bb_mid"),button_operation:"cancel",additional_data:{}};return e({url:"/mapi/v3.5.1/notification-response/",method:"POST",data:t}).then(function(e){return e.data},function(e){return e})}function s(){function t(e){"use strict";return e.data}var i="/get_menu/?",r=document.getElementById("city_id");return i+=r&&r.value?"city_id="+Number(r.value):"cai="+o.CURRENT_ADDRESS_ID,e.get(n(i)).then(t)}function c(){return t(function(e,t){e(h)})}function l(){function e(){f=!0}return m?m:m=t.when(!0).then(e)}function d(e){var o=m||l();return o.then(function(){return t.all(e)})["catch"](function(e){})}function u(t){"use strict";function o(e){var t=[];if(e.data.sub_cats){angular.forEach(e.data.sub_cats,function(e){var o=[];angular.forEach(e,function(e){var t={name:e.sub_category[0],slug:e.sub_category[1],url:e.sub_category[2]};if(t.search_term=e.search_term,e.l2_banner){var n={};n.type=e.l2_banner.type,angular.forEach(e.l2_banner.banners,function(e){n[e.display_name]=e}),t.banner=n}t.options=null,e.cats&&e.cats.length>0&&(t.options=[],angular.forEach(e.cats,function(e){var o={name:e.cat[0],slug:e.cat[1],url:e.cat[2]};t.options.push(o)})),o.push(t)}),o&&t.push(o)})}return t}return e.get(n("/get_sub_cat_menu/?category_id="+t)).then(o)}function p(t,o,i){function r(e){return e.data.response.results}return i?e.get("/bbplacessearch/getplaces/?term="+o+"&city_id="+t).then(r):e.get(n("/bb/get_area/?term="+o+"&city_id="+t)).then(r)}function g(e){return t.all(e).then(function(e){return!0})}var m,f=!1,h=null,_={getPageInfo:r,getLeftMenu:s,getShops:c,searchProducts:i,ready:d,getSubcategory:u,getAreasForCity:p,getRequestQueue:g,bbstarAutoRenewalPopupViewed:a};return _}angular.module("app.layout").factory("HeaderDataservice",e),e.$inject=["$http","$q","$window"],angular.module("app.layout").service("loginAndSignupService",["$http","$q",function(e,t){var o=function(e){var t="";return Object.keys(e).forEach(function(o){t+=o+"="+window.encodeURIComponent(e[o])+"&"}),t.slice(0,-1);
};this.submitForm=function(n,i,r){var a={method:"POST",url:i,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:window.location.pathname.includes("bbstar")?n:o(n)},s=t.defer();return r&&(r.bbLoader=!0),e(a).then(function(e){r&&(r.bbLoader=!1),s.resolve(e)},function(e){r&&(r.bbLoader=!1),s.reject(e)}),s.promise},this.postHulk=function(e,t){return new window.Promise(function(o,n){fetch(e,{method:"post",body:JSON.stringify(t),credentials:"same-origin",headers:{Accept:"application/json","Content-Type":"application/json","X-CSRFToken":$.cookie("csrftoken"),"X-Channel":"BB-WEB","X-Caller":"DVAR-SVC"}}).then(function(e){if(200===e.status||400===e.status)e.json().then(function(e){e.success=!0,o(e)});else{if(404===e.status)return"404 not found";n(500==e.status?e:e)}},function(e){n(e),console.log(e)})})},this.getRequest=function(o,n,i){var r={method:"GET",url:o,params:n},a=t.defer();return i&&(i.bbLoader=!0),e(r).then(function(e){i&&(i.bbLoader=!1),a.resolve(e)},function(e){i&&(i.bbLoader=!1),a.reject(e)}),a.promise},this.fb_login=function(e,t){void 0!=window.gtag&&gtag("event","Login Action",{method:"Facebook"});var o="/auth/fb/login/?sl="+e;t&&"string"==typeof t&&(o+="&ref_code="+encodeURIComponent(t)),location.href=o},this.gplus_login=function(e,t){void 0!=window.gtag&&gtag("event","Login Action",{method:"Google"});var o="/auth/gplus/login/?sl="+e;t&&"string"==typeof t&&(o+="&ref_code="+encodeURIComponent(t)),location.href=o},this.get_captcha_url=function(){return e.get("/captcha/get_new_captcha/").then(function(e){return e})}}])}(),function(){"use strict";function e(e,t,o,n,i,r,a){function s(e){location.href="/auth/fb/login/?sl="+e}function c(e){location.href="/auth/gplus/login/?sl="+e}function l(){return t.ismember}function d(){P.memberinfo=o.getmembername()}function u(e,t){return Number(e)>=1e3?e:Number(t)+Number(e)}function p(e){o.deleteFromBasket(e.pid,e.quantity,t.sid).then(function(o){if(o.success){var n=R.findIndex(R.propEq("product_id",e.product_id))(P.cart.items);P.cart.items.splice(n,1),$("#totalNumberOfCartItems").html(o.num_items+" items"),$("#mobiletotalNumberOfCartItems").html(o.num_items),t.$broadcast("CART_ITEM_CHANGED",{sku:e.pid,qty:0}),_(e.pid,0),v(e.pid,o.basket_widget),typeof updateEngagementStore==typeof Function?updateEngagementStore(e.pid,0):"";var i=Number(e.mrp)+Number(e.saving);$(document).trigger("basketInteractionsPlowerWithAngular",[{EventName:"Basket_Remove",SkuID:e.pid,Quantity:e.quantity,UnitMrp:i,UnitSalePrice:Number(e.mrp),ScreenInPageContext:"basket"}]),P.getCartDetails()}});var n=document.getElementById("sku_to_update");n&&(n.value=e.pid,n.click())}function g(){P.showbb||(P.showbb=!0,P.timer=n(function(){P.basketDrop=!0,P.getCartDetails(),0!=P.cart.cart_no_items&&P.sendDataToGTM(P.cart)},500))}function m(){P.showbb&&(P.showbb=!1,n.cancel(P.timer),P.basketDrop=!1)}function f(e){$.isNumeric(e.quantity)&&(e.quantity>0&&e.quantity<25?o.updateCartQuantity(e.pid,Number(e.quantity),t.sid).then(function(o){o.success&&(e.quantity=o.ana_md.qty,t.$broadcast("CART_ITEM_CHANGED",{sku:e.pid,qty:e.quantity}),_(e.pid,e.quantity),typeof updateEngagementStore==typeof Function?updateEngagementStore(e.pid,0):"")}):0===Number(e.quantity)&&p(e))}function h(e){if(Number(e.quantity)>1){var n=Number(e.quantity)-1;o.updateCartQuantity(e.pid,n,t.sid).then(function(o){if(o.success){e.quantity=o.ana_md.qty,t.$broadcast("CART_ITEM_CHANGED",{sku:e.pid,qty:n}),_(e.pid,n),typeof updateEngagementStore==typeof Function?updateEngagementStore(e.pid,0):"";var i=Number(e.mrp)+Number(o.p_saving)/o.ana_md.qty;$(document).trigger("basketInteractionsPlowerWithAngular",[{EventName:"Basket_Decrement",SkuID:e.pid,Quantity:1,UnitMrp:i,UnitSalePrice:Number(e.mrp),ScreenInPageContext:"basket"}]),P.getCartDetails()}})}else p(e)}function _(e,t){"/basket/&nc=basket"===window.location.pathname?($("#p_"+e).val(t),refresh()):$("#p_"+e).val(t+" in basket"),$("#p"+e+"_cart").val(t)}function v(e,t){init_page_data(),init_basket(),$("li[name='widget_"+e+"'] .uiv2-add-to-basket").html(t),init_a2c_for_selector('li[name="widget_'+e+'"] .a2c'),$('li[name="widget_'+e+'"].uiv2-selected-product').length>=1&&$('li[name="widget_'+e+'"]').removeClass("uiv2-selected-product");var o=$("#a2c-pd-"+e).val();1==o&&$('li[name="widget_'+e+'"]').removeClass("uiv2-selected-product")}function b(e){if(Number(e.quantity)<25){var n=Number(e.quantity)+1;o.updateCartQuantity(e.pid,n,t.sid).then(function(o){if(o.success){e.quantity=o.ana_md.qty,t.$broadcast("CART_ITEM_CHANGED",{sku:e.pid,qty:n}),_(e.pid,n),typeof updateEngagementStore==typeof Function?updateEngagementStore(e.pid,0):"",P.getCartDetails();var i=Number(e.mrp)+Number(o.p_saving)/o.ana_md.qty;$(document).trigger("basketInteractionsPlowerWithAngular",[{EventName:"Basket_Increment",SkuID:e.pid,Quantity:1,UnitMrp:i,UnitSalePrice:Number(e.mrp),ScreenInPageContext:"basket"}])}})}}function y(){for(var e,t=3,o=document.createElement("div"),n=o.getElementsByTagName("i");o.innerHTML="<!--[if gt IE "+ ++t+"]><i></i><![endif]-->",n[0];);return t>4?t:e}function w(t){var o="True"==window.ISB2B;if($(document).trigger("screenViewReferralsEvent",[{}]),t>0)if(localStorage.setItem("nexUrl","/basket/?ver=1"),"hpcp"===PAGE_TYPE&&!a.get("_bb_mid")&&"function"==typeof r.open&&window.NEW_LOGIN_FLOW){if(void 0!==is_returning_user&&is_returning_user)var n="login";else var n="signup";if(o&&"signup"==n)return void(location.href="/signup/");P.is_ie()<10&&(window.location.href="/auth/"+n+"/?next=/basket/?ver=1");var i=r.open({templateUrl:"app/templates/innertemplates/loginAndSignupBaseTemplate.html",scope:e,controller:"loginAndSignupBase",controllerAs:"loginAndSignupBase",resolve:{modalData:function(){return{tab:n,pageContext:"basket",next:"/basket/?ver=1"}}},backdrop:"static",windowClass:"signup-modal",keyboard:!1});i.result.then(function(e){},function(){})}else location.href="/basket/?ver=1"}function S(e){if(e.items){for(var t=e.items,o=[],n=0;n<t.length;n++)o.push({id:t[n].pid,price:t[n].mrp,quantity:t[n].quantity});dataLayer.push({view_basket_details:o}),dataLayer.push({event:"view_basket_mouse_hover"})}}function k(){return o.getCart().then(function(e){P.cart=e,null!=P.cart.basket_banner&&(P.cart.basket_banner["Image name"]=MEDIA_URL+P.cart.basket_banner["Image name"]),Number(e.cart_total)>=Number(e.delivery_limit)?P.cart.free_delivery=!0:P.cart.free_delivery=!1,$("#totalNumberOfCartItems").html(P.cart.cart_no_items+" items"),$("#mobiletotalNumberOfCartItems").html(P.cart.cart_no_items)})}function T(){void 0!=PAGE_TYPE&&"hpcp"===PAGE_TYPE}var P=this;P.cart={},P.cart.cart_no_items=i.CART,P.updateCartQuantity=f,P.goToBasketPage=w,P.is_ie=y,P.deleteFromBasket=p,P.decreamentQuantity=h,P.increamentQuantity=b,P.updateOldPage=_,P.updateTheOldWidget=v,P.isMember=l,P.getMemberinfo=d,P.grandTotal=u,P.USED_STATIC_URL=USED_STATIC_URL,P.fb_login=s,P.gplus_login=c,t.cart=P.cart,P.getCartDetails=k,P.sendDataToGTM=S,P.showBasket=g,P.hideBasket=m,P.basketDrop=!1,P.timer={},T(),t.$on("getCart",function(e,t){P.getCartDetails()})}function t(){return{restrict:"E",templateUrl:"app/templates/innertemplates/bigbasketCartTemplate.html",scope:{},controller:["$scope","$rootScope","UserDataservice","$timeout","$window","$uibModal","$cookies",e],controllerAs:"vm"}}function o(){function e(e,t,o){}return{restrict:"E",templateUrl:"app/templates/innertemplates/searchProductsTemplate.html",link:e}}function n(e){function t(e,t,o){}return{restrict:"E",templateUrl:"app/templates/innertemplates/megaNav.html",link:t}}function i(e){function t(e,t,o){}return{restrict:"E",templateUrl:"app/templates/innertemplates/megaNavSticky.html",link:t}}function r(e){function t(e,t,o){}return{restrict:"E",templateUrl:"app/templates/innertemplates/DesktopLeftMenuL2template.html",link:t}}n.$inject=["$timeout"],i.$inject=["$timeout"],e.$inject=["$scope","$rootScope","UserDataservice","$timeout","$window","$uibModal","$cookies"],angular.module("app.layout").directive("megaNavTemplate",n).directive("megaNavStickyTemplate",i).directive("leftSubcategoryTemplate",r).directive("searchProductsTemplate",o).directive("bigbasketCartTemplate",t);var a=e;a.$inject=["$scope","$rootScope","UserDataservice","$timeout","$window","$uibModal","$cookies"],angular.module("app.layout").controller("oldPageCompatibilityCartController",a),r.$inject=["$timeout"],angular.module("app.layout").filter("ToInt",["$filter",function(e){return function(e){return e?(e=parseFloat(e),e=e.toFixed(e%1===0?0:2),""+e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,"")):"0"}}])}(),function(e){"use strict";e(".nav-pills > li ").hover(function(){e(this).hasClass("hoverblock")||e(this).find("a").tab("show")}),e(".nav-tabs > li").find("a").click(function(){e(this).parent().siblings().addClass("hoverblock")}),jQuery(document).ready(function(e){var t=e("#navbar-main"),o=e(window);e("#left-menu-overlay").click(function(){e("#left-menu-overlay").fadeOut("slow"),e("body").removeClass("toggle-scroll"),e(".new-to-bb").removeClass("drop-z-index")}),e(window).on("resize",function(){if(window.innerWidth<=991){e("#navbar-main").addClass("navbar-fixed-top"),e(".body-wrap").css("padding-top","70px");var n=document.getElementById("order-assistant");if(n){var i=n.clientHeight;e(n).addClass("fixed"),t[0].style.top=i+"px"}}else e(".body-wrap").css("padding-top","0px"),t.removeClass("navbar-fixed-top"),e(".search-bar input").attr("placeholder","Search for Products.."),o.scroll(function(){var n=document.getElementById("order-assistant");if(o.scrollTop()>=30){if(t.addClass("navbar-fixed-top"),e("body").css("padding-top","45px"),e(".bb-logo").removeClass("change-logo"),e(".bb-logo").addClass("icon"),n){var i=n.clientHeight;e(n).addClass("fixed"),t[0].style.top=i+"px"}}else t.removeClass("navbar-fixed-top"),e("body").css("padding-top","0px"),e(".bb-logo").addClass("change-logo"),e(".bb-logo").removeClass("icon"),n&&(t[0].style.top="0",e(n).removeClass("fixed"))})}).trigger("resize")}),e("#mega-desktop-navigation .dropdown").hover(function(){e(this).addClass("open")},function(){e(this).removeClass("open")}),e("div.panel-collapse").on("show.bs.collapse",function(){e(this).parent("div").find(".fa-chevron-right").removeClass("fa fa-chevron-right").addClass("fa fa-chevron-down")}),e("div.panel-collapse").on("hide.bs.collapse",function(){e(this).parent("div").find(".fa-chevron-down").removeClass("fa fa-chevron-down").addClass("fa fa-chevron-right")}),e(".submenu").on("click",function(){e(this).find("ul").slideToggle(),e(this).find("i").toggleClass("fa-plus fa-minus")})}($),$(document).ready(function(){$(".skip").on("click",function(){$(".error_loc_msg").hide()}),$(".register-options").on("click",function(){$(".visible-div").hide(),$(".hidden-div").show()}),$(".citychange").on("click",function(){$(".visible-div").show(),$(".hidden-div").hide(),$(".error_loc_msg").hide()}),$("div.panel-collapse").on("show.bs.collapse",function(){$(this).parent("div").find(".fa-chevron-right").removeClass("fa fa-chevron-right").addClass("fa fa-chevron-down")}),$("div.panel-collapse").on("hide.bs.collapse",function(){$(this).parent("div").find(".fa-chevron-down").removeClass("fa fa-chevron-down").addClass("fa fa-chevron-right")})}),$(function(){$('[data-toggle="tooltip"]').tooltip()}),$(document.body).on("click",".dropdown-menu.drop-select li a",function(e){var t=$(e.currentTarget);return t.closest(".btn-group").find('[data-bind="label"]').text(t.text()).end().children(".dropdown-toggle").dropdown("toggle"),!1}),$(document).ready(function(){$(".po-markup > .po-link-addr").popover({trigger:"hover",html:!0,title:function(){return $(this).parent().find(".po-title").html()},content:function(){return $(this).parent().find(".po-body").html()},container:"body",placement:"bottom"}),$("div.create-list").on("click.bs.dropdown",function(e){var t=$(e.target),o=t.is(".is_a");t.hasClass("dropdown-toggle")&&($("ul.dropdown-menu",this).toggle(!o),t.toggleClass("is_a",!o))}).on("mouseleave",function(){$("ul.dropdown-menu",this).hide(),$(".is_a",this).removeClass("is_a"),$(".show-list").hide()})}),$(function(){$(".button-checkbox").each(function(){function e(){var e=i.is(":checked");n.data("state",e?"on":"off"),n.find(".state-icon").removeClass().addClass("state-icon "+a[n.data("state")].icon),e?n.removeClass("btn-default").addClass("btn-"+r+" active"):n.removeClass("btn-"+r+" active").addClass("btn-default")}function t(){e(),0==n.find(".state-icon").length&&n.prepend('<i class="state-icon '+a[n.data("state")].icon+'"></i> ')}var o=$(this),n=o.find("button"),i=o.find("input:checkbox"),r=n.data("color"),a={on:{icon:"fa fa-check"},off:{icon:"fa fa-unchecked"}};n.on("click",function(){i.prop("checked",!i.is(":checked")),i.triggerHandler("change"),e()}),i.on("change",function(){e()}),t()})}),$("#fileUpload").on("change",function(){var e=$(this)[0].files.length,t=$(this)[0].value,o=t.substring(t.lastIndexOf(".")+1).toLowerCase(),n=$(".col-wrap");if(n.empty(),"gif"==o||"png"==o||"jpg"==o||"jpeg"==o)if("undefined"!=typeof FileReader)for(var i=0;i<e;i++){var r=new FileReader;r.onload=function(t){4==e||5==e?$(n).append('<li style="flex-basis:calc(100% / 4)"><img class="img-responsive" src="'+t.target.result+'"></li> '):e>=6?$(n).append('<li style="flex-basis:calc(100% / 6)"><img class="img-responsive" src="'+t.target.result+'"></li> '):alert("Please select minimum 4 images")},n.show(),r.readAsDataURL($(this)[0].files[i])}else alert("This browser does not support FileReader.");else alert("Pls select only images")}),$(document).ready(function(){$("#toTop").css("display","none"),$(window).scroll(function(){$(window).scrollTop()>200?$("#toTop").fadeIn("slow"):$("#toTop").fadeOut("slow")}),$("#toTop").click(function(){event.preventDefault(),$("html, body").animate({scrollTop:0},"slow")})}),$(".onscroll-dropdown").hover(function(){$(this).find(".dropdown-menu").stop(!0,!0).show()},function(){$(this).find(".dropdown-menu").stop(!0,!0).hide()});var BasketUrlBuilder=function(){var e=make_req_url("/basket/add/"),t=make_req_url("/basket/del-item/"),o=make_req_url("/basket/qty-update/"),n=make_req_url(""),i=make_req_url("/basket/empty-basket/"),r=make_req_url("/msl/add-list-item-to-basket/");return{withNodeCartUrl:function(){return e="/basketService/add/",t="/basketService/del-item/",o="/basketService/update-qty/",n="",i="/basketService/empty-cart/",r="/basketService/msl/add-list-item-to-basket/",this},build:function(){return{addToCartUrl:e,delItemUrl:t,updateQtyUrl:o,getCartUrl:n,emptyCartUrl:i,addListCartUrl:r}}}};if("undefined"==typeof jQuery){var headTag=document.getElementsByTagName("head")[0],jqTag=document.createElement("script");jqTag.type="text/javascript",jqTag.src="https://www.adjetter.com/static/assets/global/plugins/jquery.min.js",jqTag.onload=initializeKapture,headTag.appendChild(jqTag)}else initializeKaptureSupport();$(document).ready(function(){var e=window.location.pathname,t=localStorage.getItem("newLogin"),o=window.location.href.indexOf("branch_match_id")>-1,n=window.location.search.indexOf("authModal")>-1,i=e.indexOf("/auth/login/")>-1,r=e.indexOf("/auth/signup/")>-1,a=get_cookie("_bb_mid"),s=decodeURIComponent(window.location.search.split("next=")[1]);if(t||n||i||r){if(""!==window.location.search){var s=decodeURIComponent(window.location.search.split("next=")[1]);localStorage.setItem("newLogin",s)}if(window.location.search.indexOf("authModal")>-1){var c=window.location.pathname;window.history.replaceState({},document.title,c)}window.openLoginModal()}else!o||i||r||setTimeout(function(){a?document.getElementById("kapchat-widget-btn").click():window.openLoginModal()},1e3)}),function(e){function t(t){var o=e(this),n=null,i=[],r=null,a=null,s=e.extend({rowSelector:"> li",submenuSelector:"*",submenuDirection:"right",tolerance:75,enter:e.noop,exit:e.noop,activate:e.noop,deactivate:e.noop,exitMenu:e.noop},t),c=3,l=300,d=function(e){i.push({x:e.pageX,y:e.pageY}),i.length>c&&i.shift()},u=function(){a&&clearTimeout(a),s.exitMenu(this)&&(n&&s.deactivate(n),n=null)},p=function(){a&&clearTimeout(a),s.enter(this),h(this)},g=function(){s.exit(this)},m=function(){f(this)},f=function(e){e!=n&&(n&&s.deactivate(n),s.activate(e),n=e)},h=function(e){var t=_();t?a=setTimeout(function(){h(e)},t):f(e)},_=function(){function t(e,t){return(t.y-e.y)/(t.x-e.x)}if(!n||!e(n).is(s.submenuSelector))return 0;var a=o.offset(),c={x:a.left,y:a.top-s.tolerance},d={x:a.left+o.outerWidth(),y:c.y},u={x:a.left,y:a.top+o.outerHeight()+s.tolerance},p={x:a.left+o.outerWidth(),y:u.y},g=i[i.length-1],m=i[0];if(!g)return 0;if(m||(m=g),m.x<a.left||m.x>p.x||m.y<a.top||m.y>p.y)return 0;if(r&&g.x==r.x&&g.y==r.y)return 0;var f=d,h=p;"left"==s.submenuDirection?(f=u,h=c):"below"==s.submenuDirection?(f=p,h=u):"above"==s.submenuDirection&&(f=c,h=d);var _=t(g,f),v=t(g,h),b=t(m,f),y=t(m,h);return _<b&&v>y?(r=g,l):(r=null,0)};o.mouseleave(u).find(s.rowSelector).mouseenter(p).mouseleave(g).click(m),e(document).mousemove(d)}e.fn.menuAim=function(e){return this.each(function(){t.call(this,e)}),this}}(jQuery),!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=e(require("jquery")):e(jQuery)}(function(e){e.extend(e.fn,{validate:function(t){if(!this.length)return void(t&&t.debug&&window.console&&console.warn("Nothing selected, can't validate, returning nothing."));var o=e.data(this[0],"validator");return o?o:(this.attr("novalidate","novalidate"),o=new e.validator(t,this[0]),e.data(this[0],"validator",o),o.settings.onsubmit&&(this.on("click.validate",":submit",function(t){o.settings.submitHandler&&(o.submitButton=t.target),e(this).hasClass("cancel")&&(o.cancelSubmit=!0),void 0!==e(this).attr("formnovalidate")&&(o.cancelSubmit=!0)}),this.on("submit.validate",function(t){function n(){var n,i;return!o.settings.submitHandler||(o.submitButton&&(n=e("<input type='hidden'/>").attr("name",o.submitButton.name).val(e(o.submitButton).val()).appendTo(o.currentForm)),i=o.settings.submitHandler.call(o,o.currentForm,t),o.submitButton&&n.remove(),void 0!==i&&i)}return o.settings.debug&&t.preventDefault(),o.cancelSubmit?(o.cancelSubmit=!1,n()):o.form()?o.pendingRequest?(o.formSubmitted=!0,!1):n():(o.focusInvalid(),!1)})),o)},valid:function(){var t,o,n;return e(this[0]).is("form")?t=this.validate().form():(n=[],t=!0,o=e(this[0].form).validate(),this.each(function(){t=o.element(this)&&t,t||(n=n.concat(o.errorList))}),o.errorList=n),t},rules:function(t,o){var n,i,r,a,s,c,l=this[0];if(null!=l&&null!=l.form){if(t)switch(n=e.data(l.form,"validator").settings,i=n.rules,r=e.validator.staticRules(l),t){case"add":e.extend(r,e.validator.normalizeRule(o)),delete r.messages,i[l.name]=r,o.messages&&(n.messages[l.name]=e.extend(n.messages[l.name],o.messages));break;case"remove":return o?(c={},e.each(o.split(/\s/),function(t,o){c[o]=r[o],delete r[o],"required"===o&&e(l).removeAttr("aria-required")}),c):(delete i[l.name],r)}return a=e.validator.normalizeRules(e.extend({},e.validator.classRules(l),e.validator.attributeRules(l),e.validator.dataRules(l),e.validator.staticRules(l)),l),a.required&&(s=a.required,delete a.required,a=e.extend({required:s},a),e(l).attr("aria-required","true")),a.remote&&(s=a.remote,delete a.remote,a=e.extend(a,{remote:s})),a}}}),e.extend(e.expr.pseudos||e.expr[":"],{blank:function(t){return!e.trim(""+e(t).val())},filled:function(t){var o=e(t).val();return null!==o&&!!e.trim(""+o)},unchecked:function(t){return!e(t).prop("checked")}}),e.validator=function(t,o){this.settings=e.extend(!0,{},e.validator.defaults,t),this.currentForm=o,this.init()},e.validator.format=function(t,o){return 1===arguments.length?function(){var o=e.makeArray(arguments);return o.unshift(t),e.validator.format.apply(this,o)}:void 0===o?t:(arguments.length>2&&o.constructor!==Array&&(o=e.makeArray(arguments).slice(1)),o.constructor!==Array&&(o=[o]),e.each(o,function(e,o){t=t.replace(new RegExp("\\{"+e+"\\}","g"),function(){return o})}),t)},e.extend(e.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",pendingClass:"pending",validClass:"valid",errorElement:"label",focusCleanup:!1,focusInvalid:!0,errorContainer:e([]),errorLabelContainer:e([]),onsubmit:!0,ignore:":hidden",ignoreTitle:!1,onfocusin:function(e){this.lastActive=e,this.settings.focusCleanup&&(this.settings.unhighlight&&this.settings.unhighlight.call(this,e,this.settings.errorClass,this.settings.validClass),this.hideThese(this.errorsFor(e)))},onfocusout:function(e){this.checkable(e)||!(e.name in this.submitted)&&this.optional(e)||this.element(e)},onkeyup:function(t,o){var n=[16,17,18,20,35,36,37,38,39,40,45,144,225];9===o.which&&""===this.elementValue(t)||e.inArray(o.keyCode,n)!==-1||(t.name in this.submitted||t.name in this.invalid)&&this.element(t)},onclick:function(e){e.name in this.submitted?this.element(e):e.parentNode.name in this.submitted&&this.element(e.parentNode)},highlight:function(t,o,n){"radio"===t.type?this.findByName(t.name).addClass(o).removeClass(n):e(t).addClass(o).removeClass(n)},unhighlight:function(t,o,n){"radio"===t.type?this.findByName(t.name).removeClass(o).addClass(n):e(t).removeClass(o).addClass(n)}},setDefaults:function(t){e.extend(e.validator.defaults,t)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",equalTo:"Please enter the same value again.",maxlength:e.validator.format("Please enter no more than {0} characters."),minlength:e.validator.format("Please enter at least {0} characters."),rangelength:e.validator.format("Please enter a value between {0} and {1} characters long."),range:e.validator.format("Please enter a value between {0} and {1}."),max:e.validator.format("Please enter a value less than or equal to {0}."),min:e.validator.format("Please enter a value greater than or equal to {0}."),step:e.validator.format("Please enter a multiple of {0}.")},autoCreateRanges:!1,prototype:{init:function(){function t(t){!this.form&&this.hasAttribute("contenteditable")&&(this.form=e(this).closest("form")[0]);var o=e.data(this.form,"validator"),n="on"+t.type.replace(/^validate/,""),i=o.settings;i[n]&&!e(this).is(i.ignore)&&i[n].call(o,this,t)}this.labelContainer=e(this.settings.errorLabelContainer),this.errorContext=this.labelContainer.length&&this.labelContainer||e(this.currentForm),this.containers=e(this.settings.errorContainer).add(this.settings.errorLabelContainer),this.submitted={},this.valueCache={},this.pendingRequest=0,this.pending={},this.invalid={},this.reset();var o,n=this.groups={};e.each(this.settings.groups,function(t,o){"string"==typeof o&&(o=o.split(/\s/)),e.each(o,function(e,o){n[o]=t})}),o=this.settings.rules,e.each(o,function(t,n){o[t]=e.validator.normalizeRule(n)}),e(this.currentForm).on("focusin.validate focusout.validate keyup.validate",":text, [type='password'], [type='file'], select, textarea, [type='number'], [type='search'], [type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'], [type='radio'], [type='checkbox'], [contenteditable], [type='button']",t).on("click.validate","select, option, [type='radio'], [type='checkbox']",t),this.settings.invalidHandler&&e(this.currentForm).on("invalid-form.validate",this.settings.invalidHandler),e(this.currentForm).find("[required], [data-rule-required], .required").attr("aria-required","true")},form:function(){return this.checkForm(),e.extend(this.submitted,this.errorMap),this.invalid=e.extend({},this.errorMap),this.valid()||e(this.currentForm).triggerHandler("invalid-form",[this]),this.showErrors(),this.valid()},checkForm:function(){this.prepareForm();for(var e=0,t=this.currentElements=this.elements();t[e];e++)this.check(t[e]);return this.valid()},element:function(t){var o,n,i=this.clean(t),r=this.validationTargetFor(i),a=this,s=!0;return void 0===r?delete this.invalid[i.name]:(this.prepareElement(r),this.currentElements=e(r),n=this.groups[r.name],n&&e.each(this.groups,function(e,t){t===n&&e!==r.name&&(i=a.validationTargetFor(a.clean(a.findByName(e))),i&&i.name in a.invalid&&(a.currentElements.push(i),s=a.check(i)&&s))}),o=this.check(r)!==!1,s=s&&o,o?this.invalid[r.name]=!1:this.invalid[r.name]=!0,this.numberOfInvalids()||(this.toHide=this.toHide.add(this.containers)),this.showErrors(),e(t).attr("aria-invalid",!o)),s},showErrors:function(t){if(t){var o=this;e.extend(this.errorMap,t),this.errorList=e.map(this.errorMap,function(e,t){return{message:e,element:o.findByName(t)[0]}}),this.successList=e.grep(this.successList,function(e){return!(e.name in t)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){e.fn.resetForm&&e(this.currentForm).resetForm(),this.invalid={},this.submitted={},this.prepareForm(),this.hideErrors();var t=this.elements().removeData("previousValue").removeAttr("aria-invalid");this.resetElements(t)},resetElements:function(e){var t;if(this.settings.unhighlight)for(t=0;e[t];t++)this.settings.unhighlight.call(this,e[t],this.settings.errorClass,""),this.findByName(e[t].name).removeClass(this.settings.validClass);else e.removeClass(this.settings.errorClass).removeClass(this.settings.validClass)},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(e){var t,o=0;for(t in e)e[t]&&o++;return o},hideErrors:function(){this.hideThese(this.toHide)},hideThese:function(e){e.not(this.containers).text(""),this.addWrapper(e).hide()},valid:function(){return 0===this.size()},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{e(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(t){}},findLastActive:function(){var t=this.lastActive;return t&&1===e.grep(this.errorList,function(e){return e.element.name===t.name}).length&&t},elements:function(){var t=this,o={};return e(this.currentForm).find("input, select, textarea, [contenteditable]").not(":submit, :reset, :image, :disabled").not(this.settings.ignore).filter(function(){var n=this.name||e(this).attr("name");return!n&&t.settings.debug&&window.console&&console.error("%o has no name assigned",this),this.hasAttribute("contenteditable")&&(this.form=e(this).closest("form")[0]),!(n in o||!t.objectLength(e(this).rules())||(o[n]=!0,0))})},clean:function(t){return e(t)[0]},errors:function(){var t=this.settings.errorClass.split(" ").join(".");return e(this.settings.errorElement+"."+t,this.errorContext)},resetInternals:function(){this.successList=[],this.errorList=[],this.errorMap={},this.toShow=e([]),this.toHide=e([])},reset:function(){this.resetInternals(),this.currentElements=e([])},prepareForm:function(){this.reset(),this.toHide=this.errors().add(this.containers)},prepareElement:function(e){this.reset(),this.toHide=this.errorsFor(e)},elementValue:function(t){var o,n,i=e(t),r=t.type;return"radio"===r||"checkbox"===r?this.findByName(t.name).filter(":checked").val():"number"===r&&"undefined"!=typeof t.validity?t.validity.badInput?"NaN":i.val():(o=t.hasAttribute("contenteditable")?i.text():i.val(),"file"===r?"C:\\fakepath\\"===o.substr(0,12)?o.substr(12):(n=o.lastIndexOf("/"),n>=0?o.substr(n+1):(n=o.lastIndexOf("\\"),n>=0?o.substr(n+1):o)):"string"==typeof o?o.replace(/\r/g,""):o)},check:function(t){t=this.validationTargetFor(this.clean(t));var o,n,i,r=e(t).rules(),a=e.map(r,function(e,t){return t}).length,s=!1,c=this.elementValue(t);if("function"==typeof r.normalizer){if(c=r.normalizer.call(t,c),"string"!=typeof c)throw new TypeError("The normalizer should return a string value.");delete r.normalizer}for(n in r){i={method:n,parameters:r[n]};try{if(o=e.validator.methods[n].call(this,c,t,i.parameters),"dependency-mismatch"===o&&1===a){s=!0;continue}if(s=!1,"pending"===o)return void(this.toHide=this.toHide.not(this.errorsFor(t)));if(!o)return this.formatAndAdd(t,i),!1}catch(l){throw this.settings.debug&&window.console&&console.log("Exception occurred when checking element "+t.id+", check the '"+i.method+"' method.",l),l instanceof TypeError&&(l.message+=".  Exception occurred when checking element "+t.id+", check the '"+i.method+"' method."),l}}if(!s)return this.objectLength(r)&&this.successList.push(t),!0},customDataMessage:function(t,o){return e(t).data("msg"+o.charAt(0).toUpperCase()+o.substring(1).toLowerCase())||e(t).data("msg")},customMessage:function(e,t){var o=this.settings.messages[e];return o&&(o.constructor===String?o:o[t])},findDefined:function(){for(var e=0;e<arguments.length;e++)if(void 0!==arguments[e])return arguments[e]},defaultMessage:function(t,o){"string"==typeof o&&(o={method:o});var n=this.findDefined(this.customMessage(t.name,o.method),this.customDataMessage(t,o.method),!this.settings.ignoreTitle&&t.title||void 0,e.validator.messages[o.method],"<strong>Warning: No message defined for "+t.name+"</strong>"),i=/\$?\{(\d+)\}/g;return"function"==typeof n?n=n.call(this,o.parameters,t):i.test(n)&&(n=e.validator.format(n.replace(i,"{$1}"),o.parameters)),n},formatAndAdd:function(e,t){var o=this.defaultMessage(e,t);this.errorList.push({message:o,element:e,method:t.method}),this.errorMap[e.name]=o,this.submitted[e.name]=o},addWrapper:function(e){return this.settings.wrapper&&(e=e.add(e.parent(this.settings.wrapper))),e},defaultShowErrors:function(){var e,t,o;for(e=0;this.errorList[e];e++)o=this.errorList[e],this.settings.highlight&&this.settings.highlight.call(this,o.element,this.settings.errorClass,this.settings.validClass),this.showLabel(o.element,o.message);if(this.errorList.length&&(this.toShow=this.toShow.add(this.containers)),this.settings.success)for(e=0;this.successList[e];e++)this.showLabel(this.successList[e]);if(this.settings.unhighlight)for(e=0,t=this.validElements();t[e];e++)this.settings.unhighlight.call(this,t[e],this.settings.errorClass,this.settings.validClass);this.toHide=this.toHide.not(this.toShow),this.hideErrors(),this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return e(this.errorList).map(function(){return this.element})},showLabel:function(t,o){var n,i,r,a,s=this.errorsFor(t),c=this.idOrName(t),l=e(t).attr("aria-describedby");s.length?(s.removeClass(this.settings.validClass).addClass(this.settings.errorClass),s.html(o)):(s=e("<"+this.settings.errorElement+">").attr("id",c+"-error").addClass(this.settings.errorClass).html(o||""),n=s,this.settings.wrapper&&(n=s.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()),this.labelContainer.length?this.labelContainer.append(n):this.settings.errorPlacement?this.settings.errorPlacement.call(this,n,e(t)):n.insertAfter(t),s.is("label")?s.attr("for",c):0===s.parents("label[for='"+this.escapeCssMeta(c)+"']").length&&(r=s.attr("id"),l?l.match(new RegExp("\\b"+this.escapeCssMeta(r)+"\\b"))||(l+=" "+r):l=r,e(t).attr("aria-describedby",l),i=this.groups[t.name],i&&(a=this,e.each(a.groups,function(t,o){o===i&&e("[name='"+a.escapeCssMeta(t)+"']",a.currentForm).attr("aria-describedby",s.attr("id"))})))),!o&&this.settings.success&&(s.text(""),"string"==typeof this.settings.success?s.addClass(this.settings.success):this.settings.success(s,t)),this.toShow=this.toShow.add(s)},errorsFor:function(t){var o=this.escapeCssMeta(this.idOrName(t)),n=e(t).attr("aria-describedby"),i="label[for='"+o+"'], label[for='"+o+"'] *";return n&&(i=i+", #"+this.escapeCssMeta(n).replace(/\s+/g,", #")),this.errors().filter(i)},escapeCssMeta:function(e){return e.replace(/([\\!"#$%&'()*+,.\/:;<=>?@\[\]^`{|}~])/g,"\\$1")},idOrName:function(e){return this.groups[e.name]||(this.checkable(e)?e.name:e.id||e.name)},validationTargetFor:function(t){return this.checkable(t)&&(t=this.findByName(t.name)),e(t).not(this.settings.ignore)[0]},checkable:function(e){
return/radio|checkbox/i.test(e.type)},findByName:function(t){return e(this.currentForm).find("[name='"+this.escapeCssMeta(t)+"']")},getLength:function(t,o){switch(o.nodeName.toLowerCase()){case"select":return e("option:selected",o).length;case"input":if(this.checkable(o))return this.findByName(o.name).filter(":checked").length}return t.length},depend:function(e,t){return!this.dependTypes[typeof e]||this.dependTypes[typeof e](e,t)},dependTypes:{"boolean":function(e){return e},string:function(t,o){return!!e(t,o.form).length},"function":function(e,t){return e(t)}},optional:function(t){var o=this.elementValue(t);return!e.validator.methods.required.call(this,o,t)&&"dependency-mismatch"},startRequest:function(t){this.pending[t.name]||(this.pendingRequest++,e(t).addClass(this.settings.pendingClass),this.pending[t.name]=!0)},stopRequest:function(t,o){this.pendingRequest--,this.pendingRequest<0&&(this.pendingRequest=0),delete this.pending[t.name],e(t).removeClass(this.settings.pendingClass),o&&0===this.pendingRequest&&this.formSubmitted&&this.form()?(e(this.currentForm).submit(),this.formSubmitted=!1):!o&&0===this.pendingRequest&&this.formSubmitted&&(e(this.currentForm).triggerHandler("invalid-form",[this]),this.formSubmitted=!1)},previousValue:function(t,o){return o="string"==typeof o&&o||"remote",e.data(t,"previousValue")||e.data(t,"previousValue",{old:null,valid:!0,message:this.defaultMessage(t,{method:o})})},destroy:function(){this.resetForm(),e(this.currentForm).off(".validate").removeData("validator").find(".validate-equalTo-blur").off(".validate-equalTo").removeClass("validate-equalTo-blur")}},classRuleSettings:{required:{required:!0},email:{email:!0},url:{url:!0},date:{date:!0},dateISO:{dateISO:!0},number:{number:!0},digits:{digits:!0},creditcard:{creditcard:!0}},addClassRules:function(t,o){t.constructor===String?this.classRuleSettings[t]=o:e.extend(this.classRuleSettings,t)},classRules:function(t){var o={},n=e(t).attr("class");return n&&e.each(n.split(" "),function(){this in e.validator.classRuleSettings&&e.extend(o,e.validator.classRuleSettings[this])}),o},normalizeAttributeRule:function(e,t,o,n){/min|max|step/.test(o)&&(null===t||/number|range|text/.test(t))&&(n=Number(n),isNaN(n)&&(n=void 0)),n||0===n?e[o]=n:t===o&&"range"!==t&&(e[o]=!0)},attributeRules:function(t){var o,n,i={},r=e(t),a=t.getAttribute("type");for(o in e.validator.methods)"required"===o?(n=t.getAttribute(o),""===n&&(n=!0),n=!!n):n=r.attr(o),this.normalizeAttributeRule(i,a,o,n);return i.maxlength&&/-1|2147483647|524288/.test(i.maxlength)&&delete i.maxlength,i},dataRules:function(t){var o,n,i={},r=e(t),a=t.getAttribute("type");for(o in e.validator.methods)n=r.data("rule"+o.charAt(0).toUpperCase()+o.substring(1).toLowerCase()),this.normalizeAttributeRule(i,a,o,n);return i},staticRules:function(t){var o={},n=e.data(t.form,"validator");return n.settings.rules&&(o=e.validator.normalizeRule(n.settings.rules[t.name])||{}),o},normalizeRules:function(t,o){return e.each(t,function(n,i){if(i===!1)return void delete t[n];if(i.param||i.depends){var r=!0;switch(typeof i.depends){case"string":r=!!e(i.depends,o.form).length;break;case"function":r=i.depends.call(o,o)}r?t[n]=void 0===i.param||i.param:(e.data(o.form,"validator").resetElements(e(o)),delete t[n])}}),e.each(t,function(n,i){t[n]=e.isFunction(i)&&"normalizer"!==n?i(o):i}),e.each(["minlength","maxlength"],function(){t[this]&&(t[this]=Number(t[this]))}),e.each(["rangelength","range"],function(){var o;t[this]&&(e.isArray(t[this])?t[this]=[Number(t[this][0]),Number(t[this][1])]:"string"==typeof t[this]&&(o=t[this].replace(/[\[\]]/g,"").split(/[\s,]+/),t[this]=[Number(o[0]),Number(o[1])]))}),e.validator.autoCreateRanges&&(null!=t.min&&null!=t.max&&(t.range=[t.min,t.max],delete t.min,delete t.max),null!=t.minlength&&null!=t.maxlength&&(t.rangelength=[t.minlength,t.maxlength],delete t.minlength,delete t.maxlength)),t},normalizeRule:function(t){if("string"==typeof t){var o={};e.each(t.split(/\s/),function(){o[this]=!0}),t=o}return t},addMethod:function(t,o,n){e.validator.methods[t]=o,e.validator.messages[t]=void 0!==n?n:e.validator.messages[t],o.length<3&&e.validator.addClassRules(t,e.validator.normalizeRule(t))},methods:{required:function(t,o,n){if(!this.depend(n,o))return"dependency-mismatch";if("select"===o.nodeName.toLowerCase()){var i=e(o).val();return i&&i.length>0}return this.checkable(o)?this.getLength(t,o)>0:t.length>0},email:function(e,t){return this.optional(t)||/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(e)},url:function(e,t){return this.optional(t)||/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[\/?#]\S*)?$/i.test(e)},date:function(e,t){return this.optional(t)||!/Invalid|NaN/.test(new Date(e).toString())},dateISO:function(e,t){return this.optional(t)||/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/.test(e)},number:function(e,t){return this.optional(t)||/^(?:-?\d+|-?\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(e)},digits:function(e,t){return this.optional(t)||/^\d+$/.test(e)},minlength:function(t,o,n){var i=e.isArray(t)?t.length:this.getLength(t,o);return this.optional(o)||i>=n},maxlength:function(t,o,n){var i=e.isArray(t)?t.length:this.getLength(t,o);return this.optional(o)||i<=n},rangelength:function(t,o,n){var i=e.isArray(t)?t.length:this.getLength(t,o);return this.optional(o)||i>=n[0]&&i<=n[1]},min:function(e,t,o){return this.optional(t)||e>=o},max:function(e,t,o){return this.optional(t)||e<=o},range:function(e,t,o){return this.optional(t)||e>=o[0]&&e<=o[1]},step:function(t,o,n){var i,r=e(o).attr("type"),a="Step attribute on input type "+r+" is not supported.",s=["text","number","range"],c=new RegExp("\\b"+r+"\\b"),l=r&&!c.test(s.join()),d=function(e){var t=(""+e).match(/(?:\.(\d+))?$/);return t&&t[1]?t[1].length:0},u=function(e){return Math.round(e*Math.pow(10,i))},p=!0;if(l)throw new Error(a);return i=d(n),(d(t)>i||u(t)%u(n)!==0)&&(p=!1),this.optional(o)||p},equalTo:function(t,o,n){var i=e(n);return this.settings.onfocusout&&i.not(".validate-equalTo-blur").length&&i.addClass("validate-equalTo-blur").on("blur.validate-equalTo",function(){e(o).valid()}),t===i.val()},remote:function(t,o,n,i){if(this.optional(o))return"dependency-mismatch";i="string"==typeof i&&i||"remote";var r,a,s,c=this.previousValue(o,i);return this.settings.messages[o.name]||(this.settings.messages[o.name]={}),c.originalMessage=c.originalMessage||this.settings.messages[o.name][i],this.settings.messages[o.name][i]=c.message,n="string"==typeof n&&{url:n}||n,s=e.param(e.extend({data:t},n.data)),c.old===s?c.valid:(c.old=s,r=this,this.startRequest(o),a={},a[o.name]=t,e.ajax(e.extend(!0,{mode:"abort",port:"validate"+o.name,dataType:"json",data:a,context:r.currentForm,success:function(e){var n,a,s,l=e===!0||"true"===e;r.settings.messages[o.name][i]=c.originalMessage,l?(s=r.formSubmitted,r.resetInternals(),r.toHide=r.errorsFor(o),r.formSubmitted=s,r.successList.push(o),r.invalid[o.name]=!1,r.showErrors()):(n={},a=e||r.defaultMessage(o,{method:i,parameters:t}),n[o.name]=c.message=a,r.invalid[o.name]=!0,r.showErrors(n)),c.valid=l,r.stopRequest(o,l)}},n)),"pending")}}});var t,o={};return e.ajaxPrefilter?e.ajaxPrefilter(function(e,t,n){var i=e.port;"abort"===e.mode&&(o[i]&&o[i].abort(),o[i]=n)}):(t=e.ajax,e.ajax=function(n){var i=("mode"in n?n:e.ajaxSettings).mode,r=("port"in n?n:e.ajaxSettings).port;return"abort"===i?(o[r]&&o[r].abort(),o[r]=t.apply(this,arguments),o[r]):t.apply(this,arguments)}),e}),$(document).ready(function(e){function t(e){var t=$(e),o=t.data("submenuId"),i=$("#"+o),r=(n.outerHeight(),n.outerWidth());i.css({display:"block",top:-1,left:r-3}),t.find("a").addClass("maintainHover")}function o(e){var t=$(e),o=t.data("submenuId"),n=$("#"+o);n.css("display","none"),t.find("a").removeClass("maintainHover")}var n=$("#navBar");$("#navBar").menuAim({activate:t,deactivate:o});var n=$("#navBar-sticky");$("#navBar-sticky").menuAim({activate:t,deactivate:o}),$(".dropdown.full-wid .dropdown-menu li").click(function(e){e.stopPropagation()}),$(document).click(function(){$(".popover").css("display","none"),$("a.maintainHover").removeClass("maintainHover")})});